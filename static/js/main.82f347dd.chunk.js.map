{"version":3,"sources":["helpers/errors.tsx","graphql/queriesUser.ts","helpers/user.ts","providers/user.tsx","helpers/apollo.ts","images/icons.svg","providers/theme.tsx","graphql/queries.ts","providers/roles.tsx","images/logo_white.svg","components/Dialog.tsx","providers/dialog.tsx","helpers/request.ts","pages/anonymous/Login.tsx","types/model.ts","pages/anonymous/index.tsx","providers/datePlanning.tsx","components/Link.tsx","helpers/role.tsx","components/menu.tsx","components/menuBottom.tsx","helpers/date.ts","components/Loader.tsx","helpers/piaf.ts","components/PiafCircle.tsx","components/PiafRow.tsx","components/SlotDialog.tsx","components/Piaf.tsx","components/UserPiafs.tsx","components/ReplacementPiafs.tsx","components/CriticalPiafs.tsx","components/SendEmail.tsx","pages/authenticated/Home.tsx","components/Slot.tsx","components/CalendarDay.tsx","components/Calendar.tsx","components/IconsCaption.tsx","components/PrivacyPolicy.tsx","pages/authenticated/Planning.tsx","components/LongAbsence.tsx","pages/authenticated/Profile.tsx","pages/authenticated/Reserve.tsx","components/UserInfoDialog.tsx","components/Users.tsx","pages/authenticated/Magasin.tsx","pages/authenticated/BdM.tsx","components/UserPiafHistory.tsx","pages/authenticated/History.tsx","pages/authenticated/RestrictedRoute.tsx","pages/Legal.tsx","pages/authenticated/index.tsx","App.tsx","index.tsx"],"names":["apiKey","process","Bugsnag","start","releaseStage","enabledReleaseStages","appVersion","metadata","deployDate","Date","toString","deployAuthor","plugins","BugsnagPluginReact","handleError","error","console","alert","message","notify","Boundary","getPlugin","createErrorBoundary","React","Container","ErrorBlock","Typography","variant","aria-hidden","String","Text","ErrorMessage","ErrorBoundary","children","FallbackComponent","LOGGED_IN_USER","gql","USER_UPDATE","USERS","USER_UPDATE_STOP_ABSENCE_WITHOUT_SHOPPING","USER_UPDATE_STOP_ABSENCE_WITH_SHOPPING","USER_SET_AWAITING_PARTICIPATION_GROUP","formatName","user","prenom","nom","UserContext","createContext","STORAGE_KEY","getStoredUser","stored","localStorage","getItem","JSON","parse","UserProvider","useState","auth","setAuth","setUser","useEffect","apollo","query","variables","id","then","data","email","Provider","value","login","setItem","stringify","logout","removeItem","refetchUser","useUser","useContext","API_URL","_symbol","_symbol2","_symbol3","_symbol4","_symbol5","_symbol6","_symbol7","TEST","includes","link","createHttpLink","uri","authLink","setContext","_","previous","headers","token","client","ApolloClient","concat","cache","InMemoryCache","defaultOptions","fetchPolicy","watchQuery","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgIcons","_ref","svgRef","title","titleId","props","xmlns","style","display","ref","viewBox","fill","cx","cy","r","d","x","y","width","height","ForwardRef","TITLE_FONT","TEXT_FONT","MAIN_COLOR","SECONDARY_COLOR","grey","THEME","createMuiTheme","typography","fontFamily","body1","fontSize","body2","subtitle1","subtitle2","h1","fontWeight","h2","h3","color","h4","h5","h6","palette","primary","main","secondary","contrastThreshold","tonalOffset","overrides","MuiTooltip","tooltip","MuiCssBaseline","a","coreLocale","dataGridLocale","ThemeProvider","theme","CssBaseline","SLOTS","PIAFS","PIAFS_COUNT","PLANNING","REGISTRATION_UPDATE","VALIDATE_PIAF","PIAF_NON_POURVU","RESERVE_CREATE","RESERVE_UPDATE","RESERVE_USER","CRENEAUX_GENERIQUES","PIAF_GET","ROLES","RolesContext","RolesProvider","roles","useQuery","_path","_g","Dialog","open","handleClose","callback","handleConfirm","ok","setTimeout","onClose","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","onClick","DialogContext","DialogProvider","setOpen","setTitle","setMessage","setCallback","closeDialog","openDialog","newMessage","newTitle","undefined","openQuestion","Promise","resolve","useDialog","post","path","body","fetch","method","response","HttpError","status","statusText","json","sendEmail","recipient","subject","Error","FormData","append","SvgLogoWhite","transform","RoleId","Header","ConexionButton","ResetPassword","LoginPage","loading","setLoading","showPassword","setShowPassword","handleSubmit","event","preventDefault","currentTarget","userId","get","code","maxWidth","onSubmit","TextField","type","name","label","fullWidth","margin","InputProps","endAdornment","Tooltip","IconButton","aria-label","edge","VisibilityOff","Visibility","href","size","disabled","Anonymous","pathname","useLocation","Login","to","DatePlanningContext","getInitialStart","startOfMonth","getInitialEnd","endOfMonth","DatePlanningProvider","setStart","end","setEnd","after","before","refetch","goBack","date","subMonths","goForward","addMonths","goToday","useDatePlanning","UniversalLink","startsWith","hasRole","some","roleUniqueId","hasAtLeastOneRole","roleIds","rolesUser","formatRoles","map","libelle","join","DRAWER_WIDTH","Spacer","styled","Box","flexGrow","useStyles","makeStyles","createStyles","root","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","spacing","breakpoints","up","toolbar","alignItems","justifyContent","padding","mixins","content","menuItem","textDecoration","activeItem","ITEMS","Icon","HomeIcon","Chouettos","EventIcon","PosteAccueil","GroupIcon","PersonIcon","HistoryIcon","StorefrontIcon","AdminMag","CardMembershipIcon","AdminBdM","ArrowBackIcon","Menu","classes","useTheme","useMediaQuery","userRoles","rolesChouette","className","AppBar","position","clsx","Toolbar","noWrap","Chip","Person","Drawer","paper","direction","ChevronRight","ChevronLeft","List","filter","active","Link","ListItem","button","ListItemIcon","ListItemText","top","bottom","flexDirection","menu","paddingTop","paddingBottom","textMenuDecoration","backgroundColor","icon","activeIcon","MAIN_ITEMS","EXTRA_ITEMS","BottomAppBar","anchorEl","setAnchorEl","matches","down","component","keepMounted","Boolean","MenuItem","aria-controls","aria-haspopup","getDate","formatInFrench","pattern","format","locale","fr","formatDateShort","formatDateLong","formatTime","formatDateTime","WEEKDAYS","queryDate","Loader","CircularProgress","getPiafRole","role","isTaken","piaf","statut","piaffeur","isCritical","slot","piafs","horsMag","differenceInDays","toLowerCase","GrandHibou","Caissier","orderPiafsByDate","left","right","creneau","debut","orderPiafsByRoleId","KNOWN_ROLES","values","Svg","$taken","$critical","InfoIconPiaf","InfoIcon","ImageContainer","PiafIcon","taken","critical","info","xlinkHref","PiafCircle","displayTooltip","informations","ADMIN_ROLES","Row","Status","Contact","InfoTextField","InfoPiaf","ButtonSave","getPiafCount","startOfDay","startOfWeek","endOfDay","endOfWeek","p","nonPourvu","getRegistrationPiaf","replacementPiaf","find","sendEmailReplacedPiaf","replacedUserMail","ghEmail","GHPiaf","getGHEmail","PiafRow","setInfo","currentUserIsAdmin","currentUserInSlot","currentUser","handleInputChange","saveInfo","loggedUser","mutate","mutation","piafId","checksBeforeRegister","absenceLongueDureeCourses","absenceLongueDureeSansCourses","register","registrationPiaf","registrationDate","unregister","isFuture","isPast","piafRole","showInfos","affichageDonneesPersonnelles","description","telephone","multiline","onChange","startIcon","Save","CloseButton","Title","SlotDialog","show","Close","disableTypography","capitalize","information","Bordered","Grid","Piaf","allowValidate","useLazyQuery","load","handleValidate","validate","handleNonPourvue","titre","fin","container","item","xs","ListItemAvatar","FormGroup","FormControlLabel","control","Checkbox","checked","pourvu","currentDate","now","UserPiafs","validated","skip","sort","ReplacementPiafs","addWeeks","list","match","Number","getId","CriticalPiafs","addDays","slots","forEach","push","TextInput","SendEmail","dialogContent","emailAddress","emailSubject","comment","setComment","handleSendEmail","toUpperCase","codeBarre","autoComplete","required","COLORS","chouette","StatusText","$status","Bottom","AbsenceText","Content","HomePage","openSendEmailDialog","setOpenSendEmailDialog","counter","nbPiafEffectuees","nbPiafAttendues","handleClick","shopping","setUserAsAwaitingResult","attenteCommissionParticipation","startOfToday","SELECTED_COLOR","HIGHLIGHTED_SLOTS","ClickableSlot","$open","$slotTitle","Slot","WEEK_COLORS","A","B","C","D","$weekId","$when","CalendarDay","day","weekId","today","isToday","monday","getDay","el","scrollIntoView","behavior","DayPlaceholder","WeekRow","Calendar","weeks","eachWeekOfInterval","weekStartsOn","days","node","weekIndex","differenceInWeeks","week","infoCreneau","piaffeursCount","piaffeursCountFirstPiaf","creneauGenerique","num","fromCharCode","getWeekId","frequence","index","Caption","IconsCaption","PIAF","Formateur","CaptionDialog","PrivacyPolicy","handleAccept","idUser","Loading","Nav","ButtonArea","ButtonAreaBottom","BottomCaption","orderSlotsByDate","PlanningPage","displayPrivacyPolicyDialog","setDisplayPrivacyPolicyDialog","creneaus","ArrowBackIos","isSameMonth","CalendarToday","endIcon","ArrowForwardIos","REASONS","noPiaf","noBuy","other","LongAbsence","reason","startDate","endDate","setValues","InputLabelProps","shrink","inputProps","min","FormControl","InputLabel","Select","rel","UserDataShare","ProfilePage","saving","setSaving","openAbsenceDialog","setOpenAbsenceDialog","unsavedChanges","setUnsavedChanges","alertUser","e","returnValue","window","addEventListener","removeEventListener","handleSave","when","startAdornment","InputAdornment","Phone","Mail","RadioGroup","defaultValue","Radio","ReserveGrid","ReservePage","setInformation","setSlots","dataCreneauxList","loadingCL","errorCreneauxList","dataCreneauxUser","loadingCU","errorReserve","reserves","creneauGeneriques","cg","queryError","slotList","jour","actif","reserveFound","s","startTime","heureDebut","getTime","slotReserveFound","time","allSlotIds","slotDisplayed","getSlots","idCreneauGenerique","selected","displayed","text","reserve","temp","slice","splice","handleCheckboxChange","heureFin","RightCol","UserInfoDialog","StyledGrid","DataGrid","booleanFormatter","COLUMNS","field","headerName","flex","valueFormatter","Users","selectedRow","setSelectedRow","setOpenDialog","rows","users","columns","onRowClick","row","autoPageSize","MagasinPage","BdMPage","UserPiafHistory","historyPiafs","DateField","HistoryPage","selectedDateIni","setSelectedDateIni","selectedDateFin","setSelectedDateFin","handleChange","valueAsDate","RestrictedRoute","redirectionPath","LegalPage","Authenticated","next","search","params","substr","split","part","tuple","decodeURIComponent","getParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.82f347dd.chunk.js","sourcesContent":["import React, { ErrorInfo, FC } from \"react\"\nimport Bugsnag from \"@bugsnag/js\"\nimport BugsnagPluginReact from \"@bugsnag/plugin-react\"\nimport styled from \"@emotion/styled/macro\"\nimport { Typography } from \"@material-ui/core\"\n\nconst apiKey = process.env.REACT_APP_BUGSNAG_KEY\n\nif (apiKey) {\n  Bugsnag.start({\n    apiKey,\n    releaseStage: process.env.NODE_ENV,\n    enabledReleaseStages: [\"production\"],\n    appVersion: process.env.REACT_APP_COMMIT,\n    metadata: {\n      deployDate: new Date().toString(),\n      deployAuthor: process.env.REACT_APP_AUTHOR,\n    },\n    plugins: [new BugsnagPluginReact()],\n  })\n}\n\n// TODO: show nicer message\nexport const handleError = (error: Error) => {\n  console.error(error)\n  alert(error.message)\n  if (apiKey) {\n    Bugsnag.notify(error)\n  }\n}\n\nconst Boundary = apiKey ? Bugsnag.getPlugin(\"react\")?.createErrorBoundary(React) : null\n\nconst Container = styled.div`\n  padding: 1rem;\n  h2 {\n    color: #e53935;\n    margin: 1rem 0;\n  }\n  code {\n    display: block;\n    margin-top: 3rem;\n    color: #aaa;\n  }\n`\n\n// https://github.com/bugsnag/bugsnag-js/blob/next/packages/plugin-react/types/bugsnag-plugin-react.d.ts\ninterface FallbackProps {\n  error: Error\n  info?: ErrorInfo\n  clearError?: () => void\n}\n\nexport const ErrorBlock = ({ error }: FallbackProps) => (\n  <Container>\n    <Typography variant=\"h2\">\n      <span aria-hidden>🐞</span>\n      <br />\n      Une erreur est survenue\n    </Typography>\n    <Typography>Essayez de recharger la page</Typography>\n    <code>{String(error)}</code>\n  </Container>\n)\n\nconst Text = styled.p`\n  color: #e53935;\n`\n\ninterface MessageProps {\n  error: Error\n}\n\nexport const ErrorMessage = ({ error }: MessageProps) => <Text>Erreur : {error.message}</Text>\n\nexport const ErrorBoundary: FC = ({ children }) =>\n  Boundary ? <Boundary FallbackComponent={ErrorBlock}>{children}</Boundary> : <>{children}</>\n","import { gql } from \"@apollo/client\"\n\nexport const LOGGED_IN_USER = gql`\n  query LOGGED_IN_USER($id: ID!) {\n    user(id: $id) {\n      id\n      rolesChouette {\n        id\n        roleUniqueId\n        libelle\n      }\n      nom\n      prenom\n      email\n      telephone\n      actif\n      statut\n      codeBarre\n      nbPiafEffectuees\n      nbPiafAttendues\n      nbPiafGH\n      nbPiafCaisse\n      affichageDonneesPersonnelles\n      absenceLongueDureeCourses\n      absenceLongueDureeSansCourses\n      attenteCommissionParticipation\n    }\n  }\n`\nexport const USER_UPDATE = gql`\n  mutation USER_UPDATE($idUser: ID!, $email: String, $telephone: String, $affichageDonneesPersonnelles: Boolean) {\n    updateUser(\n      input: {\n        id: $idUser\n        email: $email\n        telephone: $telephone\n        affichageDonneesPersonnelles: $affichageDonneesPersonnelles\n      }\n    ) {\n      user {\n        id\n        email\n        telephone\n        affichageDonneesPersonnelles\n      }\n    }\n  }\n`\n\nexport const USERS = gql`\n  query USERS {\n    users(enabled: true) {\n      id\n      nom\n      prenom\n      email\n      actif\n      codeBarre\n      rolesChouette {\n        id\n        libelle\n        roleUniqueId\n      }\n      statut\n      reserve {\n        id\n        informations\n        creneauGeneriques {\n          id\n          heureDebut\n          heureFin\n          jour\n        }\n      }\n      absenceLongueDureeCourses\n      absenceLongueDureeSansCourses\n      nbPiafEffectuees\n      nbPiafAttendues\n      nbPiafGH\n      nbPiafCaisse\n      attenteCommissionParticipation\n    }\n  }\n`\n\nexport const USER_UPDATE_STOP_ABSENCE_WITHOUT_SHOPPING = gql`\n  mutation($id: ID!) {\n    updateUser(input: { id: $id, absenceLongueDureeSansCourses: false }) {\n      user {\n        id\n        username\n        nom\n        prenom\n        absenceLongueDureeSansCourses\n        absenceLongueDureeCourses\n      }\n    }\n  }\n`\nexport const USER_UPDATE_STOP_ABSENCE_WITH_SHOPPING = gql`\n  mutation($id: ID!) {\n    updateUser(input: { id: $id, absenceLongueDureeCourses: false }) {\n      user {\n        id\n        username\n        nom\n        prenom\n        absenceLongueDureeSansCourses\n        absenceLongueDureeCourses\n      }\n    }\n  }\n`\n\nexport const USER_SET_AWAITING_PARTICIPATION_GROUP = gql`\n  mutation($id: ID!) {\n    updateUser(input: { id: $id, attenteCommissionParticipation: true }) {\n      user {\n        id\n        username\n        nom\n        prenom\n        attenteCommissionParticipation\n      }\n    }\n  }\n`\n","import { User } from \"src/types/model\"\n\nexport const formatName = (user: User) => `${user.prenom} ${user.nom}`\n","import type { User } from \"src/types/model\"\n\nimport { createContext, useContext, useState, FC, useEffect } from \"react\"\nimport Bugsnag from \"@bugsnag/js\"\n\nimport { LOGGED_IN_USER } from \"src/graphql/queriesUser\"\nimport apollo from \"src/helpers/apollo\"\nimport { formatName } from \"src/helpers/user\"\n\nexport interface Auth {\n  email: string\n  token: string\n  id: number\n}\n\nexport interface IUserContext<IsAuthenticated extends boolean = false> {\n  auth: IsAuthenticated extends true ? Auth : Auth | null\n  user: User | null\n  login: (auth: Auth) => void\n  logout: () => void\n  refetchUser: () => void\n}\n\nconst UserContext = createContext<IUserContext>({} as IUserContext)\n\nconst STORAGE_KEY = \"user\"\n\nexport const getStoredUser = () => {\n  const stored = localStorage.getItem(STORAGE_KEY)\n  if (!stored) {\n    return null\n  }\n  return JSON.parse(stored) as Auth\n}\n\nexport const UserProvider: FC = ({ children }) => {\n  const [auth, setAuth] = useState<Auth | null>(getStoredUser)\n  const [user, setUser] = useState<User | null>(null)\n\n  useEffect(() => {\n    if (auth) {\n      apollo\n        .query<{ user: User }>({\n          query: LOGGED_IN_USER,\n          variables: { id: `api/users/${auth.id}` },\n        })\n        .then(({ data }) => {\n          setUser(data.user)\n        })\n    }\n  }, [auth])\n\n  useEffect(() => {\n    if (user) {\n      Bugsnag.setUser(user.id, user.email, formatName(user))\n    } else {\n      Bugsnag.setUser()\n    }\n  }, [user])\n\n  const login = (data: Auth) => {\n    setAuth(data)\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data))\n  }\n\n  const logout = () => {\n    setAuth(null)\n    localStorage.removeItem(STORAGE_KEY)\n  }\n\n  const refetchUser = () => {\n    if (auth) {\n      apollo\n        .query<{ user: User }>({\n          query: LOGGED_IN_USER,\n          variables: { id: `api/users/${auth.id}` },\n        })\n        .then(({ data }) => {\n          setUser(data.user)\n        })\n    }\n  }\n\n  return <UserContext.Provider value={{ auth, user, login, logout, refetchUser }}>{children}</UserContext.Provider>\n}\n\nexport function useUser<IsAuthenticated extends boolean = false>() {\n  return useContext(UserContext) as IUserContext<IsAuthenticated>\n}\n","import { ApolloClient, createHttpLink, InMemoryCache } from \"@apollo/client\"\nimport { setContext } from \"@apollo/client/link/context\"\n\nimport { getStoredUser } from \"src/providers/user\"\n\nconst API_URL = process.env.REACT_APP_API\n\nif (!API_URL) {\n  throw new Error(\"You must compile the app with a REACT_APP_API environment variable - see example.env\")\n}\n\nexport const TEST = API_URL.includes(\"test\")\n\nconst link = createHttpLink({\n  uri: `${API_URL}/api/graphql`,\n})\n\nconst authLink = setContext((_, previous) => {\n  const user = getStoredUser()\n  if (!user) {\n    return previous\n  }\n  return {\n    ...previous,\n    headers: {\n      ...previous.headers,\n      \"X-Auth-Token\": user.token,\n    },\n  }\n})\n\nconst client = new ApolloClient({\n  link: authLink.concat(link),\n  cache: new InMemoryCache(),\n  defaultOptions: {\n    query: {\n      fetchPolicy: \"network-only\",\n    },\n    watchQuery: {\n      fetchPolicy: \"cache-and-network\",\n    },\n  },\n})\n\nexport default client\n\nexport const getId = (id?: string | number) => {\n  if (typeof id === \"number\") {\n    return id\n  }\n  if (typeof id === \"string\") {\n    const matches = id.match(/api\\/\\w+\\/(\\d+)/)\n    if (matches) {\n      return Number(matches[1])\n    }\n  }\n  return null\n}\n","var _symbol, _symbol2, _symbol3, _symbol4, _symbol5, _symbol6, _symbol7;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgIcons(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    style: {\n      display: \"none\"\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _symbol || (_symbol = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"F\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"Formateur\\xB7rice\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 26.75,\n    cy: 26.8,\n    r: 5.25\n  }))), _symbol2 || (_symbol2 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"CA\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"Caissier\\xB7\\xE8re\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21.24,20l1.34,1.32A6.23,6.23,0,0,1,20.15,23a8.24,8.24,0,0,1-3.17.59A8.45,8.45,0,0,1,13.59,23,7.42,7.42,0,0,1,11,21a7.12,7.12,0,0,1-1.51-2.88H7.06V17H9.25c0-.36-.05-.65-.05-.86s0-.49.05-.86H7.06V14.07h2.4A7,7,0,0,1,11,11.2a7.19,7.19,0,0,1,2.62-1.92A8.29,8.29,0,0,1,17,8.59a8.38,8.38,0,0,1,3.18.59,6.36,6.36,0,0,1,2.42,1.7l-1.34,1.33a5.48,5.48,0,0,0-4.16-1.75,5.83,5.83,0,0,0-3.36,1,5.23,5.23,0,0,0-2,2.62h6.66v1.18H11.39a5.81,5.81,0,0,0-.06.86,6,6,0,0,0,.06.86h7v1.18H11.68a5.25,5.25,0,0,0,2,2.63,5.9,5.9,0,0,0,3.36,1A5.5,5.5,0,0,0,21.24,20Z\"\n  }))), _symbol3 || (_symbol3 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"CAF\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"Caissier\\xB7\\xE8re formateur\\xB7ice\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 26.75,\n    cy: 26.8,\n    r: 5.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21.24,20l1.34,1.32A6.23,6.23,0,0,1,20.15,23a8.24,8.24,0,0,1-3.17.59A8.45,8.45,0,0,1,13.59,23,7.42,7.42,0,0,1,11,21a7.12,7.12,0,0,1-1.51-2.88H7.06V17H9.25c0-.36-.05-.65-.05-.86s0-.49.05-.86H7.06V14.07h2.4A7,7,0,0,1,11,11.2a7.19,7.19,0,0,1,2.62-1.92A8.29,8.29,0,0,1,17,8.59a8.38,8.38,0,0,1,3.18.59,6.36,6.36,0,0,1,2.42,1.7l-1.34,1.33a5.48,5.48,0,0,0-4.16-1.75,5.83,5.83,0,0,0-3.36,1,5.23,5.23,0,0,0-2,2.62h6.66v1.18H11.39a5.81,5.81,0,0,0-.06.86,6,6,0,0,0,.06.86h7v1.18H11.68a5.25,5.25,0,0,0,2,2.63,5.9,5.9,0,0,0,3.36,1A5.5,5.5,0,0,0,21.24,20Z\"\n  }))), _symbol4 || (_symbol4 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"CH\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"Chouettos\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M30.13,10.49a7.25,7.25,0,0,0-8.68-3.38c-2.92,1-4.46,3.27-5.4,6.33a10.47,10.47,0,0,0-1.37-3.14C11.17,5,4.65,6.05,2.32,10L.21,13.4c2-7,6.59-11.53,13.16-13.18,7.3-.22,15.9,3.62,18.4,13.05Zm-14.07.37a8.8,8.8,0,0,1,3.37-4.73,7.83,7.83,0,0,1,7.78-.46C20.94-.9,10.41-1.09,4.79,5.8,9.55,2.81,14.55,6.62,16.06,10.86Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M21.07,15.59a2.76,2.76,0,0,1,3-2.83,2.88,2.88,0,1,1-.1,5.76A2.75,2.75,0,0,1,21.07,15.59Zm4.05.06C25,15,24.7,14.51,24,14.51a1.05,1.05,0,0,0-1.17,1.11,1,1,0,0,0,1.14,1.15C24.66,16.79,25,16.36,25.12,15.65Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.67,12.76a2.88,2.88,0,1,1,0,5.76,2.88,2.88,0,1,1,0-5.76Zm1.18,2.89a1.07,1.07,0,0,0-1.14-1.14,1.05,1.05,0,0,0-1.15,1.13A1.06,1.06,0,0,0,8.7,16.78,1.07,1.07,0,0,0,9.85,15.65Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.07,21.41a3.86,3.86,0,0,1-1.22-2.08,1.33,1.33,0,0,1,1.23-1.25c.56,0,1.32.62,1.22,1.27A3.68,3.68,0,0,1,16.07,21.41Z\"\n  }))), _symbol5 || (_symbol5 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"GH\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"GH\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.94,15h1.73v3.92a5.63,5.63,0,0,1-1.77.93,7,7,0,0,1-2.08.32,5.65,5.65,0,0,1-2.71-.65,4.87,4.87,0,0,1-1.9-1.81,5.24,5.24,0,0,1,0-5.2,4.87,4.87,0,0,1,1.9-1.81A5.8,5.8,0,0,1,10.85,10a6,6,0,0,1,2.25.41,4.47,4.47,0,0,1,1.7,1.19l-1.15,1.13a3.72,3.72,0,0,0-2.72-1.13A3.86,3.86,0,0,0,9.08,12a3.21,3.21,0,0,0-1.26,1.22,3.5,3.5,0,0,0-.46,1.8,3.39,3.39,0,0,0,.46,1.77,3.26,3.26,0,0,0,1.26,1.24,3.72,3.72,0,0,0,1.84.45,3.91,3.91,0,0,0,2-.51Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M25.82,10.14V20H24V15.76H18.9V20H17.07V10.14H18.9V14.2H24V10.14Z\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 11.03,\n    y: 14.95,\n    width: 3.65,\n    height: 1.31\n  }))), _symbol6 || (_symbol6 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"GHF\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"GH formateur\\xB7ice\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.94,15h1.73v3.92a5.52,5.52,0,0,1-1.77.93,7,7,0,0,1-2.08.32,5.65,5.65,0,0,1-2.71-.65,4.87,4.87,0,0,1-1.9-1.81,5.24,5.24,0,0,1,0-5.2,4.87,4.87,0,0,1,1.9-1.81A5.8,5.8,0,0,1,10.85,10a6,6,0,0,1,2.25.41,4.47,4.47,0,0,1,1.7,1.19l-1.15,1.13a3.72,3.72,0,0,0-2.72-1.13A3.86,3.86,0,0,0,9.08,12a3.21,3.21,0,0,0-1.26,1.22,3.5,3.5,0,0,0-.46,1.8,3.39,3.39,0,0,0,.46,1.77,3.26,3.26,0,0,0,1.26,1.24,3.72,3.72,0,0,0,1.84.45,3.91,3.91,0,0,0,2-.51Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M25.82,10.14V20H24V15.76H18.9V20H17.07V10.14H18.9V14.2H24V10.14Z\"\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 26.75,\n    cy: 26.75,\n    r: 5.25\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 11.03,\n    y: 14.95,\n    width: 3.65,\n    height: 1.31\n  }))), _symbol7 || (_symbol7 = /*#__PURE__*/React.createElement(\"symbol\", {\n    id: \"P\",\n    viewBox: \"0 0 32 32\"\n  }, /*#__PURE__*/React.createElement(\"title\", null, \"PIAF\"), /*#__PURE__*/React.createElement(\"circle\", {\n    fill: \"#fff\",\n    cx: 16,\n    cy: 16,\n    r: 15.25\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16,1.5A14.5,14.5,0,1,1,1.5,16,14.51,14.51,0,0,1,16,1.5M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgIcons);\nexport default __webpack_public_path__ + \"static/media/icons.7ae89857.svg\";\nexport { ForwardRef as ReactComponent };","import type { FC } from \"react\"\n\nimport { createMuiTheme, ThemeProvider as MUIThemeProvider, Theme as MUITheme } from \"@material-ui/core/styles\"\nimport { frFR as dataGridLocale } from \"@material-ui/data-grid\"\nimport { CssBaseline } from \"@material-ui/core\"\nimport { ThemeProvider as EmotionThemeProvider } from \"@emotion/react/macro\"\nimport { frFR as coreLocale } from \"@material-ui/core/locale\"\nimport { grey } from \"@material-ui/core/colors\"\n\nimport { ReactComponent as Icons } from \"src/images/icons.svg\"\n\n// see public/index.html\nconst TITLE_FONT = \"Montserrat, sans-serif\" // https://style.lachouettecoop.fr/#/typographie?a=titres-et-sous-titres\nconst TEXT_FONT = \"Cabin, sans-serif\" // https://style.lachouettecoop.fr/#/typographie?a=texte\n\nconst MAIN_COLOR = \"#3A5447\" // https://style.lachouettecoop.fr/#/couleurs\nconst SECONDARY_COLOR = grey[500]\n\ndeclare module \"@emotion/react\" {\n  // eslint-disable-next-line @typescript-eslint/no-empty-interface\n  export interface Theme extends MUITheme {}\n}\n\nconst THEME = createMuiTheme(\n  {\n    typography: {\n      fontFamily: TEXT_FONT,\n      body1: {\n        fontFamily: TEXT_FONT,\n        fontSize: \"1rem\",\n      },\n      body2: {\n        fontFamily: TEXT_FONT,\n        fontSize: \"1rem\",\n      },\n      subtitle1: {\n        fontFamily: TITLE_FONT,\n      },\n      subtitle2: {\n        fontFamily: TITLE_FONT,\n      },\n      h1: {\n        fontFamily: TITLE_FONT,\n        fontWeight: 600,\n        fontSize: \"2.5rem\",\n      },\n      h2: {\n        fontFamily: TITLE_FONT,\n        fontWeight: 600,\n        fontSize: \"1.5rem\",\n      },\n      h3: {\n        fontFamily: TITLE_FONT,\n        fontWeight: 600,\n        color: MAIN_COLOR,\n      },\n      h4: {\n        fontFamily: TITLE_FONT,\n      },\n      h5: {\n        fontFamily: TITLE_FONT,\n      },\n      h6: {\n        fontFamily: TITLE_FONT,\n      },\n    },\n    palette: {\n      primary: {\n        // light: will be calculated from palette.primary.main,\n        main: MAIN_COLOR,\n        // dark: will be calculated from palette.primary.main,\n        // contrastText: will be calculated to contrast with palette.primary.main\n      },\n      secondary: {\n        main: SECONDARY_COLOR,\n      },\n      // Used by `getContrastText()` to maximize the contrast between\n      // the background and the text.\n      contrastThreshold: 3,\n      // Used by the functions below to shift a color's luminance by approximately\n      // two indexes within its tonal palette.\n      // E.g., shift from Red 500 to Red 300 or Red 700.\n      tonalOffset: 0.2,\n    },\n    overrides: {\n      MuiTooltip: {\n        tooltip: {\n          fontSize: \"1rem\",\n        },\n      },\n      MuiCssBaseline: {\n        \"@global\": {\n          a: {\n            color: MAIN_COLOR,\n          },\n        },\n      },\n    },\n  },\n  coreLocale,\n  dataGridLocale\n)\n\nconst ThemeProvider: FC = ({ children }) => (\n  <EmotionThemeProvider theme={THEME}>\n    <MUIThemeProvider theme={THEME}>\n      <CssBaseline />\n      <Icons />\n      {children}\n    </MUIThemeProvider>\n  </EmotionThemeProvider>\n)\n\nexport default ThemeProvider\n","import { gql } from \"@apollo/client\"\n\nexport const SLOTS = gql`\n  query SLOTS($id: ID!) {\n    creneau(id: $id) {\n      titre\n      informations\n      debut\n      fin\n      horsMag\n      creneauGenerique {\n        frequence\n      }\n      piafs {\n        id\n        statut\n        informations\n        description\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          nom\n          prenom\n          email\n          telephone\n          nbPiafGH\n          nbPiafCaisse\n        }\n      }\n    }\n  }\n`\n\nexport const PIAFS = gql`\n  query PIAFS($userId: String, $after: String, $before: String, $statut: String, $validated: Boolean) {\n    piafs(piaffeur: $userId, creneau_debut: { after: $after, before: $before }, statut: $statut, pourvu: $validated) {\n      id\n      statut\n      pourvu\n      nonPourvu\n      informations\n      description\n      creneau {\n        id\n        titre\n        debut\n        fin\n        horsMag\n      }\n      piaffeur {\n        id\n        nom\n        prenom\n        email\n        telephone\n        nbPiafGH\n        nbPiafCaisse\n        affichageDonneesPersonnelles\n      }\n      role {\n        id\n        roleUniqueId\n        libelle\n      }\n    }\n  }\n`\n\nexport const PIAFS_COUNT = gql`\n  query PIAFS_COUNT($userId: String, $after: String, $before: String) {\n    piafs(piaffeur: $userId, creneau_debut: { after: $after, before: $before }) {\n      id\n      statut\n      nonPourvu\n      creneau {\n        debut\n        fin\n      }\n    }\n  }\n`\n\nexport const PLANNING = gql`\n  query PLANNING($after: String, $before: String) {\n    creneaus(debut: { after: $after, before: $before }) {\n      id\n      debut\n      fin\n      titre\n      informations\n      horsMag\n      creneauGenerique {\n        frequence\n      }\n      piafs {\n        id\n        statut\n        informations\n        description\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          nom\n          prenom\n          email\n          telephone\n          nbPiafGH\n          nbPiafCaisse\n          affichageDonneesPersonnelles\n        }\n      }\n    }\n  }\n`\n\nexport const REGISTRATION_UPDATE = gql`\n  mutation REGISTRATION_UPDATE(\n    $piafId: ID!\n    $userId: String!\n    $statut: String!\n    $informations: String\n    $registrationDate: String\n  ) {\n    updatePiaf(\n      input: {\n        id: $piafId\n        piaffeur: $userId\n        statut: $statut\n        informations: $informations\n        dateReservation: $registrationDate\n      }\n    ) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        statut\n        informations\n      }\n    }\n  }\n`\nexport const VALIDATE_PIAF = gql`\n  mutation VALIDATE_PIAF($piafId: ID!, $validate: Boolean) {\n    updatePiaf(input: { id: $piafId, pourvu: $validate }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        pourvu\n      }\n    }\n  }\n`\n\nexport const PIAF_NON_POURVU = gql`\n  mutation PIAF_NON_POURVU($piafId: ID!, $nonPourvu: Boolean) {\n    updatePiaf(input: { id: $piafId, nonPourvu: $nonPourvu }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        pourvu\n        nonPourvu\n      }\n    }\n  }\n`\n\nexport const RESERVE_CREATE = gql`\n  mutation RESERVE_CREATE($user: String, $informations: String, $creneauGenerique: [String]) {\n    createReserve(input: { user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n`\n\nexport const RESERVE_UPDATE = gql`\n  mutation RESERVE_UPDATE($id: ID!, $user: String, $informations: String, $creneauGenerique: [String]) {\n    updateReserve(input: { id: $id, user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n`\n\nexport const RESERVE_USER = gql`\n  query RESERVE_USER($idUser: String) {\n    reserves(user: $idUser) {\n      id\n      informations\n      creneauGeneriques {\n        id\n      }\n    }\n  }\n`\n\nexport const CRENEAUX_GENERIQUES = gql`\n  query CRENEAUX_GENERIQUES {\n    creneauGeneriques {\n      id\n      heureDebut\n      heureFin\n      titre\n      jour\n      actif\n      horsMag\n      postes {\n        id\n        role {\n          libelle\n        }\n      }\n    }\n  }\n`\n\nexport const PIAF_CREATE = gql`\n  mutation PIAF_CREATE($idCreneau: String!, $idRole: String) {\n    createPiaf(input: { creneau: $idCreneau, role: $idRole, visible: true, pourvu: false, nonPourvu: false }) {\n      piaf {\n        id\n        creneau {\n          id\n        }\n        piaffeur {\n          id\n        }\n        role {\n          id\n        }\n      }\n    }\n  }\n`\n\nexport const PIAF_GET = gql`\n  query PIAF_GET($id: ID!) {\n    piaf(id: $id) {\n      id\n      creneau {\n        id\n      }\n      piaffeur {\n        id\n      }\n      role {\n        id\n      }\n    }\n  }\n`\n\nexport const ROLES = gql`\n  query ROLES {\n    roles {\n      id\n      libelle\n      roleUniqueId\n    }\n  }\n`\n","import type { Role } from \"src/types/model\"\n\nimport { createContext, useContext, FC } from \"react\"\n\nimport { ROLES } from \"src/graphql/queries\"\nimport { useQuery } from \"@apollo/client\"\n\nexport interface IRolesContext {\n  roles: Role[]\n}\ntype Result = { roles: Role[] }\n\nconst RolesContext = createContext<IRolesContext>({} as IRolesContext)\n\nexport const RolesProvider: FC = ({ children }) => {\n  let roles: Role[] = []\n\n  const { data } = useQuery<Result>(ROLES)\n\n  if (data) {\n    roles = data.roles\n  }\n\n  return <RolesContext.Provider value={{ roles }}>{children}</RolesContext.Provider>\n}\n\nexport function useRoles() {\n  return (useContext(RolesContext) as IRolesContext).roles\n}\n","var _path, _g;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgLogoWhite(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 756,\n    height: 756,\n    viewBox: \"0 0 756 756\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M61.585 422.116v58.818h22.67v14.24H44.713v-73.058zM135.514 468.447l-8.98-24.533-9.093 24.533zm4.6 12.924h-27.6l-5.585 13.803H89.402l29.464-73.058h15.446l28.808 73.058h-17.527z\",\n    fill: \"#314b3f\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"matrix(1.33333 0 0 -1.33333 0 756)\",\n    fill: \"#314b3f\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M187.233 197.273c-4.847-2.463-8.789-2.955-12.075-2.955-10.106 0-16.922 3.45-21.524 7.966-4.927 4.765-8.543 11.994-8.543 20.786 0 8.626 3.616 15.854 8.543 20.62 4.847 4.681 11.913 7.884 20.454 7.884 3.616 0 7.805-.739 13.145-3.04v-14.62c-2.793 2.956-6.98 5.83-12.814 5.83-4.6 0-8.298-1.48-11.17-4.27-3.042-2.959-5.178-7.393-5.178-12.652 0-5.666 2.3-9.693 4.764-12.076 1.152-1.148 5.093-4.599 11.83-4.599 3.287 0 7.721.902 12.568 5.668zM209.99 229.476h21.85v20.866h12.651v-54.793H231.84v23.248h-21.85v-23.248h-12.653v54.793h12.653zM271.76 235.23c-2.38-2.301-4.846-6.326-4.846-12.407 0-5.012 1.643-9.037 5.01-12.323 3.533-3.367 7.479-4.519 11.748-4.519 5.586 0 9.529 2.054 12.159 4.684 2.134 2.052 4.766 5.914 4.766 12.241 0 5.667-2.301 9.855-4.766 12.323-2.71 2.627-7.066 4.681-12.077 4.681-4.764 0-9.036-1.726-11.993-4.68m33.269 8.376c5.175-5.012 8.544-12.239 8.544-20.7 0-7.313-2.626-14.788-8.544-20.537-5.093-4.932-11.993-8.05-21.193-8.05-10.27 0-17.25 4.107-21.358 8.05-5.258 4.928-8.544 12.322-8.544 20.37 0 7.888 3.53 15.855 8.46 20.783 3.699 3.7 10.515 8.052 21.442 8.052 8.544 0 15.69-2.628 21.193-7.968M369.353 217.894c0-5.258-.657-11.747-6.08-17.333-5.259-5.422-11.335-6.243-17.085-6.243-5.752 0-11.83.821-17.087 6.243-5.424 5.586-6.081 12.075-6.081 17.333v32.447h12.654v-32.12c0-2.38.163-6.406 2.873-9.2 2.217-2.38 5.257-2.873 7.641-2.873 2.38 0 5.42.493 7.638 2.873 2.711 2.795 2.876 6.82 2.876 9.2v32.12h12.651zM412.315 239.664h-18.317v-10.598h17.415v-10.678h-17.415v-12.16h18.317V195.55h-30.97v54.793h30.97zM441.807 239.664V195.55h-12.65v44.115h-11.913v10.678h36.475v-10.678zM483.862 239.664V195.55h-12.649v44.115H459.3v10.678h36.476v-10.678zM533.396 239.664h-18.315v-10.598h17.413v-10.678h-17.413v-12.16h18.315V195.55H502.43v54.793h30.967zM150.376 147.294h14.159v-6.497h-14.159zM216.303 142.846v-6.907s.07-10.871-9.847-10.871c-9.913 0-9.844 10.87-9.844 10.87v29.614s-.07 10.87 9.844 10.87c9.917 0 9.847-10.87 9.847-10.87v-6.91H209.4v6.91s.27 3.69-2.806 3.69c-2.6 0-2.6-3.69-2.6-3.69v-29.613s0-3.691 2.6-3.691c3.077 0 2.806 3.69 2.806 3.69v6.908zM257.48 169.241c-2.598 0-2.462-3.689-2.462-3.689v-29.614s-.136-3.69 2.461-3.69c2.6 0 2.465 3.69 2.465 3.69v29.614s.135 3.69-2.465 3.69m0-44.175c-9.916 0-9.845 10.871-9.845 10.871v29.614s-.07 10.871 9.845 10.871c9.917 0 9.847-10.87 9.847-10.87v-29.615s.07-10.87-9.847-10.87M309.045 169.241c-2.598 0-2.461-3.689-2.461-3.689v-29.614s-.137-3.69 2.46-3.69c2.599 0 2.466 3.69 2.466 3.69v29.614s.133 3.69-2.465 3.69m0-44.175c-9.913 0-9.847 10.871-9.847 10.871v29.614s-.066 10.871 9.847 10.871c9.917 0 9.847-10.87 9.847-10.87v-29.615s.07-10.87-9.847-10.87M358.63 153.24c4.65 0 5.54 1.71 5.54 7.32 0 5.607-.89 7.792-5.54 7.792zm-7.385 22.635h7.385c6.43 0 12.993-3.488 12.993-15.044 0-11.556-6.563-15.113-12.993-15.113v-20.103h-7.385zM402.399 147.294h14.157v-6.497h-14.157zM281.567 382.087a.789.789 0 011.375 0l3.075 5.445a.79.79 0 01-.13.947l-3.073 3.075a.792.792 0 01-1.118 0l-3.074-3.075a.79.79 0 01-.129-.947zM304.03 401.252a3.2 3.2 0 003.195-3.196 3.2 3.2 0 00-3.196-3.196 3.2 3.2 0 00-3.196 3.195 3.2 3.2 0 003.196 3.196m0-11.503c4.582 0 8.308 3.728 8.308 8.308s-3.726 8.308-8.308 8.308-8.307-3.727-8.307-8.308c0-4.58 3.725-8.308 8.307-8.308M261.852 401.252a3.2 3.2 0 003.196-3.196 3.2 3.2 0 00-3.196-3.196 3.2 3.2 0 00-3.196 3.195 3.2 3.2 0 003.196 3.196m0-11.503c4.582 0 8.308 3.728 8.308 8.308s-3.726 8.308-8.308 8.308c-4.581 0-8.31-3.727-8.31-8.308 0-4.58 3.729-8.308 8.31-8.308\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M326.169 356.778c-4.608-20.494-16.665-32.974-22.36-38.441a76.7 76.7 0 013.984 12.545c1.569 6.95 2.219 13.674 1.985 20.554-.006.193-.035.38-.077.562a49.412 49.412 0 0118.185 22.554c.139-6.01-.418-11.997-1.717-17.774m-55.152-11.866a48.987 48.987 0 0111.239-1.313c7.694 0 14.98 1.783 21.47 4.949a74.272 74.272 0 00-1.845-16.332c-2.415-10.696-6.664-18.27-9.76-23.135-8.12-5.194-19.32-10.255-34.45-13.325 9.88 15.04 14.362 31.548 13.346 49.156m-30.591-61.684v83.767a49.396 49.396 0 0123.956-20.015c1.587-17.966-2.98-34.741-13.59-49.862l-1.18-1.684c-3.438-4.91-6.265-8.95-9.186-12.206m4.686 132.08c.35.404.703.81 1.114 1.183 1.183 1.212 2.607 2.275 4.11 3.266 1.56.914 3.226 1.714 5.002 2.268.44.145.9.223 1.35.342.46.13.894.204 1.312.256.455.05.778.169 1.34.184l1.616.075.123.008.024-.001.087-.005.348-.018.697-.032c.469 0 .93-.052 1.386-.14.925-.104 1.82-.328 2.714-.555 1.756-.552 3.44-1.283 4.967-2.228 1.483-.994 2.91-2.048 4.054-3.293.633-.568 1.087-1.26 1.647-1.848.465-.652.964-1.27 1.359-1.913.79-1.29 1.453-2.541 1.957-3.704.237-.593.456-1.148.66-1.662l.458-1.447c.305-.878.412-1.653.549-2.141.128-.5.194-.766.194-.766l.194.77c.14.498.243 1.233.55 2.125.14.443.295.934.462 1.468.223.517.429 1.077.662 1.665a30.81 30.81 0 001.966 3.71c.4.642.895 1.263 1.366 1.913.56.59 1.013 1.284 1.653 1.85 1.14 1.249 2.578 2.3 4.066 3.29 1.524.955 3.22 1.67 4.979 2.223l1.348.33c.448.106.854.127 1.28.21l.643.106.808.037.809.037.382.018.064-.005.174-.01c1.877.002 3.73-.371 5.525-.87 1.788-.543 3.459-1.364 5.03-2.27 1.519-.985 2.95-2.05 4.152-3.255.397-.355.74-.744 1.079-1.13a43.206 43.206 0 006.362-22.618c0-23.974-19.505-43.48-43.478-43.48-19.874 0-43.48 15.249-43.48 43.48a43.22 43.22 0 006.336 22.577m37.144 20.9c9.559 0 18.403-3.107 25.588-8.357-1.364.293-2.761.48-4.175.502l-.23.01-.115.006-.248-.011-.405-.024-.808-.05-.808-.05-.954-.143c-.63-.112-1.302-.188-1.887-.36l-1.743-.513c-2.272-.8-4.373-1.928-6.164-3.311-1.756-1.418-3.315-2.953-4.458-4.643-.626-.8-1.07-1.694-1.558-2.5-.396-.864-.798-1.681-1.101-2.497a20.82 20.82 0 01-1.012-3.644 20.73 20.73 0 01-1.004 3.618c-.297.815-.704 1.627-1.093 2.492-.485.806-.932 1.693-1.552 2.496-1.141 1.684-2.684 3.223-4.433 4.642-1.786 1.38-3.876 2.513-6.14 3.324-1.148.348-2.31.717-3.525.869-.6.117-1.204.193-1.818.212l-.916.055-.458.026-.115.005-.058.004h-.03l-.17-.004-.201-.01-1.615-.095c-.515-.02-1.243-.171-1.85-.26-.15-.022-.29-.052-.436-.077 7.168 5.207 15.974 8.289 25.492 8.289m49.13-43.478c0 27.09-22.04 49.13-49.13 49.13-27.092 0-48.717-22.04-48.717-49.13V275.847c0-1.223 1.104-2.34 2.195-2.89a3.235 3.235 0 013.38.288c5.23 3.866 9.072 8.927 13.832 15.678.03.004.06.002.092.007 18.943 3.025 32.639 9.04 42.319 15.244.488.16 8.738 6.323 11.397 8.845 4.905 4.647 19.83 18.792 25.153 42.468 2.653 11.798-.52 37.129-.52 37.244\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLogoWhite);\nexport default __webpack_public_path__ + \"static/media/logo_white.6e9fcd91.svg\";\nexport { ForwardRef as ReactComponent };","import {\n  Button,\n  Dialog as MuiDialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n} from \"@material-ui/core\"\n\ninterface Props {\n  open: boolean\n  handleClose: () => void\n  title: string\n  message: string\n  callback?: (ok: boolean) => void\n}\n\nconst Dialog = ({ open, handleClose, title, message, callback }: Props) => {\n  const handleConfirm = (ok: boolean) => () => {\n    if (callback) {\n      setTimeout(callback, 300, ok)\n    }\n    handleClose()\n  }\n\n  return (\n    <MuiDialog\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">{message}</DialogContentText>\n      </DialogContent>\n      {callback ? (\n        <DialogActions>\n          <Button onClick={handleConfirm(true)} color=\"primary\">\n            Oui\n          </Button>\n          <Button onClick={handleConfirm(false)} color=\"primary\">\n            Non\n          </Button>\n        </DialogActions>\n      ) : (\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            OK\n          </Button>\n        </DialogActions>\n      )}\n    </MuiDialog>\n  )\n}\n\nexport default Dialog\n","import { createContext, useContext, useState, FC } from \"react\"\n\nimport Dialog from \"src/components/Dialog\"\n\ntype Callback = (choice: boolean) => void\n\ninterface IDialogContext {\n  openDialog: (message: string, title?: string) => void\n  openQuestion: (message: string, title?: string) => Promise<boolean>\n  closeDialog: () => void\n}\n\nconst DialogContext = createContext({} as IDialogContext)\n\nexport const DialogProvider: FC = ({ children }) => {\n  const [open, setOpen] = useState(false)\n  const [title, setTitle] = useState(\"\")\n  const [message, setMessage] = useState(\"\")\n  const [callback, setCallback] = useState<Callback>()\n\n  const openDialog = (newMessage: string, newTitle = \"\") => {\n    setMessage(newMessage)\n    setTitle(newTitle)\n    setCallback(undefined)\n    setOpen(true)\n  }\n\n  const openQuestion = (newMessage: string, newTitle = \"\") => {\n    setMessage(newMessage)\n    setTitle(newTitle)\n    return new Promise((resolve: Callback) => {\n      setCallback(() => resolve)\n      setOpen(true)\n    })\n  }\n\n  const closeDialog = () => {\n    setOpen(false)\n  }\n\n  return (\n    <DialogContext.Provider value={{ openDialog, openQuestion, closeDialog }}>\n      {children}\n      <Dialog open={open} handleClose={closeDialog} title={title} message={message} callback={callback} />\n    </DialogContext.Provider>\n  )\n}\n\nexport const useDialog = () => useContext(DialogContext)\n","import HttpError from \"standard-http-error\"\n\nimport { getStoredUser } from \"src/providers/user\"\n\nexport const post = async (path: string, body: BodyInit, headers?: HeadersInit) => {\n  const response = await fetch(`${process.env.REACT_APP_API}/${path}`, {\n    method: \"POST\",\n    body,\n    headers,\n  })\n  if (!response.ok) {\n    throw new HttpError(response.status, response.statusText)\n  }\n  return response.json()\n}\n\nexport const getParams = (search: string) => {\n  const params: Record<string, string> = {}\n  search\n    .substr(1)\n    .split(\"&\")\n    .forEach((part) => {\n      if (part) {\n        const tuple = part.split(\"=\")\n        if (tuple.length === 2) {\n          params[tuple[0]] = decodeURIComponent(tuple[1])\n        }\n      }\n    })\n  return params\n}\n\n// TODO: use email templates and just pass a template ID with variables\nexport const sendEmail = async (recipient: string, subject: string, message: string) => {\n  const user = getStoredUser()\n\n  if (!user) {\n    throw new Error(\"You must be authenticated to trigger the sending of an email\")\n  }\n\n  const headers = {\n    \"X-Auth-Token\": user.token,\n  }\n\n  const data = new FormData()\n  data.append(\"sujet\", subject)\n  data.append(\"email\", recipient)\n  data.append(\"corps\", message)\n\n  return await post(\"dist_api/send_email\", data, headers)\n}\n","import { FormEvent, useState } from \"react\"\nimport { Container, TextField, Button, Typography, IconButton, Tooltip } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\nimport { VisibilityOff, Visibility } from \"@material-ui/icons\"\n\nimport { useUser, Auth } from \"src/providers/user\"\nimport { post } from \"src/helpers/request\"\nimport { handleError } from \"src/helpers/errors\"\n\nimport { ReactComponent as Logo } from \"src/images/logo_white.svg\"\nimport HttpError from \"standard-http-error\"\n\nconst Header = styled.div`\n  text-align: center;\n  svg {\n    width: 250px;\n    height: 250px;\n    margin: -20px 0;\n  }\n`\nconst ConexionButton = styled(Button)`\n  margin-bottom: 15px;\n`\n\nconst ResetPassword = styled.div`\n  margin: 5px;\n  float: right;\n`\n\nconst LoginPage = () => {\n  const [loading, setLoading] = useState(false)\n  const [showPassword, setShowPassword] = useState(false)\n  const { login } = useUser()\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    const body = new FormData(event.currentTarget)\n    setLoading(true)\n    try {\n      const data = await post(\"login_api\", body)\n      const auth: Auth = {\n        id: data.userId,\n        email: body.get(\"username\") as string,\n        token: data.token,\n      }\n      login(auth)\n    } catch (error) {\n      if (error instanceof HttpError && error.code === 401) {\n        alert(\"Identifiant ou mot de passe incorrect\")\n      } else {\n        handleError(error as Error)\n      }\n      setLoading(false)\n    }\n  }\n\n  const handleClickShowPassword = () => {\n    setShowPassword(!showPassword)\n  }\n\n  return (\n    <Container maxWidth=\"xs\">\n      <Header>\n        <Logo />\n        <Typography variant=\"h1\">Planning</Typography>\n      </Header>\n      <form onSubmit={handleSubmit}>\n        <p>\n          Pour te connecter, l’identifiant et le mot de passe sont les mêmes que ceux que tu utilises pour aller sur\n          l’espace membres. Si tu réinitialises ton mot de passe, le changement sera donc valable aussi pour l’espace\n          membres.\n        </p>\n        <TextField type=\"email\" name=\"username\" label=\"E-mail\" fullWidth variant=\"outlined\" margin=\"normal\" />\n        <TextField\n          type={showPassword ? \"text\" : \"password\"}\n          name=\"password\"\n          label=\"Mot de passe\"\n          fullWidth\n          variant=\"outlined\"\n          margin=\"normal\"\n          InputProps={{\n            endAdornment: (\n              <Tooltip title={showPassword ? \"Cacher le mot de passe\" : \"Afficher le mot de passe\"}>\n                <IconButton aria-label=\"toggle password visibility\" onClick={handleClickShowPassword} edge=\"end\">\n                  {showPassword ? <VisibilityOff /> : <Visibility />}\n                </IconButton>\n              </Tooltip>\n            ),\n          }}\n        />\n        <ResetPassword>\n          <a href=\"https://adminchouettos.lachouettecoop.fr/resetting/request\">Mot de passe oublié ?</a>\n        </ResetPassword>\n        <ConexionButton type=\"submit\" fullWidth size=\"large\" variant=\"contained\" color=\"primary\" disabled={loading}>\n          Connexion\n        </ConexionButton>\n      </form>\n    </Container>\n  )\n}\n\nexport default LoginPage\n","export type ID = string\n\nexport enum RoleId {\n  GrandHibou = \"GH\",\n  Chouettos = \"CH\",\n  Caissier = \"CA\",\n  GrandHibou_Formateur = \"GHF\",\n  Caissier_Formateur = \"CAF\",\n  AdminMag = \"MAG\",\n  AdminBdM = \"BDM\",\n  PosteAccueil = \"PA\",\n  // only for icons:\n  PIAF = \"P\",\n  Formateur = \"F\",\n}\n\nexport interface Role {\n  id: ID\n  libelle: string\n  roleUniqueId: RoleId\n}\n\nexport interface CreneauGenerique {\n  id: ID\n  titre: string\n  frequence: string\n  jour: number\n  heureDebut: string // ISO datetime\n  heureFin: string // ISO datetime\n  actif: boolean\n  horsMag: boolean\n}\n\nexport interface Poste {\n  id: ID\n  reservationChouettos: User\n  creneauGenerique: CreneauGenerique\n  role: Role\n  description: string\n}\n\nexport interface Reserve {\n  id: ID\n  informations: string\n  user: User\n  creneauGeneriques: CreneauGenerique[]\n}\n\nexport interface User {\n  id: ID\n  email: string\n  username: string\n  rolesChouette: Role[]\n  enabled: boolean\n  civilite: string\n  nom: string\n  prenom: string\n  telephone: string\n  codeBarre: string\n  domaineCompetence: string\n  photo: string\n  dateNaissance: string // ISO datetime\n  notes: string\n  actif: boolean // what’s the difference with \"enabled\"?\n  carteImprimee: boolean\n  gh: boolean // grand hibou\n  poste: Poste\n  statut: string\n  reserve: Reserve\n  absenceLongueDureeCourses: boolean\n  absenceLongueDureeSansCourses: boolean\n  nbPiafEffectuees: number\n  nbPiafAttendues: number\n  nbPiafGH?: number\n  nbPiafCaisse?: number\n  affichageDonneesPersonnelles: boolean\n  attenteCommissionParticipation: boolean\n}\n\nexport interface Creneau {\n  id: ID\n  titre: string\n  creneauGenerique: CreneauGenerique | null\n  debut: string // ISO datetime\n  fin: string // ISO datetime\n  informations: string\n  horsMag: boolean\n  piafs: PIAF[]\n}\n\nexport interface InfoCreneau {\n  piaffeursCount: number\n  piaffeursCountFirstPiaf: number\n}\n\nexport interface PIAF {\n  id: ID\n  role: Role | null\n  piaffeur: User | null\n  creneau: Creneau\n  visible: boolean\n  pourvu: boolean\n  nonPourvu: boolean\n  statut: \"occupe\" | \"remplacement\" | \"\" | null // empty = available\n  informations: string | null\n  infoCreneau: InfoCreneau\n  description: string\n  dateReservation: string // ISO date (without time)\n}\n","import { Redirect, Route, Switch, useLocation } from \"react-router-dom\"\nimport { Container } from \"@material-ui/core\"\n\nimport LoginPage from \"src/pages/anonymous/Login\"\n\nconst Anonymous = () => {\n  const { pathname } = useLocation()\n\n  return (\n    <Container>\n      <Switch>\n        <Route path=\"/login\">\n          <LoginPage />\n        </Route>\n        <Redirect to={`/login?next=${pathname}`} />\n      </Switch>\n    </Container>\n  )\n}\n\nexport default Anonymous\n","import { createContext, useContext, useState, FC } from \"react\"\nimport { startOfMonth, endOfMonth, subMonths, addMonths } from \"date-fns\"\nimport { ApolloError, ApolloQueryResult, OperationVariables, useQuery } from \"@apollo/client\"\n\nimport { PLANNING } from \"src/graphql/queries\"\nimport { Creneau } from \"src/types/model\"\n\nexport interface IDatePlanningContext {\n  start: Date\n  end: Date\n  goBack: () => void\n  goForward: () => void\n  goToday: () => void\n  data?: Result\n  loading: boolean\n  error?: ApolloError\n  refetch: (variables?: Partial<OperationVariables> | undefined) => Promise<ApolloQueryResult<Result>>\n}\n\ntype Result = { creneaus: Creneau[] }\n\nconst DatePlanningContext = createContext<IDatePlanningContext>({} as IDatePlanningContext)\n\nconst getInitialStart = () => startOfMonth(new Date())\nconst getInitialEnd = () => endOfMonth(new Date())\n\nexport const DatePlanningProvider: FC = ({ children }) => {\n  const [start, setStart] = useState<Date>(getInitialStart)\n  const [end, setEnd] = useState<Date>(getInitialEnd)\n\n  const { data, loading, error, refetch } = useQuery<Result>(PLANNING, {\n    variables: { after: start, before: end },\n  })\n\n  const goBack = () => {\n    const date = subMonths(start, 1)\n    setStart(date)\n    setEnd(endOfMonth(date))\n  }\n\n  const goForward = () => {\n    const date = addMonths(start, 1)\n    setStart(date)\n    setEnd(endOfMonth(date))\n  }\n\n  const goToday = () => {\n    setStart(getInitialStart)\n    setEnd(getInitialEnd)\n  }\n\n  return (\n    <DatePlanningContext.Provider value={{ start, end, goBack, goForward, goToday, data, loading, error, refetch }}>\n      {children}\n    </DatePlanningContext.Provider>\n  )\n}\n\nexport function useDatePlanning() {\n  return useContext(DatePlanningContext) as IDatePlanningContext\n}\n","import { Link } from \"react-router-dom\"\n\nconst UniversalLink = ({ href, ...props }: React.AnchorHTMLAttributes<HTMLAnchorElement>) => {\n  if (href?.startsWith(\"/\")) {\n    return <Link to={href} {...props} />\n  }\n  return <a href={href} {...props} />\n}\n\nexport default UniversalLink\n","import { Role, RoleId } from \"src/types/model\"\n\nexport const hasRole = (id: RoleId, roles: Role[]) => {\n  return roles.some(({ roleUniqueId }) => roleUniqueId === id)\n}\n\nexport const hasAtLeastOneRole = (roleIds: RoleId[], rolesUser: Role[]) => {\n  return rolesUser.some(({ roleUniqueId }) => roleIds.includes(roleUniqueId))\n}\n\nexport const formatRoles = (roles: Role[]) => roles.map(({ libelle }) => libelle).join(\", \")\n","import { useState } from \"react\"\nimport { useLocation } from \"react-router\"\nimport clsx from \"clsx\"\nimport { createStyles, makeStyles, useTheme } from \"@material-ui/core/styles\"\nimport {\n  styled,\n  useMediaQuery,\n  Drawer,\n  AppBar,\n  Toolbar,\n  List,\n  Typography,\n  IconButton,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Button,\n  Box,\n  Chip,\n  Tooltip,\n} from \"@material-ui/core\"\nimport {\n  Menu as MenuIcon,\n  ChevronLeft as ChevronLeftIcon,\n  ChevronRight as ChevronRightIcon,\n  Group as GroupIcon,\n  Person as PersonIcon,\n  // Replay as ReplayIcon,\n  ArrowBack as ArrowBackIcon,\n  Home as HomeIcon,\n  Event as EventIcon,\n  Storefront as StorefrontIcon,\n  CardMembership as CardMembershipIcon,\n  History as HistoryIcon,\n} from \"@material-ui/icons\"\n\nimport Link from \"src/components/Link\"\nimport { useUser } from \"src/providers/user\"\nimport { hasAtLeastOneRole } from \"src/helpers/role\"\nimport { TEST } from \"src/helpers/apollo\"\nimport { formatName } from \"src/helpers/user\"\nimport { RoleId } from \"src/types/model\"\n\nconst DRAWER_WIDTH = 260\n\nconst Spacer = styled(Box)({\n  flexGrow: 1,\n})\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      display: \"flex\",\n    },\n    appBar: {\n      zIndex: theme.zIndex.drawer + 1,\n      transition: theme.transitions.create([\"width\", \"margin\"], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n    },\n    appBarShift: {\n      marginLeft: DRAWER_WIDTH,\n      width: `calc(100% - ${DRAWER_WIDTH}px)`,\n      transition: theme.transitions.create([\"width\", \"margin\"], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    menuButton: {\n      marginRight: 36,\n    },\n    hide: {\n      display: \"none\",\n    },\n    drawer: {\n      width: DRAWER_WIDTH,\n      flexShrink: 0,\n      whiteSpace: \"nowrap\",\n    },\n    drawerOpen: {\n      width: DRAWER_WIDTH,\n      transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    drawerClose: {\n      transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n      overflowX: \"hidden\",\n      width: theme.spacing(7) + 1,\n      [theme.breakpoints.up(\"sm\")]: {\n        width: theme.spacing(9) + 1,\n      },\n    },\n    toolbar: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"flex-end\",\n      padding: theme.spacing(0, 1),\n      // necessary for content to be below app bar\n      ...theme.mixins.toolbar,\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(3),\n    },\n    menuItem: {\n      textDecoration: \"none\",\n      color: theme.palette.secondary.main,\n    },\n    activeItem: {\n      textDecoration: \"none\",\n      color: theme.palette.primary.main,\n    },\n  })\n)\n\nconst ITEMS = [\n  { title: \"Accueil\", href: \"/home\", Icon: HomeIcon, roles: [RoleId.Chouettos] },\n  { title: \"Planning\", href: \"/planning\", Icon: EventIcon, roles: [RoleId.Chouettos, RoleId.PosteAccueil] },\n  { title: \"Réserve\", href: \"/reserve\", Icon: GroupIcon, roles: [RoleId.Chouettos] },\n  /* {\n    title: \"Réservation automatique\",\n    href: \"/auto\",\n    Icon: ReplayIcon,\n    roles: [RoleId.Chouettos],\n  },*/\n  { title: \"Mon profil\", href: \"/profile\", Icon: PersonIcon, roles: [RoleId.Chouettos] },\n  { title: \"Historique des PIAF\", href: \"/history\", Icon: HistoryIcon, roles: [RoleId.Chouettos] },\n  { title: \"Groupe MAG\", href: \"/magasin\", Icon: StorefrontIcon, roles: [RoleId.AdminMag] },\n  { title: \"Groupe BdM\", href: \"/bdm\", Icon: CardMembershipIcon, roles: [RoleId.AdminBdM] },\n  {\n    title: \"Espace membre\",\n    href: \"https://espace-membres.lachouettecoop.fr/page/homepage\",\n    Icon: ArrowBackIcon,\n    roles: [RoleId.Chouettos],\n  },\n]\n\nconst Menu = () => {\n  const classes = useStyles()\n  const { user, logout } = useUser<true>()\n  const theme = useTheme()\n  const [open, setOpen] = useState(false)\n  const { pathname } = useLocation()\n  const matches = useMediaQuery(theme.breakpoints.up(\"sm\"))\n\n  const handleDrawerOpen = () => {\n    setOpen(true)\n  }\n\n  const handleDrawerClose = () => {\n    setOpen(false)\n  }\n\n  if (!matches) {\n    return null\n  }\n\n  const userRoles = user?.rolesChouette || []\n\n  return (\n    <div className={classes.root}>\n      <AppBar\n        position=\"fixed\"\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open,\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, {\n              [classes.hide]: open,\n            })}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" noWrap>\n            Planning {TEST && <Chip label=\"TEST\" />}\n          </Typography>\n          <Spacer />\n          <PersonIcon />\n          {user && formatName(user)}\n          <Spacer />\n          <Button onClick={logout} color=\"inherit\">\n            Déconnexion\n          </Button>\n        </Toolbar>\n      </AppBar>\n      <Toolbar />\n      <Drawer\n        variant=\"permanent\"\n        className={clsx(classes.drawer, {\n          [classes.drawerOpen]: open,\n          [classes.drawerClose]: !open,\n        })}\n        classes={{\n          paper: clsx({\n            [classes.drawerOpen]: open,\n            [classes.drawerClose]: !open,\n          }),\n        }}\n      >\n        <div className={classes.toolbar}>\n          <IconButton onClick={handleDrawerClose}>\n            {theme.direction === \"rtl\" ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n          </IconButton>\n        </div>\n        <List>\n          {ITEMS.filter(({ roles }) => hasAtLeastOneRole(roles, userRoles)).map(({ href, title, Icon }) => {\n            const active = pathname === href\n            return (\n              <Link className={active ? classes.activeItem : classes.menuItem} href={href} key={href}>\n                <Tooltip title={title}>\n                  <ListItem button>\n                    <ListItemIcon>\n                      <Icon color={active ? \"primary\" : \"secondary\"} />\n                    </ListItemIcon>\n                    <ListItemText primary={title} />\n                  </ListItem>\n                </Tooltip>\n              </Link>\n            )\n          })}\n        </List>\n      </Drawer>\n    </div>\n  )\n}\n\nexport default Menu\n","import { useState } from \"react\"\nimport { Link, useLocation } from \"react-router-dom\"\nimport { createStyles, useTheme, makeStyles } from \"@material-ui/core/styles\"\nimport {\n  useMediaQuery,\n  Menu,\n  MenuItem,\n  ListItem,\n  ListItemText,\n  ListItemIcon,\n  AppBar,\n  Toolbar,\n  IconButton,\n} from \"@material-ui/core\"\nimport { MoreVert as MoreIcon, Group as GroupIcon, Event as EventIcon, Home as HomeIcon } from \"@material-ui/icons\"\n\nimport { RoleId } from \"src/types/model\"\nimport { hasAtLeastOneRole } from \"src/helpers/role\"\nimport { useUser } from \"src/providers/user\"\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    appBar: {\n      top: \"auto\",\n      bottom: 0,\n    },\n    toolbar: {\n      justifyContent: \"space-between\",\n    },\n    label: {\n      // Aligns the content of the button vertically.\n      flexDirection: \"column\",\n    },\n    menu: {\n      \"& ul\": {\n        paddingTop: \"0 !important\",\n        paddingBottom: \"0 !important\",\n      },\n    },\n    textMenuDecoration: {\n      textDecoration: \"none\",\n    },\n    menuItem: {\n      color: \"rgba(255, 255, 255, 0.54)\",\n      backgroundColor: theme.palette.primary.main,\n      \"&:hover\": {\n        backgroundColor: theme.palette.primary.main,\n      },\n    },\n    activeItem: {\n      color: \"white\",\n      backgroundColor: theme.palette.primary.main,\n      \"&:hover\": {\n        backgroundColor: theme.palette.primary.main,\n      },\n    },\n    icon: {\n      justifyContent: \"center\",\n      \"& svg\": {\n        fill: \"rgba(255, 255, 255, 0.54)\",\n      },\n    },\n    activeIcon: {\n      justifyContent: \"center\",\n      \"& svg\": {\n        fill: \"white\",\n      },\n    },\n  })\n)\n\nconst MAIN_ITEMS = [\n  { title: \"Accueil\", href: \"/home\", Icon: HomeIcon, roles: [RoleId.Chouettos] },\n  { title: \"Planning\", href: \"/planning\", Icon: EventIcon, roles: [RoleId.Chouettos, RoleId.PosteAccueil] },\n  { title: \"Réserve\", href: \"/reserve\", Icon: GroupIcon, roles: [RoleId.Chouettos] },\n]\nconst EXTRA_ITEMS = [\n  //{ title: \"Auto\", href: \"/auto\", roles: [RoleId.Chouettos] },\n  { title: \"Mon profil\", href: \"/profile\", roles: [RoleId.Chouettos] },\n  { title: \"Historique des PIAF\", href: \"/history\", roles: [RoleId.Chouettos] },\n  { title: \"Espace membre\", href: \"/member\", roles: [RoleId.Chouettos] },\n  { title: \"Groupe MAG\", href: \"/magasin\", roles: [RoleId.AdminMag] },\n  { title: \"Groupe BdM\", href: \"/bdm\", roles: [RoleId.AdminBdM] },\n]\n\nexport default function BottomAppBar() {\n  const classes = useStyles()\n  const { user, logout } = useUser<true>()\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null)\n  const theme = useTheme()\n  const { pathname } = useLocation()\n  const matches = useMediaQuery(theme.breakpoints.down(\"xs\"))\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget)\n  }\n\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  const userRoles = user?.rolesChouette || []\n\n  if (!matches) {\n    return null\n  }\n\n  return (\n    <>\n      <AppBar position=\"fixed\" color=\"primary\" className={classes.appBar}>\n        <Toolbar className={classes.toolbar}>\n          {MAIN_ITEMS.filter(({ roles }) => hasAtLeastOneRole(roles, userRoles)).map(({ href, title, Icon }) => {\n            const active = pathname === href\n            return (\n              <ListItem button className={classes.label} key={title} component={Link} to={href}>\n                <ListItemIcon className={active ? classes.activeIcon : classes.icon}>\n                  <Icon />\n                </ListItemIcon>\n                <ListItemText className={active ? classes.activeItem : classes.menuItem} primary={title} />\n              </ListItem>\n            )\n          })}\n          <Menu\n            id=\"simple-menu\"\n            className={classes.menu}\n            anchorEl={anchorEl}\n            keepMounted\n            open={Boolean(anchorEl)}\n            onClose={handleClose}\n          >\n            {EXTRA_ITEMS.filter(({ roles }) => hasAtLeastOneRole(roles, userRoles)).map(({ href, title }) => {\n              const active = pathname === href\n              return (\n                <MenuItem\n                  key={title}\n                  className={active ? classes.activeItem : classes.menuItem}\n                  onClick={handleClose}\n                  component={Link}\n                  to={href}\n                >\n                  {title}\n                </MenuItem>\n              )\n            })}\n\n            <MenuItem onClick={logout} key=\"Logout\" className={classes.menuItem} color=\"inherit\">\n              Déconnexion\n            </MenuItem>\n          </Menu>\n          <IconButton aria-controls=\"simple-menu\" aria-haspopup=\"true\" onClick={handleClick} edge=\"end\" color=\"inherit\">\n            <MoreIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n    </>\n  )\n}\n","import { format } from \"date-fns\"\nimport fr from \"date-fns/locale/fr\"\n\nconst getDate = (date: Date | number | string) => {\n  if (typeof date !== \"object\") {\n    return new Date(date)\n  }\n  return date\n}\n\nconst formatInFrench = (date: Date | number | string, pattern: string) => format(getDate(date), pattern, { locale: fr })\n\nexport const formatDateShort = (date: Date | number | string) => formatInFrench(date, \"EEEE d MMM\")\nexport const formatDateLong = (date: Date | number | string) => formatInFrench(date, \"EEEE d MMMM yyyy\")\n\nexport const formatMonthYear = (date: Date | number | string) => formatInFrench(date, \"MMMM yyyy\")\n\nexport const formatTime = (date: Date | number | string) => formatInFrench(date, \"HH:mm\")\n\nexport const formatDateTime = (date: Date | number | string) => formatInFrench(date, \"EEEE d MMMM yyyy à HH:mm\")\n\nexport const formatDateInterval = (start: Date | number | string, end: Date | number | string) => {\n  start = getDate(start)\n  end = getDate(end)\n\n  let startPattern = \"d\"\n  if (start.getFullYear() !== end.getFullYear()) {\n    startPattern = \"d MMMM yyyy\"\n  } else if (start.getMonth() !== end.getMonth()) {\n    startPattern = \"d MMMM\"\n  } else if (start.getDate() === end.getDate()) {\n    return formatDateLong(start)\n  }\n  return `du ${formatInFrench(start, startPattern)} au ${formatInFrench(end, \"d MMMM yyyy\")}`\n}\n\nconst WEEKDAYS = [\"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\", \"Dimanche\"]\nexport const getDayOfWeek = (index: number) => WEEKDAYS[index]\n\nexport const queryDate = (date: Date | number) => format(date, \"yyyy-MM-dd\")\n","import styled from \"@emotion/styled/macro\"\nimport { CircularProgress } from \"@material-ui/core\"\n\nconst Loader = styled(CircularProgress)`\n  margin: 16px 0;\n`\n\nexport default Loader\n","import { differenceInDays } from \"date-fns\"\nimport type { ISlot, IWeekId } from \"src/types/app\"\n\nimport { PIAF, RoleId } from \"src/types/model\"\n\nexport const CRITICAL_DAYS = 5 // until how many days ahead a slot can be critical\nconst CRITICAL_RATIO = 75 // % minimum ratio of taken PIAFs to not be a critical slot\n\nexport const getPiafRole = ({ role }: PIAF) => {\n  if (!role) {\n    return null\n  }\n  return role.roleUniqueId\n}\n\nexport const isTaken = (piaf: PIAF) => {\n  if (piaf.statut === \"remplacement\") {\n    return false\n  }\n  return Boolean(piaf.piaffeur)\n}\n\nexport const isCritical = (slot: ISlot, piaf: PIAF) => {\n  if (isTaken(piaf)) {\n    return false\n  }\n  if (!slot.piafs) {\n    return false\n  }\n  if (slot.horsMag) {\n    return false\n  }\n  if (differenceInDays(slot.start, new Date()) > CRITICAL_DAYS) {\n    return false\n  }\n  if (slot.title.toLowerCase().toString().startsWith(\"formation\")) {\n    return false\n  }\n  if (piaf.role?.roleUniqueId == RoleId.GrandHibou || piaf.role?.roleUniqueId == RoleId.Caissier) {\n    return true\n  }\n  // TODO: we might want to calculate a ratio per type of slot instead of overall\n  const countTaken = slot.piafs.filter(isTaken).length\n  const ratio = (100 * countTaken) / slot.piafs.length\n  return ratio < CRITICAL_RATIO\n}\n\nexport const orderPiafsByDate = (left: PIAF, right: PIAF) => (left.creneau.debut > right.creneau.debut ? 1 : -1)\nexport const orderPiafsByRoleId = (left: PIAF, right: PIAF) => {\n  if (!left.role) {\n    return -2\n  }\n  if (!right.role) {\n    return 2\n  }\n  return left.role.id > right.role.id ? 1 : -1\n}\n\nexport const getWeekId = (creneauGenerique: string): IWeekId => {\n  const num = Number(creneauGenerique)\n  return num ? String.fromCharCode(64 + num) : creneauGenerique\n}\n","import InfoIcon from \"@material-ui/icons/Info\"\n\nimport type { PIAF } from \"src/types/model\"\n\nimport styled from \"@emotion/styled/macro\"\n\nimport { RoleId } from \"src/types/model\"\nimport { getPiafRole, isTaken } from \"src/helpers/piaf\"\nimport { Tooltip } from \"@material-ui/core\"\n\nconst KNOWN_ROLES = Object.values(RoleId)\n\nconst Svg = styled.svg<{ $taken?: boolean; $critical?: boolean }>`\n  flex-shrink: 0;\n  display: inline-block;\n  margin: 3px;\n  width: 32px;\n  height: 32px;\n  opacity: ${({ $taken }) => ($taken ? 0.25 : 1)};\n  use {\n    fill: ${({ $critical }) => ($critical ? \"#e53935\" : \"black\")};\n  }\n`\n\nconst InfoIconPiaf = styled(InfoIcon)`\n  position: absolute;\n  z-index: 10;\n  left: -5px;\n  top: 0px;\n  height: 1rem !important;\n`\n\nconst ImageContainer = styled.div`\n  position: relative;\n`\n\ninterface RoleProps {\n  role?: RoleId | null\n  taken?: boolean\n  critical?: boolean\n  info?: string\n}\n\nexport const PiafIcon = ({ role, taken, critical, info }: RoleProps) => {\n  if (!role || !KNOWN_ROLES.includes(role)) {\n    role = RoleId.Chouettos\n  }\n  return (\n    <Tooltip title={info ? info : \"\"}>\n      <ImageContainer>\n        {info && <InfoIconPiaf />}\n        <Svg $taken={taken} $critical={critical}>\n          <use xlinkHref={\"#\" + role} width=\"100%\" height=\"100%\" />\n        </Svg>\n      </ImageContainer>\n    </Tooltip>\n  )\n}\n\ninterface Props {\n  piaf: PIAF\n  critical?: boolean\n  displayTooltip?: boolean | false\n}\n\nconst PiafCircle = ({ piaf, critical, displayTooltip }: Props) => (\n  <>\n    <PiafIcon\n      role={getPiafRole(piaf)}\n      taken={isTaken(piaf)}\n      critical={critical}\n      info={displayTooltip ? piaf.informations || \"\" : \"\"}\n    />\n  </>\n)\n\nexport default PiafCircle\n","import type { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport { Button, TextField } from \"@material-ui/core\"\nimport { Save } from \"@material-ui/icons\"\n\nimport styled from \"@emotion/styled/macro\"\nimport { startOfWeek, endOfWeek, startOfDay, endOfDay, isPast } from \"date-fns\"\n\nimport { PIAF, User, RoleId } from \"src/types/model\"\nimport PiafCircle from \"src/components/PiafCircle\"\nimport { useDialog } from \"src/providers/dialog\"\nimport { useRoles } from \"src/providers/roles\"\nimport { useUser } from \"src/providers/user\"\nimport { useDatePlanning } from \"src/providers/datePlanning\"\nimport { PIAFS_COUNT, REGISTRATION_UPDATE, PIAF_GET } from \"src/graphql/queries\"\nimport apollo from \"src/helpers/apollo\"\nimport { hasRole } from \"src/helpers/role\"\nimport { handleError } from \"src/helpers/errors\"\nimport { isTaken, getPiafRole, isCritical } from \"src/helpers/piaf\"\nimport { sendEmail } from \"src/helpers/request\"\nimport { formatDateTime, formatDateShort, queryDate } from \"src/helpers/date\"\nimport { formatName } from \"src/helpers/user\"\n\nconst MAX_PIAF_PER_WEEK = 3\nconst MAX_PIAF_PER_DAY = 2\n//const PERCENTAGE_NEW_CHOUETTOS = 50\nconst ADMIN_ROLES = [RoleId.AdminBdM, RoleId.AdminMag]\n\nconst Row = styled.div`\n  margin: 0 0 1rem 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n  button {\n    margin-left: 8px;\n  }\n`\nconst Status = styled.div`\n  flex: 1;\n  margin: 0 8px;\n  span {\n    color: ${({ theme }) => theme.palette.grey[600]};\n  }\n`\nconst Contact = styled.div`\n  text-align: right;\n  a {\n    text-decoration: none;\n  }\n`\nconst InfoTextField = styled(TextField)`\n  flex: 1;\n`\nconst InfoPiaf = styled.div`\n  display: block;\n`\n\nconst ButtonSave = styled.div`\n  .MuiButton-root {\n    min-width: 32px;\n  }\n  .MuiButton-startIcon {\n    margin-right: -4px;\n  }\n  .MuiButton-endIcon {\n    margin-left: -4px;\n  }\n`\n\ntype ResultPiafsCount = { piafs: PIAF[] }\ntype ResultGetPiaf = { piaf: PIAF }\n\nconst getPiafCount = async (slot: ISlot, userId: string, type: \"week\" | \"day\") => {\n  const after = type === \"day\" ? startOfDay(slot.start) : startOfWeek(slot.start)\n  const before = type === \"day\" ? endOfDay(slot.start) : endOfWeek(slot.start)\n  const { data } = await apollo.query<ResultPiafsCount>({\n    query: PIAFS_COUNT,\n    variables: { userId, after, before },\n  })\n  //The filter by statut on the database does not work\n  return data.piafs.filter((p) => p.statut === \"occupe\" && p.nonPourvu === false).length\n}\n/*\nFeature not available due to the reset of the counters\nconst checkMaximumNumberOfNewChouettos = (user: User, piaf: PIAF) => {\n  // There is a maximum percentage for PIAF of new Chouettos\n  if (user.nbPiafEffectuees === 0) {\n    const piafeursCount = piaf.infoCreneau.piaffeursCount\n    const maxPiafeursFirstPiaf = Math.floor((piafeursCount * PERCENTAGE_NEW_CHOUETTOS) / 100)\n    const piafeursFirstPiaf = piaf.infoCreneau.piaffeursCountFirstPiaf\n\n    if (piafeursFirstPiaf >= maxPiafeursFirstPiaf) {\n      return false\n    }\n  }\n  return true\n}*/\nconst getRegistrationPiaf = (slot: ISlot, piaf: PIAF) => {\n  const replacementPiaf = slot.piafs?.find(\n    ({ statut, role }) => statut === \"remplacement\" && role?.id === piaf.role?.id\n  )\n  if (replacementPiaf) {\n    // If there is a PIAF with status \"remplacement\" and the same role,\n    // the user will be registered in it instead of the requested one.\n    return replacementPiaf\n  }\n  return piaf\n}\n\nconst getGHEmail = (slot: ISlot) => {\n  const GHPiaf = slot.piafs?.find(({ statut, role }) => statut === \"occupe\" && role?.id === RoleId.GrandHibou)\n  return GHPiaf?.piaffeur?.email\n}\n\nconst sendEmailReplacedPiaf = (piaf: PIAF, slot: ISlot, user: User) => {\n  const replacedUserMail = (piaf.piaffeur as User).email\n  if (replacedUserMail) {\n    sendEmail(\n      replacedUserMail,\n      \"PIAF remplacée\",\n      `Ta PIAF du ${formatDateTime(slot.start)} a été pourvue. Tu n’es plus en charge de cette PIAF.`\n    )\n  }\n\n  if (piaf.role?.roleUniqueId != RoleId.GrandHibou) {\n    const ghEmail = getGHEmail(slot)\n    if (ghEmail) {\n      sendEmail(\n        ghEmail,\n        \"PIAF remplacée\",\n        `La PIAF du ${formatDateTime(slot.start)} a été pourvue.\n        ${formatName(user)} est maintenant inscrit pour cette PIAF.`\n      )\n    }\n  }\n}\n\ninterface Props {\n  piaf: PIAF\n  slot: ISlot\n}\n\nconst PiafRow = ({ piaf, slot }: Props) => {\n  const [loading, setLoading] = useState(false)\n  const [info, setInfo] = useState(piaf?.informations || \"\")\n  const { openDialog, openQuestion } = useDialog()\n  const { user } = useUser<true>()\n  const roles = useRoles()\n  const { refetch } = useDatePlanning()\n\n  const currentUserIsAdmin = user\n    ? ADMIN_ROLES.some((role) => user.rolesChouette.some(({ roleUniqueId }) => roleUniqueId === role))\n    : false\n\n  const currentUserInSlot =\n    user && slot.piafs?.find(({ piaffeur, statut }) => piaffeur?.id === user.id && statut === \"occupe\")\n\n  const currentUser = user as User\n\n  const handleInputChange = ({ target }: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    setInfo(target.value)\n  }\n\n  const saveInfo = async () => {\n    const loggedUser = user as User\n    await apollo.mutate({\n      mutation: REGISTRATION_UPDATE,\n      variables: {\n        piafId: piaf.id,\n        userId: loggedUser.id,\n        statut: \"occupe\",\n        informations: info,\n      },\n    })\n  }\n\n  const checksBeforeRegister = async (loggedUser: User) => {\n    if (loggedUser.absenceLongueDureeCourses || loggedUser.absenceLongueDureeSansCourses) {\n      openDialog(\n        \"Ta participation aux PIAF du magasin est actuellement en pause. Tu peux la reprendre depuis la page d'accueil pour pouvoir t’inscrire à nouveau sur le planning\"\n      )\n      return false\n    }\n    //Check if the PIAF has still no registered person\n    const { data } = await apollo.query<ResultGetPiaf>({\n      query: PIAF_GET,\n      variables: { id: piaf.id },\n    })\n    if (data.piaf.piaffeur && data.piaf.statut == \"occupe\") {\n      openDialog(\"La PIAF a été déjà prise par un autre chouettos\")\n      refetch()\n      return false\n    }\n\n    if (!piaf.role) {\n      openDialog(\"Cette PIAF n’a pas de rôle. Contacte l’administrateur pour lui signaler cette erreur.\")\n      return false\n    }\n\n    const userRoles = user?.rolesChouette\n    if (!userRoles || !hasRole(piaf.role.roleUniqueId, userRoles)) {\n      setLoading(false)\n      openDialog(`Pour t’inscrire à cette PIAF, tu dois d’abord passer la formation ${piaf.role.libelle}`)\n      return false\n    }\n\n    const piafOfWeek = await getPiafCount(slot, loggedUser.id, \"week\")\n    if (piafOfWeek >= MAX_PIAF_PER_WEEK) {\n      setLoading(false)\n      openDialog(`Il n’est pas possible de s’inscrire à plus de ${MAX_PIAF_PER_WEEK} PIAF par semaine`)\n      return false\n    }\n\n    const piafOfDay = await getPiafCount(slot, loggedUser.id, \"day\")\n    if (piafOfDay >= MAX_PIAF_PER_DAY) {\n      setLoading(false)\n      openDialog(`Il n’est pas possible de s’inscrire à plus de ${MAX_PIAF_PER_DAY} PIAF par jour`)\n      return false\n    }\n\n    /* if (!checkMaximumNumberOfNewChouettos(loggedUser, piaf)) {\n      setLoading(false)\n      openDialog(`Il n’est pas possible d’avoir plus de ${PERCENTAGE_NEW_CHOUETTOS}% de nouveaux chouettos par PIAF`)\n      return false\n    }\n*/\n    return true\n  }\n\n  const register = async () => {\n    const loggedUser = user as User\n    if (!(await checksBeforeRegister(loggedUser))) return\n\n    try {\n      const ok = await openQuestion(\n        `Es-tu sûr·e de vouloir t’inscrire à cette PIAF du ${formatDateShort(slot.start)} en tant que ${\n          piaf.role?.libelle\n        }?`\n      )\n\n      if (!ok) {\n        return\n      }\n\n      setLoading(true)\n      const registrationPiaf = getRegistrationPiaf(slot, piaf)\n      if (registrationPiaf.statut === \"remplacement\") {\n        sendEmailReplacedPiaf(registrationPiaf, slot, loggedUser)\n      }\n\n      await apollo.mutate({\n        mutation: REGISTRATION_UPDATE,\n        variables: {\n          piafId: registrationPiaf.id,\n          userId: loggedUser.id,\n          statut: \"occupe\",\n          informations: info,\n          registrationDate: queryDate(new Date()),\n        },\n      })\n\n      openDialog(\"Inscription effectuée. Merci !\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n\n    setLoading(false)\n  }\n\n  const unregister = async () => {\n    const ok = await openQuestion(\n      `N’oublie pas de chercher un·e remplaçant·e sur Facebook, Zulip, appel aux autres Chouettos… Plus ton créneau est proche, plus c’est important! Es-tu sûr·e de vouloir te désinscrire ?`\n    )\n\n    if (!ok) {\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      setInfo(\"\")\n\n      const userId = (user as User).id\n\n      await apollo.mutate({\n        mutation: REGISTRATION_UPDATE,\n        variables: { piafId: piaf.id, userId, statut: \"remplacement\", informations: null },\n      })\n\n      openDialog(\"Désinscription effectuée : la PIAF est désormais en recherche de remplacement !\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n\n    setLoading(false)\n  }\n\n  const { piaffeur, informations } = piaf\n  const taken = isTaken(piaf)\n  const isFuture = !isPast(slot.end)\n  const piafRole = roles.find(({ roleUniqueId }) => roleUniqueId == getPiafRole(piaf))\n\n  // show contact infos only if:\n  //   the current user is the GH of the slot\n  //   is an admin\n  //   the user displayed has accepted to share the info\n  const showInfos =\n    currentUserIsAdmin ||\n    currentUserInSlot?.role?.roleUniqueId === RoleId.GrandHibou ||\n    piaffeur?.affichageDonneesPersonnelles\n\n  return (\n    <Row>\n      <PiafCircle piaf={piaf} critical={isCritical(slot, piaf)} />\n      <Status>\n        {taken && piaffeur ? formatName(piaffeur) : \"Place disponible\"}\n        <br />\n        <span> {piafRole?.libelle}</span>\n        {piaf.description ? <span> - {piaf.description}</span> : \"\"}\n      </Status>\n      {taken && (\n        <Contact>\n          {showInfos && piaffeur && piaffeur?.id !== user?.id && (\n            <>\n              <a href={`mailto:${piaffeur.email}`}>{piaffeur.email}</a>\n              <br />\n              <a href={`tel:${piaffeur.telephone}`}>{piaffeur.telephone}</a>\n              <br />\n            </>\n          )}\n          {piaffeur?.id !== user?.id && <div>{informations}</div>}\n          {piaffeur?.id === user?.id && isFuture && !hasRole(RoleId.PosteAccueil, currentUser.rolesChouette) && (\n            <>\n              <Row>\n                {\" \"}\n                <InfoTextField\n                  name=\"informations\"\n                  multiline\n                  label=\"Commentaire (optionnel)\"\n                  value={info}\n                  onChange={handleInputChange}\n                />\n                <ButtonSave>\n                  <Button\n                    disabled={loading}\n                    startIcon={<Save />}\n                    color=\"primary\"\n                    variant=\"contained\"\n                    onClick={saveInfo}\n                  />\n                </ButtonSave>\n              </Row>\n\n              <InfoPiaf>\n                <Button disabled={loading} color=\"primary\" variant=\"contained\" onClick={unregister}>\n                  Demander un remplacement\n                </Button>\n              </InfoPiaf>\n            </>\n          )}\n        </Contact>\n      )}\n\n      {!taken && !currentUserInSlot && isFuture && !hasRole(RoleId.PosteAccueil, currentUser.rolesChouette) && (\n        <>\n          <InfoTextField\n            name=\"informations\"\n            multiline\n            label=\"Commentaire (optionnel)\"\n            value={info}\n            onChange={handleInputChange}\n          />\n          <Button disabled={loading} color=\"primary\" variant=\"contained\" onClick={register}>\n            S’inscrire\n          </Button>\n        </>\n      )}\n    </Row>\n  )\n}\n\nexport default PiafRow\n","import type { ISlot } from \"src/types/app\"\n\nimport { capitalize, Dialog, DialogContent, DialogTitle, IconButton, Typography } from \"@material-ui/core\"\nimport { Close } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\n\nimport Loader from \"src/components/Loader\"\nimport PiafRow from \"src/components/PiafRow\"\nimport { formatTime, formatDateLong } from \"src/helpers/date\"\n\nconst CloseButton = styled(IconButton)`\n  position: absolute;\n  right: 8px;\n  top: 8px;\n`\nconst Title = styled.div`\n  h3 {\n    font-size: 1.5em;\n    margin-bottom: 8px;\n  }\n  h4 {\n    font-size: 1.2em;\n  }\n  span {\n    color: ${({ theme }) => theme.palette.grey[600]};\n    margin-left: 5px;\n    font-weight: 500;\n  }\n`\n\ninterface Props {\n  slot: ISlot\n  show: boolean\n  handleClose: (event: React.MouseEvent<HTMLButtonElement>) => void\n}\n\nconst SlotDialog = ({ slot, show, handleClose }: Props) => {\n  return (\n    <Dialog open={show} onClose={handleClose} fullWidth>\n      <CloseButton onClick={handleClose}>\n        <Close />\n      </CloseButton>\n      <DialogTitle disableTypography>\n        <Title>\n          <Typography variant=\"h3\">{capitalize(formatDateLong(slot.start))}</Typography>\n          <Typography variant=\"h4\">\n            <strong>\n              {formatTime(slot.start)}–{formatTime(slot.end)}\n            </strong>\n            <span>{slot.title}</span>\n          </Typography>\n          <div>{slot.information}</div>\n        </Title>\n      </DialogTitle>\n      <DialogContent>\n        {slot.piafs ? slot.piafs.map((piaf) => <PiafRow key={piaf.id} piaf={piaf} slot={slot} />) : <Loader />}\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport default SlotDialog\n","import type { Creneau, PIAF } from \"src/types/model\"\nimport { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport { ListItem, ListItemAvatar, ListItemText, Checkbox, FormControlLabel, Grid, FormGroup } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\nimport { useLazyQuery } from \"@apollo/client\"\n\nimport PiafCircle from \"src/components/PiafCircle\"\nimport SlotDialog from \"src/components/SlotDialog\"\nimport { PIAF_NON_POURVU, SLOTS } from \"src/graphql/queries\"\nimport { useDialog } from \"src/providers/dialog\"\nimport { VALIDATE_PIAF } from \"src/graphql/queries\"\nimport { formatDateLong, formatTime } from \"src/helpers/date\"\nimport apollo from \"src/helpers/apollo\"\nimport { handleError } from \"src/helpers/errors\"\n\nconst Bordered = styled(Grid)`\n  border: 1px solid gray;\n  border-radius: 5px;\n  margin-bottom: 2px;\n`\n\ninterface Result {\n  creneau: Creneau\n}\n\ninterface Props {\n  piaf: PIAF\n  allowValidate?: boolean\n  critical?: boolean\n}\n\nconst Piaf = ({ piaf, allowValidate, critical }: Props) => {\n  const { creneau } = piaf\n  const [open, setOpen] = useState(false)\n  const { openQuestion, openDialog } = useDialog()\n\n  const [load, { data }] = useLazyQuery<Result>(SLOTS, {\n    variables: { id: creneau.id },\n  })\n\n  const handleClick = () => {\n    setOpen(true)\n    load()\n  }\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  const handleValidate = async (piafId: string) => {\n    const ok = await openQuestion(\"Es-tu sûr·e de vouloir valider cette PIAF ?\")\n\n    if (!ok) {\n      return\n    }\n\n    const variables: Record<string, any> = {\n      piafId,\n      validate: true,\n    }\n\n    try {\n      await apollo.mutate({\n        mutation: VALIDATE_PIAF,\n        variables,\n      })\n\n      openDialog(\"La PIAF a été validée\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n  }\n\n  const handleNonPourvue = async (piafId: string) => {\n    const ok = await openQuestion(\"Es-tu sûr·e de vouloir indiquer cette PIAF comme non pourvue?\")\n\n    if (!ok) {\n      return\n    }\n\n    const variables: Record<string, any> = {\n      piafId,\n      nonPourvu: true,\n    }\n\n    try {\n      await apollo.mutate({\n        mutation: PIAF_NON_POURVU,\n        variables,\n      })\n\n      openDialog(\"La PIAF a été indiqué comme non pourvue\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n  }\n\n  const slot: ISlot = {\n    id: creneau.id,\n    title: creneau.titre,\n    information: creneau.informations,\n    start: new Date(creneau.debut),\n    end: new Date(creneau.fin),\n    horsMag: creneau.horsMag,\n    piafs: data?.creneau.piafs,\n  }\n\n  const Container = allowValidate ? Bordered : Grid\n\n  return (\n    <Container container>\n      <Grid item xs={8}>\n        <ListItem key={piaf.id} button onClick={handleClick}>\n          <ListItemAvatar>\n            <PiafCircle piaf={piaf} critical={critical} />\n          </ListItemAvatar>\n          <ListItemText\n            primary={formatDateLong(slot.start)}\n            secondary={`de ${formatTime(slot.start)} à ${formatTime(slot.end)}`}\n          />\n        </ListItem>\n      </Grid>\n      <Grid item xs={4}>\n        {allowValidate && (\n          <FormGroup>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={piaf.pourvu}\n                  name=\"validatePIAF\"\n                  onChange={() => {\n                    handleValidate(piaf.id)\n                  }}\n                />\n              }\n              label=\"Valider\"\n            />\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={piaf.nonPourvu}\n                  name=\"nonPourvu\"\n                  onChange={() => {\n                    handleNonPourvue(piaf.id)\n                  }}\n                />\n              }\n              label=\"Non pourvue\"\n            />\n          </FormGroup>\n        )}\n      </Grid>\n      <SlotDialog show={open} slot={slot} handleClose={handleClose} />\n    </Container>\n  )\n}\n\nexport default Piaf\n","import type { PIAF } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { List } from \"@material-ui/core\"\nimport { Link } from \"react-router-dom\"\n\nimport Loader from \"src/components/Loader\"\nimport Piaf from \"src/components/Piaf\"\nimport { PIAFS } from \"src/graphql/queries\"\nimport { ErrorMessage } from \"src/helpers/errors\"\nimport { orderPiafsByDate } from \"src/helpers/piaf\"\n\ntype Result = { piafs: PIAF[] }\ninterface Props {\n  userId?: string\n  after?: string\n  validated?: boolean\n  allowValidate?: boolean\n}\nconst currentDate = new Date(Date.now())\n\nconst UserPiafs = ({ userId, after, validated = false, allowValidate = false }: Props) => {\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: { userId, after, validated },\n    skip: !userId,\n  })\n\n  if (loading || !userId) {\n    return <Loader />\n  }\n\n  if (error) {\n    return <ErrorMessage error={error} />\n  }\n\n  if (!data) {\n    return null\n  }\n\n  const piafs = data.piafs\n    .filter(\n      ({ statut, nonPourvu, creneau }) =>\n        statut !== \"remplacement\" &&\n        nonPourvu == false &&\n        ((allowValidate && new Date(creneau.fin) < currentDate) ||\n          (!allowValidate && new Date(creneau.fin) > currentDate))\n    )\n    .sort(orderPiafsByDate)\n\n  if (!piafs.length && !allowValidate) {\n    return (\n      <p>\n        Aucune PIAF à venir. Inscris-toi sur <Link to=\"/planning\">le planning</Link> !\n      </p>\n    )\n  }\n\n  if (!piafs.length && allowValidate) {\n    return <p>Aucune PIAF à valider.</p>\n  }\n\n  return (\n    <List>\n      {piafs.map((piaf) => (\n        <Piaf key={piaf.id} piaf={piaf} allowValidate={allowValidate} />\n      ))}\n    </List>\n  )\n}\n\nexport default UserPiafs\n","import type { PIAF } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { addWeeks } from \"date-fns\"\nimport { List } from \"@material-ui/core\"\n\nimport Loader from \"src/components/Loader\"\nimport Piaf from \"src/components/Piaf\"\nimport { useUser } from \"src/providers/user\"\nimport { PIAFS } from \"src/graphql/queries\"\nimport { queryDate } from \"src/helpers/date\"\nimport { ErrorMessage } from \"src/helpers/errors\"\nimport { orderPiafsByDate } from \"src/helpers/piaf\"\nimport { hasRole } from \"src/helpers/role\"\nimport { getId } from \"src/helpers/apollo\"\n\ntype Result = { piafs: PIAF[] }\n\nconst ReplacementPiafs = () => {\n  const { auth, user } = useUser<true>()\n  const now = new Date()\n\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: {\n      after: queryDate(now),\n      before: queryDate(addWeeks(now, 2)),\n      statut: \"remplacement\",\n    },\n  })\n\n  if (loading) {\n    return <Loader />\n  }\n\n  if (error) {\n    return <ErrorMessage error={error} />\n  }\n\n  if (!data) {\n    return null\n  }\n\n  const userRoles = user?.rolesChouette || []\n\n  const list = data.piafs\n    .filter((piaf) => {\n      if (getId(piaf.piaffeur?.id) === auth.id) {\n        // own PIAF\n        return false\n      }\n      if (!piaf.role) {\n        // unknown slot\n        return false\n      }\n      if (!hasRole(piaf.role.roleUniqueId, userRoles)) {\n        // user is not trained for this role\n        return false\n      }\n      return true\n    })\n    .sort(orderPiafsByDate)\n\n  if (!list.length) {\n    return <p>Aucun remplacement à venir n’est demandé.</p>\n  }\n\n  return (\n    <>\n      <p>\n        Les créneaux suivants sont vacants et donc disponibles pour un remplacement. N’hésite pas à te positionner, la\n        personne que tu remplaces sera avertie par e-mail instantanément !\n      </p>\n      <List>\n        {list.map((piaf) => (\n          <Piaf key={piaf.id} piaf={piaf} />\n        ))}\n      </List>\n    </>\n  )\n}\n\nexport default ReplacementPiafs\n","import type { PIAF } from \"src/types/model\"\nimport type { ISlot } from \"src/types/app\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { addDays } from \"date-fns\"\nimport { List } from \"@material-ui/core\"\n\nimport Loader from \"src/components/Loader\"\nimport Piaf from \"src/components/Piaf\"\nimport { useUser } from \"src/providers/user\"\nimport { PIAFS } from \"src/graphql/queries\"\nimport { queryDate } from \"src/helpers/date\"\nimport { ErrorMessage } from \"src/helpers/errors\"\nimport { isCritical, CRITICAL_DAYS, orderPiafsByDate, isTaken } from \"src/helpers/piaf\"\nimport { hasRole } from \"src/helpers/role\"\n\ntype Result = { piafs: PIAF[] }\n\nconst CriticalPiafs = () => {\n  const { user } = useUser<true>()\n  const now = new Date()\n\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: {\n      after: queryDate(now),\n      before: queryDate(addDays(now, CRITICAL_DAYS)),\n    },\n  })\n\n  if (loading) {\n    return <Loader />\n  }\n\n  if (error) {\n    return <ErrorMessage error={error} />\n  }\n\n  if (!data) {\n    return null\n  }\n\n  const userRoles = user?.rolesChouette || []\n\n  const slots: Record<string, ISlot> = {}\n  data.piafs.forEach((piaf) => {\n    if (!slots[piaf.creneau.id]) {\n      slots[piaf.creneau.id] = {\n        id: piaf.creneau.id,\n        title: piaf.creneau.titre,\n        information: piaf.creneau.informations,\n        start: new Date(piaf.creneau.debut),\n        end: new Date(piaf.creneau.fin),\n        horsMag: piaf.creneau.horsMag,\n        piafs: [],\n      }\n    }\n    slots[piaf.creneau.id].piafs!.push(piaf)\n  })\n\n  const list = data.piafs\n    .filter((piaf) => {\n      if (isTaken(piaf)) {\n        // all good\n        return false\n      }\n      if (!piaf.role) {\n        // unknown slot\n        return false\n      }\n      if (!hasRole(piaf.role.roleUniqueId, userRoles)) {\n        // user is not trained for this role\n        return false\n      }\n      if (now > new Date(piaf.creneau.debut)) {\n        //PIAF already started\n        return false\n      }\n      return isCritical(slots[piaf.creneau.id], piaf)\n    })\n    .sort(orderPiafsByDate)\n\n  if (!list.length) {\n    return <p>Aucun créneau critique dans les jours à venir. Espérons que ça dure !</p>\n  }\n\n  return (\n    <>\n      <p>\n        Les créneaux suivants sont vacants et critiques ! N’hésite pas à te positionner, le magasin a besoin de toi !\n      </p>\n      <List>\n        {list.map((piaf) => (\n          <Piaf key={piaf.id} piaf={piaf} critical />\n        ))}\n      </List>\n    </>\n  )\n}\n\nexport default CriticalPiafs\n","import { FormEvent, ChangeEvent, useState } from \"react\"\nimport { Button, Dialog, TextField, DialogContent, DialogActions, IconButton, DialogTitle } from \"@material-ui/core\"\nimport { Close } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\n\nimport { useDialog } from \"src/providers/dialog\"\nimport { sendEmail } from \"src/helpers/request\"\nimport { handleError } from \"src/helpers/errors\"\n\nimport { User } from \"src/types/model\"\n\nconst CloseButton = styled(IconButton)`\n  position: absolute;\n  right: 8px;\n  top: 8px;\n`\n\nconst TextInput = styled(TextField)`\n  width: 100%;\n`\n\nconst Title = styled(DialogTitle)`\n  margin-right: 32px;\n`\n\ninterface Props {\n  show: boolean\n  user: User\n  handleClose: () => void\n  title: string\n  dialogContent: string | null\n  emailAddress: string\n  emailSubject: string\n  callback?: (ok: boolean) => void\n}\n\nconst SendEmail = ({ show, handleClose, user, title, dialogContent, emailAddress, emailSubject, callback }: Props) => {\n  const { openDialog } = useDialog()\n  const [comment, setComment] = useState<string>(\"\")\n  const [loading, setLoading] = useState(false)\n\n  const handleInputChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    setComment(target.value)\n  }\n\n  const handleSendEmail = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n\n    setLoading(true)\n\n    try {\n      const content = [\n        `Prénom NOM : ${user.prenom}  ${user.nom.toUpperCase()}`,\n        `Mail : ${user.email} `,\n        `Téléphone : ${user.telephone} `,\n        `Code-barres : ${user.codeBarre}`,\n        `Commentaire : ${comment}`,\n      ]\n\n      await sendEmail(emailAddress, emailSubject, content.join(\"<br />\"))\n\n      handleClose()\n      openDialog(`Un e-mail a été envoyé a ${emailAddress} qui te recontactera si besoin.`)\n\n      if (callback) {\n        setTimeout(callback, 300)\n      }\n    } catch (error) {\n      handleError(error as Error)\n    }\n\n    setLoading(false)\n  }\n\n  return (\n    <Dialog open={show} onClose={handleClose} title={title}>\n      <form onSubmit={handleSendEmail} autoComplete=\"off\">\n        <CloseButton onClick={handleClose}>\n          <Close />\n        </CloseButton>\n        <Title>{title}</Title>\n        <DialogContent>\n          {dialogContent && <div>{dialogContent}</div>}\n          <TextInput\n            name=\"comment\"\n            multiline\n            required={false}\n            label=\"Commentaire\"\n            value={comment}\n            onChange={handleInputChange}\n          ></TextInput>\n        </DialogContent>\n        <DialogActions>\n          <Button type=\"submit\" color=\"primary\" variant=\"contained\" disabled={loading}>\n            Confirmer\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  )\n}\n\nexport default SendEmail\n","import styled from \"@emotion/styled/macro\"\nimport { Typography, Button } from \"@material-ui/core\"\nimport { startOfToday } from \"date-fns\"\nimport { Link } from \"react-router-dom\"\nimport { useState } from \"react\"\n\nimport apollo from \"src/helpers/apollo\"\nimport { queryDate } from \"src/helpers/date\"\nimport { handleError } from \"src/helpers/errors\"\nimport {\n  USER_UPDATE_STOP_ABSENCE_WITHOUT_SHOPPING,\n  USER_UPDATE_STOP_ABSENCE_WITH_SHOPPING,\n  USER_SET_AWAITING_PARTICIPATION_GROUP,\n} from \"src/graphql/queriesUser\"\n\nimport { useUser } from \"src/providers/user\"\nimport { useDialog } from \"src/providers/dialog\"\nimport UserPiafs from \"src/components/UserPiafs\"\nimport ReplacementPiafs from \"src/components/ReplacementPiafs\"\nimport CriticalPiafs from \"src/components/CriticalPiafs\"\nimport SendEmail from \"src/components/SendEmail\"\n\n// https://style.lachouettecoop.fr/#/couleurs\n// TODO: use constants\n// https://github.com/lachouettecoop/chouette-admin-chouettos/blob/master/src/Controller/PlanningController.php#L79-L85\nconst COLORS: Record<string, string> = {\n  \"très chouette\": \"#2ECC40\",\n  chouette: \"#FF851B\",\n  \"chouette en alerte\": \"#FF4136\",\n}\nconst StatusText = styled(Typography)<{ $status?: string }>`\n  color: ${({ $status, theme }) => ($status && COLORS[$status.toLowerCase()]) || theme.palette.secondary.main};\n  &::first-letter {\n    text-transform: uppercase;\n  }\n`\n\nconst Container = styled.div`\n  min-height: calc(100vh - 132px);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n`\nconst Bottom = styled.div`\n  font-size: 0.85em;\n  margin-top: ${({ theme }) => theme.spacing(4)}px;\n`\nconst AbsenceText = styled(Typography)`\n  margin-right: 10px;\n  color: red;\n`\nconst Content = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  gap: 32px;\n  > div {\n    flex: 0 1 calc(50% - 16px);\n    min-width: 300px;\n    @media (max-width: 750px) {\n      flex: 1;\n    }\n  }\n`\nconst Status = styled.div`\n  h3 {\n    font-size: 2.5rem;\n    span {\n      font-size: 0.5em;\n    }\n    margin-bottom: 2rem;\n  }\n`\n\nconst HomePage = () => {\n  const { user, refetchUser } = useUser<true>()\n  const { openQuestion } = useDialog()\n  const [openSendEmailDialog, setOpenSendEmailDialog] = useState(false)\n\n  const counter = `${user?.nbPiafEffectuees ?? \"…\"}/${user?.nbPiafAttendues ?? \"…\"}`\n  const status = user?.statut || \"…\"\n\n  const handleClick = async (shopping: boolean) => {\n    const ok = await openQuestion(\n      \"Tu souhaites revenir faire tes PIAF et tes courses ? Super ! Confirme-le ici et l’effet sera immédiat. Pense à t’inscrire à nouveau sur des créneaux de PIAF.\"\n    )\n    if (!ok) {\n      return\n    }\n    try {\n      if (shopping) {\n        await apollo.mutate({ mutation: USER_UPDATE_STOP_ABSENCE_WITH_SHOPPING, variables: { id: user?.id } })\n      } else {\n        await apollo.mutate({ mutation: USER_UPDATE_STOP_ABSENCE_WITHOUT_SHOPPING, variables: { id: user?.id } })\n      }\n      refetchUser()\n    } catch (errorUpdate) {\n      handleError(errorUpdate as Error)\n    }\n  }\n\n  const handleCloseSendEmailDialog = () => {\n    setOpenSendEmailDialog(false)\n  }\n\n  const handleOpenSendEmailDialog = () => {\n    setOpenSendEmailDialog(true)\n  }\n\n  const setUserAsAwaitingResult = async () => {\n    await apollo.mutate({ mutation: USER_SET_AWAITING_PARTICIPATION_GROUP, variables: { id: user?.id } })\n    refetchUser()\n  }\n\n  return (\n    <Container>\n      <Content>\n        <Status>\n          <Typography variant=\"h2\">Mon statut</Typography>\n          <Typography variant=\"h3\">\n            {counter} <span>PIAF attendues</span>\n          </Typography>\n          {!user?.absenceLongueDureeCourses && !user?.absenceLongueDureeSansCourses && (\n            <>\n              <Typography variant=\"h2\">Je suis</Typography>\n              <StatusText variant=\"h3\" $status={user?.statut}>\n                {!user?.attenteCommissionParticipation && status}\n                {user?.attenteCommissionParticipation &&\n                  \"En attente de la décision de la commission de participation et je peux faire mes courses\"}\n              </StatusText>\n            </>\n          )}\n          <AbsenceText variant=\"h2\">\n            {user?.absenceLongueDureeCourses && (\n              <>\n                <div>\n                  Ma participation aux PIAF du magasin est actuellement en pause, mais je peux toujours faire mes\n                  courses\n                </div>\n                <Button variant=\"contained\" color=\"primary\" size=\"large\" onClick={() => handleClick(true)}>\n                  Je reprends ma participation\n                </Button>\n              </>\n            )}\n\n            {user?.absenceLongueDureeSansCourses && (\n              <>\n                <div>\n                  Ma participation aux PIAF du magasin est actuellement en pause et je ne peux pas faire mes courses\n                </div>\n                <Button variant=\"contained\" color=\"primary\" size=\"large\" onClick={() => handleClick(false)}>\n                  Je reprends ma participation\n                </Button>\n              </>\n            )}\n          </AbsenceText>\n          {process.env.REACT_APP_MAIL_COMMISSION_PARTICIPATION &&\n            !user?.attenteCommissionParticipation &&\n            user?.statut.toLowerCase() == \"chouette en alerte\" && (\n              <>\n                <Typography>\n                  Ce statut t’empêche de faire des courses. Si tu souhaites revenir faire tes courses et PIAF, tu peux\n                  saisir la commission participation qui examine les cas particuliers et recherche des solutions. Pour\n                  joindre la commission, tu peux cliquer sur le bouton ci-dessous\n                </Typography>\n                <Button variant=\"contained\" color=\"primary\" size=\"large\" onClick={handleOpenSendEmailDialog}>\n                  joindre la commission\n                </Button>\n              </>\n            )}\n        </Status>\n        <div>\n          <Typography variant=\"h2\">Mes prochaines PIAF</Typography>\n          <UserPiafs userId={user?.id} after={queryDate(startOfToday())} />\n        </div>\n        <div>\n          <Typography variant=\"h2\">Créneaux critiques</Typography>\n          <CriticalPiafs />\n        </div>\n        <div>\n          <Typography variant=\"h2\">Remplacements</Typography>\n          <ReplacementPiafs />\n        </div>\n      </Content>\n      <Bottom>\n        <Link to=\"/legal\">Politique de traitement des données personnelles</Link>\n        <p>Ce site n’utilise pas de cookies tiers</p>\n        <p>\n          Un problème ? Une question ? Contacte le BdM :{\" \"}\n          <a href={`mailto:${process.env.REACT_APP_MAIL_BDM}`}>{process.env.REACT_APP_MAIL_BDM}</a>\n        </p>\n      </Bottom>\n      {user && process.env.REACT_APP_MAIL_COMMISSION_PARTICIPATION && (\n        <SendEmail\n          show={openSendEmailDialog}\n          handleClose={handleCloseSendEmailDialog}\n          user={user}\n          title=\"Si tu confirmes ton souhait, la commission recevra un mail et prendra contact avec toi. Ton statut sera mis en attente de la décision de la commission. En attendant, tu pourras faire tes courses.\"\n          dialogContent=\"Tu peux laisser un commentaire si tu le souhaites.\"\n          emailAddress={process.env.REACT_APP_MAIL_COMMISSION_PARTICIPATION}\n          emailSubject={`Saisie commission participation ${user.prenom} ${user.nom}`}\n          callback={setUserAsAwaitingResult}\n        />\n      )}\n    </Container>\n  )\n}\n\nexport default HomePage\n","import type { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport styled from \"@emotion/styled/macro\"\n\nimport SlotDialog from \"src/components/SlotDialog\"\nimport PiafCircle from \"src/components/PiafCircle\"\nimport { formatTime } from \"src/helpers/date\"\nimport { isCritical } from \"src/helpers/piaf\"\n\nconst SELECTED_COLOR = \"#FFFFAA\"\nconst HIGHLIGHT_COLOR = \"#89C7A8\"\nconst HIGHLIGHTED_SLOTS = [\"inventaire\", \"formation\"]\n\nconst ClickableSlot = styled.button<{ $open: boolean; $slotTitle: string }>`\n  width: 100%;\n  border: none;\n  background-color: ${({ $open, $slotTitle }) =>\n    $open\n      ? SELECTED_COLOR\n      : HIGHLIGHTED_SLOTS.some((title) => $slotTitle.toLowerCase().toString().startsWith(title))\n      ? HIGHLIGHT_COLOR\n      : \"transparent\"};\n  padding: 5px;\n  text-align: left;\n  font-size: inherit;\n  line-height: inherit;\n  font: inherit;\n  cursor: pointer;\n  &:focus {\n    background-color: ${SELECTED_COLOR};\n    outline: none;\n  }\n`\nconst Title = styled.div`\n  span {\n    color: gray;\n  }\n`\nconst List = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  margin: 0 -2px;\n  svg {\n    width: 24px;\n    height: 24px;\n  }\n`\n\ninterface Props {\n  slot: ISlot\n}\n\nconst Slot = ({ slot }: Props) => {\n  const [open, setOpen] = useState(false)\n\n  const handleClick = () => {\n    setOpen(true)\n  }\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  return (\n    <>\n      <ClickableSlot $open={open} $slotTitle={slot.title || \"\"} onClick={handleClick}>\n        <Title>\n          <strong>\n            {formatTime(slot.start)}–{formatTime(slot.end)}\n          </strong>\n          <br />\n          <span>{slot.title}</span>\n        </Title>\n        <List>\n          {slot.piafs?.map((piaf) => (\n            <PiafCircle key={piaf.id} piaf={piaf} critical={isCritical(slot, piaf)} displayTooltip={true} />\n          ))}\n        </List>\n      </ClickableSlot>\n      <SlotDialog show={open} slot={slot} handleClose={handleClose} />\n    </>\n  )\n}\n\nexport default Slot\n","import type { IDay, IWeekId } from \"src/types/app\"\n\nimport styled from \"@emotion/styled/macro\"\nimport { isPast, isToday } from \"date-fns\"\nimport { capitalize, Typography } from \"@material-ui/core\"\n\nimport Slot from \"src/components/Slot\"\nimport { formatDateShort } from \"src/helpers/date\"\n\ntype TimeStatus = \"past\" | \"present\" | \"future\"\n\nconst WEEK_COLORS: Record<IWeekId, string> = {\n  A: \"#89C7A8\",\n  B: \"#638F79\",\n  C: \"#3A5447\",\n  D: \"#27382F\",\n}\n\nconst Header = styled.div<{ $weekId?: IWeekId }>`\n  background-color: ${({ $weekId, theme }) => ($weekId && WEEK_COLORS[$weekId]) || theme.palette.grey[400]};\n  height: 18px;\n  color: white;\n  font-size: 12px;\n  padding: 0 4px;\n`\n\nconst Container = styled.div<{ $when: TimeStatus }>`\n  opacity: ${({ $when }) => ($when === \"past\" ? 0.25 : 1)};\n  scroll-margin-top: 64px;\n  border: 1px solid gray;\n  min-height: 80px;\n  background-color: ${({ $when }) => ($when === \"present\" ? \"#d0d9d0\" : \"#eee\")};\n  h3 {\n    font-size: 1em;\n    margin: 4px;\n  }\n`\nconst List = styled.ul`\n  list-style: none;\n  padding: 0;\n  margin: 0;\n`\n\ninterface Props {\n  day: IDay\n  weekId?: IWeekId\n}\n\nconst CalendarDay = ({ day, weekId }: Props) => {\n  const { start, slots } = day\n  const today = isToday(start)\n  const monday = start.getDay() === 1 || start.getDate() === 1\n\n  return (\n    <Container\n      $when={today ? \"present\" : isPast(start) ? \"past\" : \"future\"}\n      ref={(el) => {\n        if (today && el) {\n          el.scrollIntoView({ behavior: \"smooth\" })\n        }\n      }}\n    >\n      <Header $weekId={weekId}>{monday && weekId && `Semaine ${weekId}`}</Header>\n      <Typography variant=\"h3\">{capitalize(formatDateShort(start))}</Typography>\n      <List>\n        {slots.map((slot) => (\n          <Slot slot={slot} key={slot.id}></Slot>\n        ))}\n      </List>\n    </Container>\n  )\n}\n\nexport default CalendarDay\n\nexport const DayPlaceholder = () => <Container $when=\"past\" />\n","import type { Creneau, PIAF } from \"src/types/model\"\nimport type { IWeek } from \"src/types/app\"\n\nimport { useMediaQuery, useTheme } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\nimport { addDays, differenceInWeeks, eachWeekOfInterval, getDay } from \"date-fns\"\n\nimport CalendarDay, { DayPlaceholder } from \"src/components/CalendarDay\"\nimport { getWeekId, orderPiafsByRoleId } from \"src/helpers/piaf\"\n\nconst Container = styled.div`\n  border: 1px solid gray;\n  margin: 0;\n  padding: 0;\n`\nconst WeekRow = styled.div`\n  @media (min-width: 800px) {\n    display: flex;\n    > div {\n      flex: 1 0 14.29%;\n    }\n  }\n`\n\ninterface Props {\n  start: Date\n  end: Date\n  list?: Creneau[]\n}\n\nconst Calendar = ({ start, end, list }: Props) => {\n  const theme = useTheme()\n  const matches = useMediaQuery(theme.breakpoints.down(\"sm\"))\n\n  if (!list) {\n    return null\n  }\n\n  const weeks: IWeek[] = eachWeekOfInterval({ start, end }, { weekStartsOn: 1 }).map((date) => ({\n    start: date,\n    days: [0, 1, 2, 3, 4, 5, 6].map((i) => ({ start: addDays(date, i), slots: [] })),\n  }))\n\n  list.forEach((node) => {\n    const date = new Date(node.debut)\n    const weekIndex = differenceInWeeks(date, weeks[0].start)\n    const week = weeks[weekIndex]\n    const day = (getDay(date) || 7) - 1 // Monday = 0, ..., Sunday = 6\n\n    const piaffeursCount = node.piafs.length\n    const piaffeursCountFirstPiaf = node.piafs.filter(({ piaffeur }) => piaffeur?.nbPiafEffectuees === 0).length\n    const infoCreneau = { piaffeursCount, piaffeursCountFirstPiaf }\n\n    const piafs: PIAF[] = node.piafs\n      .map((piaf) => ({\n        ...piaf,\n        infoCreneau,\n      }))\n      .sort(orderPiafsByRoleId)\n\n    week.days[day].slots.push({\n      id: node.id,\n      title: node.titre,\n      information: node.informations,\n      start: date,\n      end: new Date(node.fin),\n      horsMag: node.horsMag,\n      piafs,\n    })\n\n    if (node.creneauGenerique) {\n      week.weekId = getWeekId(node.creneauGenerique.frequence)\n    }\n  })\n\n  return (\n    <Container>\n      {weeks.map((week, index) => (\n        <WeekRow key={index}>\n          {week.days.map((day, i) =>\n            day.start >= start && day.start < end ? (\n              <CalendarDay day={day} key={i} weekId={week.weekId} />\n            ) : matches ? null : (\n              <DayPlaceholder key={i} />\n            )\n          )}\n        </WeekRow>\n      ))}\n    </Container>\n  )\n}\n\nexport default Calendar\n","import { useEffect, useState } from \"react\"\nimport styled from \"@emotion/styled/macro\"\nimport { Grid, Dialog, DialogContent, DialogActions, Button } from \"@material-ui/core\"\n\nimport { RoleId } from \"src/types/model\"\nimport { PiafIcon } from \"src/components/PiafCircle\"\n\nconst Container = styled.div`\n  text-align: center;\n`\nconst Title = styled.h3`\n  margin: 0 0 2em;\n`\nconst Caption = styled.figcaption`\n  word-wrap: break-word;\n  padding: 0 4px;\n`\n\nconst IconsCaption = () => {\n  return (\n    <Container>\n      <Title>Légende</Title>\n      <Grid container>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.Chouettos} />\n          <Caption>Chouettos</Caption>\n        </Grid>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.Caissier} />\n          <Caption>Caissier·ère</Caption>\n        </Grid>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.GrandHibou} />\n          <Caption>Grand Hibou</Caption>\n        </Grid>\n      </Grid>\n      <br />\n      <Grid container>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.PIAF} />\n          <Caption>PIAF disponible</Caption>\n        </Grid>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.PIAF} taken />\n          <Caption>PIAF occupée</Caption>\n        </Grid>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.PIAF} critical />\n          <Caption>PIAF critique</Caption>\n        </Grid>\n      </Grid>\n      <br />\n      <Grid container>\n        <Grid item xs={4} component=\"figure\">\n          <PiafIcon role={RoleId.Formateur} />\n          <Caption>Formateur·ice</Caption>\n        </Grid>\n      </Grid>\n    </Container>\n  )\n}\n\nexport default IconsCaption\n\nexport const CaptionDialog = () => {\n  const [open, setOpen] = useState(false)\n\n  useEffect(() => {\n    const dismissed = localStorage.getItem(\"caption_dismissed\")\n    if (!dismissed) {\n      setOpen(true)\n    }\n  }, [])\n\n  const handleClose = () => {\n    setOpen(false)\n    localStorage.setItem(\"caption_dismissed\", \"true\")\n  }\n\n  return (\n    <Dialog open={open} fullWidth>\n      <DialogContent>\n        <IconsCaption />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\">\n          Compris !\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","import { useState, useEffect } from \"react\"\nimport { Link } from \"react-router-dom\"\nimport { Dialog, DialogContent, Button } from \"@material-ui/core\"\n\nimport { useUser } from \"src/providers/user\"\nimport apollo from \"src/helpers/apollo\"\nimport { USER_UPDATE } from \"src/graphql/queriesUser\"\nimport { handleError } from \"src/helpers/errors\"\n\nconst PrivacyPolicy = () => {\n  const [open, setOpen] = useState(false)\n  const { user, refetchUser } = useUser<true>()\n\n  useEffect(() => {\n    if (!user?.affichageDonneesPersonnelles) {\n      const dismissed = localStorage.getItem(\"privacy_police_dismissed\")\n      if (!dismissed) {\n        setOpen(true)\n      }\n    }\n  }, [user?.affichageDonneesPersonnelles])\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  const handleDismiss = () => {\n    setOpen(false)\n    localStorage.setItem(\"privacy_police_dismissed\", \"true\")\n  }\n\n  const handleAccept = async () => {\n    setOpen(false)\n    try {\n      await apollo.mutate({\n        mutation: USER_UPDATE,\n        variables: { affichageDonneesPersonnelles: true, idUser: user?.id },\n      })\n      refetchUser()\n    } catch (error) {\n      handleError(error as Error)\n    }\n  }\n\n  return (\n    <Dialog open={open} fullWidth>\n      <DialogContent>\n        <p>\n          {\" \"}\n          Par défaut, tes coordonnées (email et numéro de téléphone) ne sont pas visibles par les autres\n          coopérateurs·rices. Les rendre accessibles facilite la communication entre coopérateurs·rices et optimise\n          l’organisation des PIAF au magasin, par exemple en cas d’indisponibilité au dernier moment.{\" \"}\n        </p>\n        <p>\n          Ce choix est modifiable à tout moment depuis <Link to=\"/profile\"> mon profil</Link>\n        </p>\n      </DialogContent>\n\n      <Button onClick={handleAccept} color=\"primary\">\n        Je comprends et j’accepte que mes coordonnées soient visibles par tous·tes les coopérateurs·rices\n      </Button>\n      <Button onClick={handleClose} color=\"primary\">\n        Je décide plus tard\n      </Button>\n      <Button onClick={handleDismiss} color=\"primary\">\n        Je n’accepte pas que mes coordonnées soient visibles\n      </Button>\n    </Dialog>\n  )\n}\n\nexport default PrivacyPolicy\n","import { useEffect, useState } from \"react\"\n\nimport type { Creneau } from \"src/types/model\"\n\nimport { Button, Typography } from \"@material-ui/core\"\nimport { ArrowBackIos, ArrowForwardIos, CalendarToday } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\nimport { isSameMonth } from \"date-fns\"\n\nimport Loader from \"src/components/Loader\"\nimport Calendar from \"src/components/Calendar\"\nimport IconsCaption, { CaptionDialog } from \"src/components/IconsCaption\"\nimport { useDatePlanning } from \"src/providers/datePlanning\"\nimport { useUser } from \"src/providers/user\"\nimport { formatMonthYear } from \"src/helpers/date\"\nimport { ErrorBlock } from \"src/helpers/errors\"\nimport PrivacyPolicy from \"src/components/PrivacyPolicy\"\n\nconst Loading = styled.div`\n  border: 2px solid gray;\n  height: 500px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst Nav = styled.nav`\n  display: flex;\n  justify-content: end;\n  margin-bottom: 1rem;\n  button:not(:first-of-type) {\n    margin-left: 1rem;\n  }\n  h2 {\n    flex: 1;\n    text-transform: capitalize;\n  }\n  ${({ theme }) => theme.breakpoints.down(\"xs\")} {\n    h2 {\n      font-size: 1.15rem;\n    }\n  }\n`\nconst ButtonArea = styled.div`\n  display: flex;\n  ${({ theme }) => theme.breakpoints.down(\"sm\")} {\n    span.text {\n      display: none;\n    }\n    .MuiButton-root {\n      min-width: 32px;\n    }\n    .MuiButton-startIcon {\n      margin-right: -4px;\n    }\n    .MuiButton-endIcon {\n      margin-left: -4px;\n    }\n  }\n`\nconst ButtonAreaBottom = styled.div`\n  margin-top: 1rem;\n  display: flex;\n  span.text {\n    display: none;\n  }\n  .MuiButton-root {\n    min-width: 32px;\n  }\n  .MuiButton-startIcon {\n    margin-right: -4px;\n  }\n  .MuiButton-endIcon {\n    margin-left: -4px;\n  }\n`\nconst BottomCaption = styled.div`\n  max-width: 500px;\n  margin: 20px 0 100px auto;\n  border: 1px solid gray;\n  border-radius: 10px;\n  padding: 20px 10px;\n`\n\nconst orderSlotsByDate = (left: Creneau, right: Creneau) => (left.debut > right.debut ? 1 : -1)\n\nconst PlanningPage = () => {\n  const { user } = useUser<true>()\n  const [displayPrivacyPolicyDialog, setDisplayPrivacyPolicyDialog] = useState(false)\n  useEffect(() => {\n    if (user) setDisplayPrivacyPolicyDialog(!user.affichageDonneesPersonnelles)\n  }, [user])\n\n  const { goBack, goForward, goToday, start, end, data, error, loading } = useDatePlanning()\n  if (error) {\n    return <ErrorBlock error={error} />\n  }\n\n  const slots = data?.creneaus.filter(({ horsMag }) => !horsMag).sort(orderSlotsByDate)\n\n  return (\n    <>\n      <Nav>\n        <Typography variant=\"h2\">{formatMonthYear(start)}</Typography>\n        <ButtonArea>\n          <Button disabled={loading} variant=\"contained\" color=\"primary\" startIcon={<ArrowBackIos />} onClick={goBack}>\n            <span className=\"text\">Précédent</span>\n          </Button>\n          <Button\n            disabled={loading || isSameMonth(start, new Date())}\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<CalendarToday />}\n            onClick={goToday}\n          >\n            <span className=\"text\">Aujourd’hui</span>\n          </Button>\n          <Button\n            disabled={loading}\n            variant=\"contained\"\n            color=\"primary\"\n            endIcon={<ArrowForwardIos />}\n            onClick={goForward}\n          >\n            <span className=\"text\">Suivant</span>\n          </Button>\n        </ButtonArea>\n      </Nav>\n      {loading ? (\n        <Loading>\n          <Loader />\n        </Loading>\n      ) : (\n        <>\n          {displayPrivacyPolicyDialog && <PrivacyPolicy />}\n          <Calendar start={start} end={end} list={slots} />\n        </>\n      )}\n      <Nav>\n        <ButtonAreaBottom>\n          <Button disabled={loading} variant=\"contained\" color=\"primary\" startIcon={<ArrowBackIos />} onClick={goBack}>\n            <span className=\"text\">Précédent</span>\n          </Button>\n          <Button\n            disabled={loading || isSameMonth(start, new Date())}\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<CalendarToday />}\n            onClick={goToday}\n          ></Button>\n          <Button\n            disabled={loading}\n            variant=\"contained\"\n            color=\"primary\"\n            endIcon={<ArrowForwardIos />}\n            onClick={goForward}\n          >\n            <span className=\"text\">Suivant</span>\n          </Button>\n        </ButtonAreaBottom>\n      </Nav>\n      <BottomCaption>\n        <IconsCaption />\n      </BottomCaption>\n      <CaptionDialog />\n    </>\n  )\n}\n\nexport default PlanningPage\n","import { FormEvent, ChangeEvent, useState } from \"react\"\nimport {\n  Button,\n  Dialog,\n  TextField,\n  DialogContent,\n  DialogActions,\n  IconButton,\n  DialogTitle,\n  Select,\n  MenuItem,\n  InputLabel,\n  FormControl,\n} from \"@material-ui/core\"\nimport { Close } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\n\nimport { useDialog } from \"src/providers/dialog\"\nimport { formatDateLong, queryDate } from \"src/helpers/date\"\nimport { sendEmail } from \"src/helpers/request\"\nimport { handleError } from \"src/helpers/errors\"\nimport { formatName } from \"src/helpers/user\"\n\nimport { User } from \"src/types/model\"\n\nconst Row = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n  > * {\n    margin-bottom: 1rem;\n    @media (min-width: 400px) {\n      flex: 1;\n      &:not(:first-of-type) {\n        margin-left: ${({ theme }) => theme.spacing(3)}px;\n      }\n    }\n  }\n`\n\nconst CloseButton = styled(IconButton)`\n  position: absolute;\n  right: 8px;\n  top: 8px;\n`\n\nconst TextInput = styled(TextField)`\n  width: 100%;\n`\n\nconst Title = styled(DialogTitle)`\n  margin-right: 32px;\n`\n\nconst REASONS = {\n  noPiaf: \"Je ne pourrai pas assurer ma PIAF\",\n  noBuy: \"Je ne pourrai pas assurer ma PIAF ni effectuer mes courses\",\n  other: \"Autre (spécifier en commentaire)\",\n}\n\ninterface Props {\n  show: boolean\n  user: User\n  handleClose: () => void\n}\n\ninterface State {\n  reason: keyof typeof REASONS | \"\"\n  comment: string\n  startDate: string\n  endDate: string\n}\n\nconst currentDate = new Date(Date.now())\n\nconst LongAbsence = ({ show, handleClose, user }: Props) => {\n  const { openDialog } = useDialog()\n  const [values, setValues] = useState<State>({\n    reason: \"\",\n    comment: \"\",\n    startDate: \"\",\n    endDate: \"\",\n  })\n  const [loading, setLoading] = useState(false)\n\n  const handleInputChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = target\n    setValues({\n      ...values,\n      [name]: value,\n    })\n  }\n\n  const handleReasonChange = ({ target }: ChangeEvent<{ name?: string; value: unknown }>) => {\n    const { name, value } = target\n    setValues({\n      ...values,\n      [name as string]: value,\n    })\n  }\n\n  const handleSendEmail = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n\n    if (!process.env.REACT_APP_MAIL_BDM) {\n      alert(\"L’adresse e-mail du BdM n’est pas configurée. Contacte l’administrateur.\")\n      return\n    }\n\n    if (!values.startDate || !values.reason) {\n      openDialog(\"Tous les champs sont obligatoires.\")\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      const content = [\n        `Nom et prénom : ${formatName(user)}`,\n        `Mail : ${user.email} `,\n        `Téléphone : ${user.telephone} `,\n        `Raison de l'absence : ${REASONS[values.reason]}`,\n        `Date début : ${formatDateLong(values.startDate)}`,\n      ]\n      if (values.comment) {\n        content.push(`Commentaire : ${values.comment}`)\n      }\n\n      await sendEmail(process.env.REACT_APP_MAIL_BDM, \"Absence prolongée\", content.join(\"<br />\"))\n\n      handleClose()\n      openDialog(\n        \"Un e-mail a été envoyé au BdM qui te recontactera si besoin. Pense bien a les recontacter lorsque tu pourras reprendre les PIAF.\"\n      )\n    } catch (error) {\n      handleError(error as Error)\n    }\n\n    setLoading(false)\n  }\n\n  return (\n    <Dialog open={show} onClose={handleClose}>\n      <form onSubmit={handleSendEmail} autoComplete=\"off\">\n        <CloseButton onClick={handleClose}>\n          <Close />\n        </CloseButton>\n        <Title>Informer d’un changement de ma situation</Title>\n        <DialogContent>\n          <Row>\n            <TextField\n              id=\"startDate\"\n              label=\"Date de début\"\n              name=\"startDate\"\n              type=\"date\"\n              fullWidth\n              required\n              value={values.startDate}\n              onChange={handleInputChange}\n              InputLabelProps={{\n                shrink: true,\n              }}\n              inputProps={{ min: queryDate(currentDate) }}\n            />\n\n            {/*            <TextField\n              id=\"endDate\"\n              label=\"Date de fin\"\n              name=\"endDate\"\n              type=\"date\"\n              fullWidth\n              required\n              value={values.endDate}\n              onChange={handleInputChange}\n              InputLabelProps={{\n                shrink: true,\n              }}\n            /> */}\n          </Row>\n          <Row>\n            <FormControl fullWidth>\n              <InputLabel>Type de changement</InputLabel>\n              <Select\n                value={values.reason}\n                label=\"Type de changement\"\n                name=\"reason\"\n                required\n                onChange={handleReasonChange}\n              >\n                {Object.keys(REASONS).map((key) => (\n                  <MenuItem value={key} key={key}>\n                    {REASONS[key]}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </Row>\n          <Row>\n            <TextInput\n              name=\"comment\"\n              multiline\n              required={values.reason === \"other\"}\n              label=\"Commentaire additionnel\"\n              value={values.comment}\n              onChange={handleInputChange}\n            ></TextInput>\n          </Row>\n          <Row>\n            <span>\n              Pour plus d’informations,{\" \"}\n              <a href=\"https://espace-membres.lachouettecoop.fr/page/les-documents\" target=\"_blank\" rel=\"noopener\">\n                consultez le manuel du•de la coopérateur•ice\n              </a>\n              .\n            </span>\n          </Row>\n        </DialogContent>\n        <DialogActions>\n          <Button type=\"submit\" color=\"primary\" variant=\"contained\" disabled={loading}>\n            Confirmer au BdM\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  )\n}\n\nexport default LongAbsence\n","import { ChangeEvent, useEffect, useState } from \"react\"\nimport { Prompt } from \"react-router\"\nimport { Phone, Mail } from \"@material-ui/icons\"\nimport {\n  Button,\n  InputAdornment,\n  TextField,\n  Typography,\n  FormControlLabel,\n  RadioGroup,\n  Radio,\n  FormControl,\n} from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\n\nimport Loader from \"src/components/Loader\"\nimport LongAbsence from \"src/components/LongAbsence\"\nimport { useUser } from \"src/providers/user\"\nimport apollo from \"src/helpers/apollo\"\nimport { USER_UPDATE } from \"src/graphql/queriesUser\"\nimport { useDialog } from \"src/providers/dialog\"\nimport { handleError } from \"src/helpers/errors\"\nimport { formatRoles } from \"src/helpers/role\"\nimport { formatName } from \"src/helpers/user\"\n\nconst Loading = styled.div`\n  height: 50vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst Container = styled.div`\n  margin: 0 auto;\n  max-width: 500px;\n  p,\n  .MuiTextField-root {\n    margin: 10px 0;\n  }\n  button {\n    margin: 15px auto;\n    display: block;\n  }\n`\n\nconst UserDataShare = styled(FormControl)`\n  margin: 10px 0;\n`\n\nconst ProfilePage = () => {\n  const { user, refetchUser } = useUser<true>()\n  const [saving, setSaving] = useState(false)\n  const { openDialog } = useDialog()\n  const [openAbsenceDialog, setOpenAbsenceDialog] = useState(false)\n  const [unsavedChanges, setUnsavedChanges] = useState(false)\n  const [values, setValues] = useState({\n    email: user?.email || \"\",\n    telephone: user?.telephone || \"\",\n    affichageDonneesPersonnelles: user?.affichageDonneesPersonnelles,\n  })\n\n  useEffect(() => {\n    if (user) {\n      setValues({\n        email: user.email,\n        telephone: user.telephone,\n        affichageDonneesPersonnelles: user.affichageDonneesPersonnelles,\n      })\n    }\n  }, [user])\n\n  useEffect(() => {\n    const alertUser = (e: any) => {\n      if (unsavedChanges) {\n        e.preventDefault()\n        e.returnValue = \"\"\n      }\n    }\n\n    window.addEventListener(\"beforeunload\", alertUser)\n    return () => {\n      window.removeEventListener(\"beforeunload\", alertUser)\n    }\n  }, [unsavedChanges])\n\n  const handleInputChange = ({ target }: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = target\n    setValues({\n      ...values,\n      [name]: value,\n    })\n    setUnsavedChanges(true)\n  }\n\n  const handleSave = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    setSaving(true)\n    try {\n      await apollo.mutate({\n        mutation: USER_UPDATE,\n        variables: { ...values, idUser: user?.id },\n      })\n      refetchUser()\n      openDialog(\"Tes informations ont bien été mises à jour\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n    setUnsavedChanges(false)\n    setSaving(false)\n  }\n\n  const handleOpenAbsenceDialog = () => {\n    setOpenAbsenceDialog(true)\n  }\n\n  const handleCloseAbsenceDialog = () => {\n    setOpenAbsenceDialog(false)\n  }\n\n  const handleDisplayContactDetails = (event: ChangeEvent<HTMLInputElement>) => {\n    setValues({\n      ...values,\n      affichageDonneesPersonnelles: event.target.value.toLowerCase() == \"true\", //Convert to bool\n    })\n    setUnsavedChanges(true)\n  }\n\n  if (!user) {\n    return (\n      <Loading>\n        <Loader />\n      </Loading>\n    )\n  }\n\n  return (\n    <>\n      <Prompt\n        when={unsavedChanges}\n        message=\"Les changements n'ont pas été enregistrés, es-tu sûr·e de vouloir abandonner la page?\"\n      />\n      <Container>\n        <form onSubmit={handleSave}>\n          <Typography variant=\"h2\">{formatName(user)}</Typography>\n          <p>{formatRoles(user.rolesChouette)}</p>\n          <TextField\n            name=\"telephone\"\n            label=\"Téléphone\"\n            required\n            disabled={!user}\n            value={values.telephone}\n            onChange={handleInputChange}\n            fullWidth\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <Phone />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <TextField\n            name=\"email\"\n            label=\"Adresse e-mail\"\n            required\n            disabled={true}\n            value={values.email}\n            onChange={handleInputChange}\n            fullWidth\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <Mail />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <UserDataShare>\n            <p>\n              {\" \"}\n              L’accès à mes coordonnées (email et numéro de téléphone) par tous les coopérateurs·rices facilite la\n              communication entre coopérateurs·rices et optimise l’organisation des PIAF au magasin, par exemple en cas\n              d’indisponibilité au dernier moment.\n            </p>\n            <p>Je peux modifier ce choix à tout moment.</p>\n            <RadioGroup\n              aria-label=\"displayMyContactDetails\"\n              defaultValue=\"false\"\n              name=\"radio-buttons-group\"\n              value={values.affichageDonneesPersonnelles ? \"true\" : \"false\"}\n              onChange={handleDisplayContactDetails}\n            >\n              <FormControlLabel\n                value=\"true\"\n                control={<Radio />}\n                label=\"Je comprends et j’accepte que mes coordonnées soient visibles par tous·tes les coopérateurs·rices\"\n              />\n              <FormControlLabel\n                value=\"false\"\n                control={<Radio />}\n                label=\"Je n’accepte pas que mes coordonnées soient visibles\"\n              />\n            </RadioGroup>\n          </UserDataShare>\n          <Button color=\"primary\" variant=\"contained\" disabled={saving} type=\"submit\">\n            Enregistrer\n          </Button>\n          <Button color=\"primary\" disabled={saving} onClick={handleOpenAbsenceDialog}>\n            Tu ne peux pas faire des PIAF pendant au moins 2 mois, c’est par ici!\n          </Button>\n        </form>\n        <LongAbsence show={openAbsenceDialog} handleClose={handleCloseAbsenceDialog} user={user} />\n      </Container>\n    </>\n  )\n}\n\nexport default ProfilePage\n","import { CreneauGenerique, Reserve } from \"src/types/model\"\nimport { IReserve } from \"src/types/app\"\n\nimport { useEffect, useState } from \"react\"\nimport { Prompt } from \"react-router\"\nimport { Button, FormGroup, FormControlLabel, Checkbox, Typography } from \"@material-ui/core\"\nimport { useQuery } from \"@apollo/client\"\nimport styled from \"@emotion/styled/macro\"\n\nimport Loader from \"src/components/Loader\"\nimport apollo from \"src/helpers/apollo\"\nimport { handleError } from \"src/helpers/errors\"\nimport { RESERVE_CREATE, RESERVE_UPDATE, CRENEAUX_GENERIQUES, RESERVE_USER } from \"src/graphql/queries\"\nimport { useUser } from \"src/providers/user\"\nimport { useDialog } from \"src/providers/dialog\"\nimport { formatTime, getDayOfWeek } from \"src/helpers/date\"\nimport { ErrorBlock } from \"src/helpers/errors\"\n\nconst Loading = styled.div`\n  height: 300px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst ReserveGrid = styled.div`\n  margin-top: 2rem;\n  @media (min-width: 980px) {\n    display: flex;\n    > div {\n      flex: 1 0 14.29%;\n    }\n  }\n`\n/*\nconst Infos = styled.div`\n  margin: 20px 0 40px;\n`*/\n\ntype ResultCG = { creneauGeneriques: CreneauGenerique[] }\ntype ResultRU = { reserves: Reserve[] }\n\nconst ReservePage = () => {\n  const { user } = useUser<true>()\n  const [saving, setSaving] = useState(false)\n  const { openDialog } = useDialog()\n  const [information, setInformation] = useState<string>(\"\")\n  const [slots, setSlots] = useState<string[]>([])\n  const [unsavedChanges, setUnsavedChanges] = useState(false)\n\n  const { data: dataCreneauxList, loading: loadingCL, error: errorCreneauxList } = useQuery<ResultCG>(\n    CRENEAUX_GENERIQUES\n  )\n  const { data: dataCreneauxUser, loading: loadingCU, error: errorReserve } = useQuery<ResultRU>(RESERVE_USER, {\n    skip: !user,\n    variables: { idUser: user?.id },\n  })\n  const loading = loadingCL || loadingCU\n\n  useEffect(() => {\n    if (dataCreneauxUser && dataCreneauxUser?.reserves.length > 0) {\n      setInformation(dataCreneauxUser.reserves[0].informations)\n      setSlots(dataCreneauxUser.reserves[0].creneauGeneriques.map((cg) => cg.id))\n    }\n  }, [dataCreneauxUser])\n\n  useEffect(() => {\n    const alertUser = (e: any) => {\n      if (unsavedChanges) {\n        e.preventDefault()\n        e.returnValue = \"\"\n      }\n    }\n\n    window.addEventListener(\"beforeunload\", alertUser)\n    return () => {\n      window.removeEventListener(\"beforeunload\", alertUser)\n    }\n  }, [unsavedChanges])\n\n  const queryError = errorCreneauxList || errorReserve\n  if (queryError) {\n    return <ErrorBlock error={queryError} />\n  }\n\n  const slotList: IReserve[] = []\n\n  if (dataCreneauxList) {\n    for (let day = 0; day < 7; day++) {\n      dataCreneauxList?.creneauGeneriques\n        .filter(({ jour, actif, horsMag }) => jour === day && actif && !horsMag)\n        .forEach((slot) => {\n          const reserveFound = slotList.find((s) => s.day === day)\n          const startTime = new Date(slot.heureDebut).getTime()\n          if (reserveFound) {\n            const slotReserveFound = reserveFound.slots.find(({ time }) => time === startTime)\n            if (slotReserveFound) {\n              slotReserveFound.allSlotIds.push(slot.id)\n            } else {\n              reserveFound.slots.push({\n                time: startTime,\n                slotDisplayed: slot,\n                allSlotIds: [slot.id],\n              })\n            }\n          } else {\n            slotList.push({\n              day: day,\n              slots: [\n                {\n                  time: startTime,\n                  slotDisplayed: slot,\n                  allSlotIds: [slot.id],\n                },\n              ],\n            })\n          }\n        })\n    }\n  }\n\n  /*\n  const handleInfoChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    setInformation(target.value)\n    setUnsavedChanges(true)\n  }*/\n\n  const getSlots = (idCreneauGenerique: string) => {\n    let list: string[] = []\n    slotList.forEach((slot) => {\n      const selected = slot.slots.find((displayed) => displayed.slotDisplayed.id === idCreneauGenerique)\n      if (selected) {\n        list = selected.allSlotIds\n      }\n    })\n    return list\n  }\n\n  const handleCheckboxChange = (idCreneauGenerique: string, checked: boolean) => {\n    const temp = slots.slice()\n    if (checked) {\n      temp.push(...getSlots(idCreneauGenerique))\n      setSlots(temp)\n    } else {\n      getSlots(idCreneauGenerique).forEach((slot) => {\n        temp.splice(temp.indexOf(slot), 1)\n      })\n      setSlots(temp)\n    }\n    setUnsavedChanges(true)\n  }\n\n  const handleSave = async () => {\n    setSaving(true)\n\n    const variables: Record<string, any> = {\n      user: user?.id,\n      informations: information,\n      creneauGenerique: slots,\n    }\n    if (dataCreneauxUser?.reserves.length) {\n      variables.id = dataCreneauxUser.reserves[0].id\n    }\n\n    try {\n      await apollo.mutate({\n        mutation: variables.id ? RESERVE_UPDATE : RESERVE_CREATE,\n        variables,\n      })\n\n      setUnsavedChanges(false)\n\n      const text = variables.id\n        ? \"Ton inscription à la réserve a bien été mise à jour\"\n        : \"Tu es désormais inscrit·e à la reserve\"\n\n      openDialog(text + \". Merci !\")\n    } catch (error) {\n      handleError(error as Error)\n    }\n\n    setSaving(false)\n  }\n\n  return (\n    <>\n      <Prompt\n        when={unsavedChanges}\n        message=\"Les changements n'ont pas été enregistrés, es-tu sûr·e de vouloir abandonner la page?\"\n      />\n      <Typography variant=\"h2\">Réserve</Typography>\n      {loading ? (\n        <Loading>\n          <Loader />\n        </Loading>\n      ) : (\n        <>\n          Jours pour lesquels je peux parfois me rendre disponible. Si un créneau est libre moins de 48h avant, un\n          e-mail sera envoyé à tou·te·s les inscrit·te·s.\n          <ReserveGrid>\n            {slotList.map((reserve) => (\n              <FormGroup key={reserve.day}>\n                {getDayOfWeek(reserve.day)}\n                {reserve.slots\n                  .sort((left, right) => (left.time > right.time ? 1 : -1))\n                  .map(({ slotDisplayed }) => (\n                    <FormControlLabel\n                      key={slotDisplayed.id}\n                      control={\n                        <Checkbox\n                          color=\"default\"\n                          checked={slots.includes(slotDisplayed.id)}\n                          onChange={({ target }) => {\n                            handleCheckboxChange(slotDisplayed.id, target.checked)\n                          }}\n                        />\n                      }\n                      label={`${formatTime(slotDisplayed.heureDebut)} - ${formatTime(slotDisplayed.heureFin)}`}\n                    />\n                  ))}\n              </FormGroup>\n            ))}\n          </ReserveGrid>\n          {/* <Infos>\n            <TextField\n              multiline\n              disabled={loading}\n              label=\"Informations supplémentaires (optionnel)\"\n              value={information}\n              onChange={handleInfoChange}\n              fullWidth\n            />\n          </Infos> */}\n          <Button disabled={saving} color=\"primary\" variant=\"contained\" onClick={handleSave}>\n            Enregistrer\n          </Button>\n        </>\n      )}\n    </>\n  )\n}\n\nexport default ReservePage\n","import type { User } from \"src/types/model\"\n\nimport { Button } from \"@material-ui/core\"\nimport { Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, Grid } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\n\nimport UserPiafs from \"src/components/UserPiafs\"\nimport { formatRoles } from \"src/helpers/role\"\nimport { formatName } from \"src/helpers/user\"\n\nconst RightCol = styled(Grid)`\n  display: flex;\n  align-items: center;\n`\n\ninterface Props {\n  open: boolean\n  handleClose: (event: React.MouseEvent<HTMLButtonElement>) => void\n  data?: User\n}\n\nconst UserInfoDialog = ({ open, handleClose, data }: Props) => {\n  if (!data) {\n    return null\n  }\n\n  return (\n    <Dialog\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{formatName(data)}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          <Grid container>\n            <Grid item xs={6}>\n              <h3>Roles</h3>\n            </Grid>\n            <RightCol item xs={6}>\n              {formatRoles(data.rolesChouette)}\n            </RightCol>\n            <Grid item xs={6}>\n              <h3>Statut</h3>\n            </Grid>\n            <RightCol item xs={6}>\n              {data.statut}\n            </RightCol>\n            <Grid item xs={6}>\n              <h3>Compteur PIAF</h3>\n            </Grid>\n            <RightCol item xs={6}>\n              {data.nbPiafEffectuees}/{data.nbPiafAttendues}\n            </RightCol>\n            <Grid item xs={6}>\n              <h3>Absence longue durée sans courses</h3>\n            </Grid>\n            <RightCol item xs={6}>\n              {data.absenceLongueDureeSansCourses ? \"oui\" : \"non\"}\n            </RightCol>\n            <Grid item xs={6}>\n              <h3>Absence longue durée avec courses</h3>\n            </Grid>\n            <RightCol item xs={6}>\n              {data.absenceLongueDureeCourses ? \"oui\" : \"non\"}\n            </RightCol>\n            <Grid item xs={12}>\n              <UserPiafs userId={data.id} validated={false} allowValidate={true} />\n            </Grid>\n          </Grid>\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\" variant=\"contained\">\n          Fermer\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default UserInfoDialog\n","import type { Role, User } from \"src/types/model\"\n\nimport { useState } from \"react\"\nimport { DataGrid, GridColumns, GridRowData, GridValueFormatterParams } from \"@material-ui/data-grid\"\nimport { useQuery } from \"@apollo/client\"\nimport styled from \"@emotion/styled/macro\"\n\nimport Loader from \"src/components/Loader\"\nimport UserInfoDialog from \"src/components/UserInfoDialog\"\nimport { USERS } from \"src/graphql/queriesUser\"\nimport { ErrorMessage } from \"src/helpers/errors\"\nimport { formatRoles } from \"src/helpers/role\"\n\nconst StyledGrid = styled(DataGrid)`\n  margin-top: 16px;\n  height: calc(100vh - 150px);\n  .MuiDataGrid-row {\n    cursor: pointer;\n  }\n`\n\nconst booleanFormatter = ({ value }: GridValueFormatterParams) => (value ? \"oui\" : \"non\")\n\ntype Result = { users: User[] }\n\nconst COLUMNS: GridColumns = [\n  { field: \"nom\", headerName: \"Nom\", flex: 1 },\n  { field: \"prenom\", headerName: \"Prenom\", flex: 1 },\n  { field: \"statut\", headerName: \"Statut\", flex: 1 },\n  {\n    field: \"rolesChouette\",\n    headerName: \"Roles\",\n    flex: 2,\n    valueFormatter: ({ value }: GridValueFormatterParams) => formatRoles(value as Role[]),\n  },\n  {\n    field: \"absenceLongueDureeCourses\",\n    headerName: \"Absence avec courses\",\n    flex: 1,\n    valueFormatter: booleanFormatter,\n  },\n  {\n    field: \"absenceLongueDureeSansCourses\",\n    headerName: \"Absence sans courses\",\n    flex: 1,\n    valueFormatter: booleanFormatter,\n  },\n]\n\nconst Users = () => {\n  const { data, loading, error } = useQuery<Result>(USERS)\n  const [selectedRow, setSelectedRow] = useState<User>()\n  const [openDialog, setOpenDialog] = useState(false)\n\n  if (loading) {\n    return <Loader />\n  }\n\n  if (error) {\n    return <ErrorMessage error={error} />\n  }\n\n  if (!data) {\n    return null\n  }\n\n  const rows = data.users.slice().sort((left, right) => (left.nom > right.nom ? 1 : -1))\n\n  const onRowClick = ({ row }: GridRowData) => {\n    setSelectedRow(row)\n    setOpenDialog(true)\n  }\n\n  const handleCloseDialog = () => {\n    setOpenDialog(false)\n  }\n\n  return (\n    <>\n      <StyledGrid rows={rows} columns={COLUMNS} onRowClick={onRowClick} autoPageSize />\n      <UserInfoDialog open={openDialog} handleClose={handleCloseDialog} data={selectedRow} />\n    </>\n  )\n}\n\nexport default Users\n","import { Typography } from \"@material-ui/core\"\n\nimport Users from \"src/components/Users\"\n\nconst MagasinPage = () => {\n  return (\n    <>\n      <Typography variant=\"h2\">Groupe MAG</Typography>\n      <Users />\n    </>\n  )\n}\n\nexport default MagasinPage\n","import { Typography } from \"@material-ui/core\"\n\nimport Users from \"src/components/Users\"\n\nconst BdMPage = () => {\n  return (\n    <>\n      <Typography variant=\"h2\">Groupe BdM</Typography>\n      <Users />\n    </>\n  )\n}\n\nexport default BdMPage\n","import type { PIAF } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { List } from \"@material-ui/core\"\n\nimport { PIAFS } from \"src/graphql/queries\"\nimport { ErrorMessage } from \"src/helpers/errors\"\nimport { orderPiafsByDate } from \"src/helpers/piaf\"\nimport Loader from \"src/components/Loader\"\nimport Piaf from \"src/components/Piaf\"\n\ntype Result = { piafs: PIAF[] }\ninterface Props {\n  userId: string\n  after: string\n  before: string\n}\nconst UserPiafHistory = ({ userId, after, before }: Props) => {\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: {\n      before: before,\n      after: after,\n      statut: \"occupe\",\n      userId: userId,\n    },\n  })\n\n  if (loading) {\n    return <Loader />\n  }\n\n  if (error) {\n    return <ErrorMessage error={error} />\n  }\n\n  if (!data) {\n    return null\n  }\n\n  if (!data.piafs.length) {\n    return <p>Tu n’as pas encore fait des PIAF. Inscris-toi sur le planning !</p>\n  }\n\n  const historyPiafs = data.piafs.filter(({ pourvu }) => pourvu == true).sort(orderPiafsByDate)\n\n  return (\n    <List>\n      {historyPiafs.map((piaf) => (\n        <Piaf key={piaf.id} piaf={piaf} />\n      ))}\n    </List>\n  )\n}\n\nexport default UserPiafHistory\n","import { addMonths } from \"date-fns\"\nimport { TextField, Typography } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\nimport { useState } from \"react\"\n\nimport { useUser } from \"src/providers/user\"\nimport { queryDate } from \"src/helpers/date\"\n\nimport UserPiafHistory from \"src/components/UserPiafHistory\"\n\nconst DateField = styled(TextField)`\n  margin: ${({ theme }) => theme.spacing(1)}px;\n`\n\nconst currentDate = new Date(Date.now())\n\nconst HistoryPage = () => {\n  const { auth } = useUser<true>()\n  const [selectedDateIni, setSelectedDateIni] = useState(addMonths(currentDate, -3))\n  const [selectedDateFin, setSelectedDateFin] = useState(currentDate)\n\n  const handleChange = (event: any) => {\n    if (event.target.valueAsDate) {\n      if (event.target.id === \"dateIni\") {\n        setSelectedDateIni(event.target.valueAsDate)\n      } else if (event.target.id === \"dateFin\") {\n        setSelectedDateFin(event.target.valueAsDate)\n      }\n    }\n  }\n\n  return (\n    <>\n      <Typography variant=\"h2\">Historique des PIAF</Typography>\n      <DateField\n        id=\"dateIni\"\n        label=\"Depuis\"\n        type=\"date\"\n        defaultValue={queryDate(selectedDateIni)}\n        InputLabelProps={{\n          shrink: true,\n        }}\n        onChange={handleChange}\n      />\n      <DateField\n        id=\"dateFin\"\n        label=\"Jusqu’au\"\n        type=\"date\"\n        defaultValue={queryDate(selectedDateFin)}\n        InputLabelProps={{\n          shrink: true,\n        }}\n        onChange={handleChange}\n      />\n      <UserPiafHistory\n        userId={`api/users/${auth.id}`}\n        after={queryDate(selectedDateIni)}\n        before={queryDate(selectedDateFin)}\n      />\n    </>\n  )\n}\n\nexport default HistoryPage\n","import { ComponentType } from \"react\"\nimport { Redirect, Route } from \"react-router-dom\"\n\nimport { useUser } from \"src/providers/user\"\nimport { hasAtLeastOneRole } from \"src/helpers/role\"\nimport { RoleId } from \"src/types/model\"\n\ninterface Props {\n  path: string\n  component: ComponentType<any>\n  roleIds: RoleId[]\n  redirectionPath: string\n}\n\nconst RestrictedRoute = ({ path, component, roleIds, redirectionPath }: Props) => {\n  const { user } = useUser<true>()\n  return (\n    <>\n      {user &&\n        (hasAtLeastOneRole(roleIds, user.rolesChouette) ? (\n          <Route path={path} component={component} />\n        ) : (\n          <Redirect to={redirectionPath} />\n        ))}\n    </>\n  )\n}\n\nexport default RestrictedRoute\n","import { Typography } from \"@material-ui/core\"\n\nconst LegalPage = () => {\n  return (\n    <>\n      <Typography variant=\"h2\">Politique de traitement des données personnelles</Typography>\n      <p>\n        Les informations recueillies sur ces formulaires sont enregistrées dans un fichier informatisé par La Chouette\n        Coop SAS, pour permettre la gestion du planning de participation des coopérateurs·rices au fonctionnement de la\n        coopérative. La base légale du traitement est le contrat par lequel les coopérateurs·rices s’engagent à\n        effectuer 3 heures de participation toutes les 4 semaines à la coopérative.\n      </p>\n      <p>\n        Les données sont communiquées aux seuls coopérateurs·rices de La Chouette Coop. Elles sont conservées pendant la\n        durée du mandat de coopérateur·rice et en cas de démission pendant 5 ans maximum.\n      </p>\n      <p>Les données sont hébergées en France par OVH.</p>\n      <p>\n        Vous pouvez accéder aux données vous concernant, les rectifier, demander leur effacement ou exercer votre droit\n        à la limitation du traitement de vos données. Pour exercer ces droits ou pour toute question sur le traitement\n        de vos données dans ce dispositif, vous pouvez contacter :{\" \"}\n        <a href=\"mailto:bureau-des-membres@lachouettecoop.fr\">bureau-des-membres@lachouettecoop.fr</a>\n      </p>\n      <p>\n        Si vous estimez, après nous avoir contactés, que vos droits « Informatique et Libertés » ne sont pas respectés,\n        vous pouvez adresser une réclamation à la CNIL.\n      </p>\n    </>\n  )\n}\n\nexport default LegalPage\n","import { Redirect, Route, Switch, useLocation } from \"react-router-dom\"\nimport styled from \"@emotion/styled/macro\"\n\nimport { DatePlanningProvider } from \"src/providers/datePlanning\"\nimport { RoleId } from \"src/types/model\"\nimport { getParams } from \"src/helpers/request\"\n\nimport Menu from \"src/components/menu\"\nimport MenuBottom from \"src/components/menuBottom\"\n\nimport HomePage from \"src/pages/authenticated/Home\"\nimport PlanningPage from \"src/pages/authenticated/Planning\"\nimport ProfilePage from \"src/pages/authenticated/Profile\"\nimport ReservePage from \"src/pages/authenticated/Reserve\"\nimport MagasinPage from \"src/pages/authenticated/Magasin\"\nimport BdMPage from \"src/pages/authenticated/BdM\"\nimport HistoryPage from \"src/pages/authenticated/History\"\nimport RestrictedRoute from \"src/pages/authenticated/RestrictedRoute\"\nimport LegalPage from \"src/pages/Legal\"\n\nconst Content = styled.div`\n  margin: ${({ theme }) => theme.spacing(3)}px;\n  ${({ theme }) => theme.breakpoints.down(\"xs\")} {\n    margin-bottom: ${({ theme }) => theme.spacing(12)}px;\n  }\n  ${({ theme }) => theme.breakpoints.up(\"sm\")} {\n    margin-left: ${({ theme }) => theme.spacing(12)}px;\n  }\n`\n\nconst Authenticated = () => {\n  const { search } = useLocation()\n  const { next } = getParams(search)\n\n  return (\n    <DatePlanningProvider>\n      <Menu />\n      <Content>\n        <Switch>\n          <RestrictedRoute path=\"/home\" component={HomePage} roleIds={[RoleId.Chouettos]} redirectionPath=\"/planning\" />\n          <Route path=\"/planning\" component={PlanningPage} />\n          <RestrictedRoute\n            path=\"/profile\"\n            component={ProfilePage}\n            roleIds={[RoleId.Chouettos]}\n            redirectionPath=\"/planning\"\n          />\n          <RestrictedRoute\n            path=\"/reserve\"\n            component={ReservePage}\n            roleIds={[RoleId.Chouettos]}\n            redirectionPath=\"/planning\"\n          />\n          <RestrictedRoute path=\"/bdm\" component={BdMPage} roleIds={[RoleId.AdminBdM]} redirectionPath=\"/planning\" />\n          <RestrictedRoute\n            path=\"/magasin\"\n            component={MagasinPage}\n            roleIds={[RoleId.AdminMag]}\n            redirectionPath=\"/planning\"\n          />\n          <RestrictedRoute\n            path=\"/history\"\n            component={HistoryPage}\n            roleIds={[RoleId.Chouettos]}\n            redirectionPath=\"/planning\"\n          />\n          <Route path=\"/legal\" component={LegalPage} />\n          <Redirect to={next || \"/home\"} />\n        </Switch>\n        <MenuBottom />\n      </Content>\n    </DatePlanningProvider>\n  )\n}\n\nexport default Authenticated\n","import { BrowserRouter } from \"react-router-dom\"\n\nimport { useUser } from \"src/providers/user\"\nimport { DialogProvider } from \"src/providers/dialog\"\n\nimport Anonymous from \"src/pages/anonymous\"\nimport Authenticated from \"src/pages/authenticated\"\n\nconst App = () => {\n  const { auth } = useUser()\n\n  return (\n    <BrowserRouter>\n      <DialogProvider>{auth ? <Authenticated /> : <Anonymous />}</DialogProvider>\n    </BrowserRouter>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { ApolloProvider } from \"@apollo/client\"\n\nimport { ErrorBoundary } from \"src/helpers/errors\"\nimport apollo from \"src/helpers/apollo\"\nimport { UserProvider } from \"src/providers/user\"\nimport ThemeProvider from \"src/providers/theme\"\nimport { RolesProvider } from \"src/providers/roles\"\nimport App from \"src/App\"\n\nReactDOM.render(\n  <ErrorBoundary>\n    <React.StrictMode>\n      <ThemeProvider>\n        <ApolloProvider client={apollo}>\n          <UserProvider>\n            <RolesProvider>\n              <App />\n            </RolesProvider>\n          </UserProvider>\n        </ApolloProvider>\n      </ThemeProvider>\n    </React.StrictMode>\n  </ErrorBoundary>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}