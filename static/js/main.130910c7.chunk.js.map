{"version":3,"sources":["graphql/queries.ts","helpers/apollo.ts","providers/user.tsx","helpers/request.ts","helpers/errors.ts","pages/anonymous/Login.tsx","pages/anonymous/index.tsx","providers/datePlanning.tsx","helpers/date.ts","components/ErrorMessage.tsx","components/PiafCircle.tsx","images/chouettos.png","components/InfoDialog.tsx","providers/dialog.tsx","components/SlotDialog.tsx","components/Piaf.tsx","components/UserPiafs.tsx","components/ReplacementPiafs.tsx","pages/authenticated/Home.tsx","components/Slot.tsx","components/CalendarDay.tsx","components/Calendar.tsx","pages/authenticated/Planning.tsx","pages/authenticated/Profile.tsx","components/Link.tsx","components/menu.tsx","components/menuBottom.tsx","pages/authenticated/Reserve.tsx","pages/authenticated/index.tsx","App.tsx","index.tsx"],"names":["LOGGED_IN_USER","gql","SLOTS","PIAFS","PLANNING","REGISTRATION_UPDATE","USER_UPDATE","RESERVE_CREATE","RESERVE_UPDATE","RESERVE_USER","CRENEAUX_GENERIQUES","link","createHttpLink","uri","process","authLink","setContext","_","previous","user","getStoredUser","headers","token","client","ApolloClient","concat","cache","InMemoryCache","UserContext","createContext","STORAGE_KEY","stored","localStorage","getItem","JSON","parse","UserProvider","children","useState","auth","setAuth","setUser","useEffect","apollo","query","variables","id","then","data","Provider","value","login","setItem","stringify","logout","removeItem","useUser","useContext","post","path","body","a","fetch","method","response","ok","HttpError","status","statusText","json","handleError","error","console","alert","message","LoginPage","loading","setLoading","handleSubmit","event","preventDefault","FormData","currentTarget","userId","email","get","Container","onSubmit","TextField","type","name","label","fullWidth","variant","margin","Button","size","color","disabled","Anonymous","pathname","useLocation","Login","to","DatePlanningContext","getInitialStart","startOfMonth","Date","getInitialEnd","endOfMonth","DatePlanningProvider","start","setStart","end","setEnd","goBack","date","subMonths","goForward","addMonths","goToday","formatInFrench","pattern","format","locale","fr","formatDateLong","formatTime","WEEKDAYS","queryDate","ErrorMessage","STATUS_COLORS","available","replacement","occupied","IMAGES","CH","getImg","role","img","PiafIcon","$status","$role","getStatus","piaf","statut","piaffeur","PiafCircle","roleUniqueId","InfoDialog","open","handleClose","title","Dialog","onClose","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","DialogActions","onClick","DialogContext","DialogProvider","setOpen","setTitle","setMessage","closeDialog","openDialog","newMessage","newTitle","useDialog","CloseButton","IconButton","Title","PiafRow","Status","Contact","SlotInfo","slot","show","piafCurrentUser","piafs","find","hideButtons","getTime","now","getPiafCountByWeek","after","startOfWeek","before","endOfWeek","idPiaffeur","result","length","getPiafCountByDay","startOfDay","endOfDay","register","roles","rolesChouette","libelle","idPiaf","piafReplacement","mutate","mutation","unregister","Close","capitalize","map","prenom","nom","href","telephone","CircularProgress","Piaf","creneau","useLazyQuery","load","titre","debut","fin","ListItem","button","ListItemAvatar","ListItemText","primary","secondary","SlotDialog","UserPiafs","useQuery","startOfToday","List","ReplacementPiafs","addDays","otherPiafs","filter","MyPlanning","Replacements","activeStatus","statuts","s","actif","HomePage","SELECTED_COLOR","ClickableSlot","$open","Slot","$when","CalendarDay","day","isToday","isPast","slots","DayPlaceholder","WeekRow","Calendar","list","weeks","eachWeekOfInterval","weekStartsOn","days","i","forEach","node","weekIndex","differenceInWeeks","week","getDay","slice","sort","left","right","push","index","Loading","Caption","CaptionTitle","Nav","ButtonArea","PlanningPage","theme","useTheme","matches","useMediaQuery","breakpoints","up","textTodayButton","textBeforeButton","textAfterButton","Grid","container","item","xs","md","startIcon","ArrowBackIos","isSameMonth","CalendarToday","endIcon","ArrowForwardIos","creneaus","ProfilePage","saving","setSaving","values","setValues","handleInputChange","target","handleSave","idUser","toLowerCase","r","join","required","onChange","InputProps","startAdornment","InputAdornment","position","Phone","Mail","UniversalLink","props","startsWith","DRAWER_WIDTH","Spacer","styled","Box","flexGrow","useStyles","makeStyles","createStyles","root","display","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","width","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","spacing","toolbar","alignItems","justifyContent","padding","mixins","content","menuItem","textDecoration","ITEMS","Icon","HomeIcon","EventIcon","GroupIcon","ReplayIcon","PersonIcon","ArrowBackIcon","Menu","classes","className","AppBar","clsx","Toolbar","aria-label","edge","Typography","noWrap","Drawer","paper","direction","ChevronRight","ChevronLeft","Divider","ListItemIcon","Person","Link","top","bottom","flexDirection","menu","paddingTop","paddingBottom","textMenuDecoration","textMenu","backgroundColor","palette","main","background","dark","icon","MAIN_ITEMS","EXTRA_ITEMS","BottomAppBar","anchorEl","setAnchorEl","down","keepMounted","Boolean","MenuItem","aria-controls","aria-haspopup","ReserveGrid","Infos","ReservePage","information","setInformation","setSlots","dataCreneauxList","loadingCL","errorCreneauxList","skip","dataCreneauxUser","loadingCU","errorReserve","reserves","informations","creneauGeneriques","cg","slotList","jour","reserveFound","startTime","heureDebut","slotReserveFound","time","allSlotIds","slotDisplayed","getSlots","idCreneauGenerique","selected","displayed","creneauGenerique","reserve","FormGroup","FormControlLabel","control","Checkbox","checked","includes","temp","splice","indexOf","handleCheckboxChange","heureFin","multiline","Content","marginTop","paddingLeft","Authenticated","next","search","params","substr","split","part","tuple","decodeURIComponent","getParams","Home","Planning","Profile","Reserve","createMuiTheme","contrastThreshold","tonalOffset","App","ThemeProvider","ReactDOM","render","StrictMode","CssBaseline","document","getElementById"],"mappings":"+MAEaA,EAAiBC,cAAH,4XA0BdC,EAAQD,cAAH,sVAwBLE,EAAQF,cAAH,keAyBLG,EAAWH,cAAH,mcA2BRI,EAAsBJ,cAAH,kTAcnBK,EAAcL,cAAH,2RAaXM,EAAiBN,cAAH,sfAsBdO,EAAiBP,cAAH,ygBAsBdQ,EAAeR,cAAH,8LAYZS,EAAsBT,cAAH,qQ,iBCtL1BU,EAAOC,yBAAe,CAC1BC,IAAI,GAAD,OAAKC,2CAAL,kBAGCC,EAAWC,aAAW,SAACC,EAAGC,GAC9B,IAAMC,EAAOC,IACb,OAAKD,EAGE,2BACFD,GADL,IAEEG,QAAQ,2BACHH,EAASG,SADP,IAEL,eAAgBF,EAAKG,UANhBJ,KAgBIK,EALA,IAAIC,eAAa,CAC9Bb,KAAMI,EAASU,OAAOd,GACtBe,MAAO,IAAIC,kB,OCLPC,EAAcC,wBAA4B,IAE1CC,EAAc,OAEPV,EAAgB,WAC3B,IAAMW,EAASC,aAAaC,QAAQH,GACpC,OAAKC,EAGEG,KAAKC,MAAMJ,GAFT,MAKEK,EAAmB,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAAe,EACxBC,mBAAsBlB,GADE,mBACzCmB,EADyC,KACnCC,EADmC,OAExBF,mBAAsB,MAFE,mBAEzCnB,EAFyC,KAEnCsB,EAFmC,KAIhDC,qBAAU,WACJH,GACFI,EACGC,MAAsB,CACrBA,MAAO5C,EACP6C,UAAW,CAAEC,GAAG,aAAD,OAAeP,EAAKO,OAEpCC,MAAK,YAAe,IAAZC,EAAW,EAAXA,KACPP,EAAQO,EAAK7B,WAGlB,CAACoB,IAYJ,OAAO,cAACX,EAAYqB,SAAb,CAAsBC,MAAO,CAAEX,OAAMpB,OAAMgC,MAVpC,SAACH,GACbR,EAAQQ,GACRhB,aAAaoB,QAAQtB,EAAaI,KAAKmB,UAAUL,KAQMM,OAL1C,WACbd,EAAQ,MACRR,aAAauB,WAAWzB,KAGnB,SAA6DO,KAG/D,SAASmB,IACd,OAAOC,qBAAW7B,G,kFC7DP8B,EAAI,uCAAG,WAAOC,EAAcC,GAArB,eAAAC,EAAA,sEACKC,MAAM,GAAD,OAAIhD,2CAAJ,YAAiC6C,GAAQ,CACnEI,OAAQ,OACRH,SAHgB,WACZI,EADY,QAKJC,GALI,sBAMV,IAAIC,IAAUF,EAASG,OAAQH,EAASI,YAN9B,gCAQXJ,EAASK,QARE,2CAAH,wDCDJC,EAAc,SAACC,GAC1BC,QAAQD,MAAMA,GACdE,MAAMF,EAAMG,UCuCCC,GAnCG,WAAO,IAAD,EACQrC,oBAAS,GADjB,mBACfsC,EADe,KACNC,EADM,KAEd1B,EAAUK,IAAVL,MAEF2B,EAAY,uCAAG,WAAOC,GAAP,mBAAAlB,EAAA,6DACnBkB,EAAMC,iBACApB,EAAO,IAAIqB,SAASF,EAAMG,eAChCL,GAAW,GAHQ,kBAKEnB,EAAK,YAAaE,GALpB,OAKXZ,EALW,OAMXT,EAAa,CACjBO,GAAIE,EAAKmC,OACTC,MAAOxB,EAAKyB,IAAI,YAChB/D,MAAO0B,EAAK1B,OAEd6B,EAAMZ,GAXW,kDAajB+B,EAAY,EAAD,IACXO,GAAW,GAdM,0DAAH,sDAkBlB,OACE,cAACS,EAAA,EAAD,UACE,uBAAMC,SAAUT,EAAhB,UACE,cAACU,EAAA,EAAD,CAAWC,KAAK,QAAQC,KAAK,WAAWC,MAAM,SAASC,WAAS,EAACC,QAAQ,WAAWC,OAAO,WAC3F,cAACN,EAAA,EAAD,CAAWC,KAAK,WAAWC,KAAK,WAAWC,MAAM,eAAeC,WAAS,EAACC,QAAQ,WAAWC,OAAO,WACpG,cAACC,EAAA,EAAD,CAAQN,KAAK,SAASG,WAAS,EAACI,KAAK,QAAQH,QAAQ,YAAYI,MAAM,UAAUC,SAAUtB,EAA3F,6BCdOuB,GAfG,WAAO,IACfC,EAAaC,cAAbD,SAER,OACE,cAACd,EAAA,EAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAO3B,KAAK,SAAZ,SACE,cAAC2C,GAAD,MAEF,cAAC,IAAD,CAAUC,GAAE,sBAAiBH,W,2DCH/BI,GAAsB3E,wBAAoC,IAE1D4E,GAAkB,kBAAMC,aAAa,IAAIC,OACzCC,GAAgB,kBAAMC,aAAW,IAAIF,OAE9BG,GAA2B,SAAC,GAAkB,IAAhBzE,EAAe,EAAfA,SAAe,EAC9BC,mBAAemE,IADe,mBACjDM,EADiD,KAC1CC,EAD0C,OAElC1E,mBAAesE,IAFmB,mBAEjDK,EAFiD,KAE5CC,EAF4C,KAqBxD,OACE,cAACV,GAAoBvD,SAArB,CAA8BC,MAAO,CAAE6D,QAAOE,MAAKE,OAlBtC,WACb,IAAMC,EAAOC,aAAUN,EAAO,GAC9BC,EAASI,GACTF,EAAOL,aAAWO,KAeyCE,UAZ3C,WAChB,IAAMF,EAAOG,aAAUR,EAAO,GAC9BC,EAASI,GACTF,EAAOL,aAAWO,KASoDI,QANxD,WACdR,EAASP,IACTS,EAAON,MAIP,SACGvE,K,+DCpCDoF,GAAiB,SAACL,EAA8BM,GAIpD,MAHoB,kBAATN,IACTA,EAAO,IAAIT,KAAKS,IAEXO,aAAOP,EAAMM,EAAS,CAAEE,OAAQC,QAI5BC,GAAiB,SAACV,GAAD,OAAkCK,GAAeL,EAAM,qBAIxEW,GAAa,SAACX,GAAD,OAAkCK,GAAeL,EAAM,UAE3EY,GAAW,CAAC,QAAS,QAAS,WAAY,QAAS,WAAY,SAAU,YAGlEC,GAAY,SAACb,GAAD,OAAyBO,aAAOP,EAAM,eClB/D,IAIec,GAJG,kF,8BCKZC,GAAyC,CAC7CC,UAAW,QACXC,YAAa,SACbC,SAAU,SAGNC,GAA0C,CAC9CC,GCda,0yQDiBTC,GAAS,SAACC,GACd,GAAIA,EAAM,CACR,IAAMC,EAAMJ,GAAOG,GACnB,GAAIC,EACF,MAAM,OAAN,OAAcA,EAAd,OAKOC,GAAQ,mIAMC,gBAAGC,EAAH,EAAGA,QAAH,OAAiBV,GAAcU,KANhC,8DASC,gBAAGC,EAAH,EAAGA,MAAH,OAAeL,GAAOK,IAAU,SATjC,oHAiBRC,GAAY,SAACC,GACxB,MAAoB,iBAAhBA,EAAKC,OACA,cAELD,EAAKE,SACA,WAEF,aAaMC,GANI,SAAC,GAAD,IAAGH,EAAH,EAAGA,KAAH,OACjB,cAACJ,GAAD,CAAUC,QAASE,GAAUC,GAAOF,MAAOE,EAAKN,KAAKU,aAArD,SACGX,GAAOO,EAAKN,KAAKU,cAAgB,GAAKJ,EAAKN,KAAKU,gB,sHEvBtCC,GArBI,SAAC,GAAkD,IAAhDC,EAA+C,EAA/CA,KAAMC,EAAyC,EAAzCA,YAAaC,EAA4B,EAA5BA,MAAO9E,EAAqB,EAArBA,QAC9C,OACE,eAAC+E,GAAA,EAAD,CACEH,KAAMA,EACNI,QAASH,EACTI,kBAAgB,qBAChBC,mBAAiB,2BAJnB,UAME,cAACC,GAAA,EAAD,CAAa/G,GAAG,qBAAhB,SAAsC0G,IACtC,cAACM,GAAA,EAAD,UACE,cAACC,GAAA,EAAD,CAAmBjH,GAAG,2BAAtB,SAAkD4B,MAEpD,cAACsF,GAAA,EAAD,UACE,cAACjE,EAAA,EAAD,CAAQkE,QAASV,EAAatD,MAAM,UAApC,sBCnBFiE,GAAgBrI,wBAAc,IAEvBsI,GAAqB,SAAC,GAAkB,IAAhB9H,EAAe,EAAfA,SAAe,EAC1BC,oBAAS,GADiB,mBAC3CgH,EAD2C,KACrCc,EADqC,OAExB9H,mBAAS,IAFe,mBAE3CkH,EAF2C,KAEpCa,EAFoC,OAGpB/H,mBAAS,IAHW,mBAG3CoC,EAH2C,KAGlC4F,EAHkC,KAW5CC,EAAc,WAClBH,GAAQ,IAGV,OACE,eAACF,GAAcjH,SAAf,CAAwBC,MAAO,CAAEsH,WAXhB,SAACC,GAAuC,IAAnBC,EAAkB,uDAAP,GACjDJ,EAAWG,GACXJ,EAASK,GACTN,GAAQ,IAQqCG,eAA7C,UACGlI,EACD,cAAC,GAAD,CAAYiH,KAAMA,EAAMC,YAAagB,EAAaf,MAAOA,EAAO9E,QAASA,QAKlEiG,GAAY,kBAAMlH,qBAAWyG,KCf1C,IAAMU,GAAc,aAAOC,KAAP,sBAAH,8DAKXC,GAAK,sGAMLC,GAAO,2JAOPC,GAAM,yGAONC,GAAO,oFAyKEC,GA/JE,SAAC,GAAwC,IAAD,EAArCC,EAAqC,EAArCA,KAAMC,EAA+B,EAA/BA,KAAM7B,EAAyB,EAAzBA,YAAyB,EACzBjH,oBAAS,GADgB,mBAChDsC,EADgD,KACvCC,EADuC,KAE/C2F,EAAeG,KAAfH,WACArJ,EAASqC,IAATrC,KACFkK,EAAe,UAAGF,EAAKG,aAAR,aAAG,EAAYC,MAAK,gBAAGrC,EAAH,EAAGA,SAAUD,EAAb,EAAaA,OAAb,OAAkC,OAARC,QAAQ,IAARA,OAAA,EAAAA,EAAUpG,OAAV,OAAiB3B,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAM2B,KAAiB,WAAXmG,KAC1FuC,EAAcL,EAAKpE,MAAM0E,UAAY9E,KAAK+E,MAE1CC,EAAkB,uCAAG,gCAAA9H,EAAA,6DACnB+H,EAAQC,aAAYV,EAAKpE,OACzB+E,EAASC,aAAUZ,EAAKpE,OAFL,kBAIFpE,EAAOC,MAAc,CACxCA,MAAOzC,EACP0C,UAAW,CAAEmJ,WAAU,OAAE7K,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,GAAI8I,MAAOA,EAAOE,OAAQA,KANpC,cAIjBG,EAJiB,yBAQhBA,EAAOjJ,KAAKsI,MAAMY,QARF,gCAUvB5H,EAAY,EAAD,IAVY,iCAYlB,GAZkB,yDAAH,qDAelB6H,EAAiB,uCAAG,gCAAAtI,EAAA,6DAClB+H,EAAQQ,aAAWjB,EAAKpE,OACxB+E,EAASO,aAASlB,EAAKpE,OAFL,kBAIDpE,EAAOC,MAAc,CACxCA,MAAOzC,EACP0C,UAAW,CAAEmJ,WAAU,OAAE7K,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,GAAI8I,MAAOA,EAAOE,OAAQA,KANrC,cAIhBG,EAJgB,yBAQfA,EAAOjJ,KAAKsI,MAAMY,QARH,gCAUtB5H,EAAY,EAAD,IAVW,iCAYjB,GAZiB,yDAAH,qDAejBgI,EAAQ,uCAAG,WAAOtD,GAAP,qBAAAnF,EAAA,0DACT0I,EADS,OACDpL,QADC,IACDA,OADC,EACDA,EAAMqL,gBACLD,EAAMhB,MAAK,qBAAGzI,KAAgBkG,EAAKN,KAAK5F,MAFxC,uBAGb0H,EAAW,iFAAD,OAAqExB,EAAKN,KAAK+D,UAH5E,iCAOf5H,GAAW,GAPI,SAQU8G,IARV,oBASG,GATH,wBAUbnB,EAAW,qEAVE,4CAaS2B,IAbT,qBAcE,GAdF,wBAeb3B,EAAW,mEAfE,kCAqBXkC,EAAS1D,EAAKlG,IACZ6J,EAtBS,UAsBSxB,EAAKG,aAtBd,aAsBS,EAAYC,MAClC,gBAAGtC,EAAH,EAAGA,OAAQP,EAAX,EAAWA,KAAX,MAAiC,iBAAXO,GAA6BP,EAAK5F,KAAOkG,EAAKN,KAAK5F,SAGzE4J,EAASC,EAAgB7J,IA1BZ,oBA8BPH,EAAOiK,OAAO,CAClBC,SAAUxM,EACVwC,UAAW,CAAE6J,SAAQV,WAAU,OAAE7K,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,GAAImG,OAAQ,YAhCxC,QAmCbuB,EAAW,2BAnCE,mDAqCblG,EAAY,EAAD,IArCE,QAwCfO,GAAW,GAxCI,2DAAH,sDA2CRiI,EAAU,uCAAG,WAAO9D,GAAP,SAAAnF,EAAA,6DACjBgB,GAAW,GADM,kBAITlC,EAAOiK,OAAO,CAClBC,SAAUxM,EACVwC,UAAW,CAAE6J,OAAQ1D,EAAKlG,GAAIkJ,WAAU,OAAE7K,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,GAAImG,OAAQ,kBAN/C,OASfuB,EAAW,mFATI,gDAWflG,EAAY,EAAD,IAXI,QAcjBO,GAAW,GAdM,yDAAH,sDAiBhB,OACE,eAAC4E,GAAA,EAAD,CAAQH,KAAM8B,EAAM1B,QAASH,EAAa3D,WAAS,EAAnD,UACE,cAACgF,GAAD,CAAaX,QAASV,EAAtB,SACE,cAACwD,GAAA,EAAD,MAEF,eAAClD,GAAA,EAAD,WACGmD,aAAWlF,GAAeqD,EAAKpE,QAChC,uBACA,eAAC+D,GAAD,WACE,mCACG/C,GAAWoD,EAAKpE,OADnB,SAC4BgB,GAAWoD,EAAKlE,QAE5C,+BAAOkE,EAAK3B,cAGhB,cAACM,GAAA,EAAD,UACGqB,EAAKG,MACJH,EAAKG,MAAM2B,KAAI,SAACjE,GAAU,IAChBlG,EAAuBkG,EAAvBlG,GAAI4F,EAAmBM,EAAnBN,KAAMQ,EAAaF,EAAbE,SACZ/E,EAAS4E,GAAUC,GAEzB,OACE,eAAC+B,GAAD,WACE,cAAC,GAAD,CAAY/B,KAAMA,IAClB,eAACgC,GAAD,WACc,aAAX7G,GAAyB+E,EAAzB,UAAuCA,EAASgE,OAAhD,YAA0DhE,EAASiE,KAAQ,mBAC5E,uBACA,+BAAOzE,EAAK+D,aAEF,aAAXtI,GACCkH,GACsC,OAAtCA,EAAgB3C,KAAKU,cACrBF,GACAA,EAASpG,KAAT,OAAe3B,QAAf,IAAeA,OAAf,EAAeA,EAAM2B,KAEnB,eAACmI,GAAD,WACE,mBAAGmC,KAAI,iBAAYlE,EAAS9D,OAA5B,SAAsC8D,EAAS9D,QAC/C,uBACA,mBAAGgI,KAAI,cAASlE,EAASmE,WAAzB,SAAuCnE,EAASmE,eAG1C,aAAXlJ,IAA0BkH,IAAoBG,GAC7C,cAACzF,EAAA,EAAD,CAAQG,SAAUtB,EAASqB,MAAM,UAAUJ,QAAQ,YAAYoE,QAAS,kBAAMqC,EAAStD,IAAvF,8BAIO,OAARE,QAAQ,IAARA,OAAA,EAAAA,EAAUpG,OAAV,OAAiB3B,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAM2B,KAAsB,WAAhBkG,EAAKC,SAAwBuC,GACzD,cAACzF,EAAA,EAAD,CAAQG,SAAUtB,EAASqB,MAAM,UAAUJ,QAAQ,YAAYoE,QAAS,kBAAM6C,EAAW9D,IAAzF,wCAzBUlG,MAiClB,cAACwK,GAAA,EAAD,UCjJKC,GAzCF,SAAC,GAAqB,IAAnBvE,EAAkB,EAAlBA,KACNwE,EAAYxE,EAAZwE,QADwB,EAERlL,oBAAS,GAFD,mBAEzBgH,EAFyB,KAEnBc,EAFmB,OAIPqD,uBAAqBvN,EAAO,CACnD2C,UAAW,CAAEC,GAAI0K,EAAQ1K,MALK,mBAIzB4K,EAJyB,KAIjB1K,EAJiB,KAIjBA,KAaTmI,EAAc,CAClBrI,GAAI0K,EAAQ1K,GACZ0G,MAAOgE,EAAQG,MACf5G,MAAO,IAAIJ,KAAK6G,EAAQI,OACxB3G,IAAK,IAAIN,KAAK6G,EAAQK,KACtBvC,MAAK,OAAEtI,QAAF,IAAEA,OAAF,EAAEA,EAAMwK,QAAQlC,OAGvB,OACE,qCACE,eAACwC,GAAA,EAAD,CAAwBC,QAAM,EAAC9D,QAnBf,WAClBG,GAAQ,GACRsD,KAiBE,UACE,cAACM,GAAA,EAAD,UACE,cAAC,GAAD,CAAYhF,KAAMA,MAEpB,cAACiF,GAAA,EAAD,CACEC,QAASpG,GAAeqD,EAAKpE,OAC7BoH,UAAS,aAAQpG,GAAWoD,EAAKpE,OAAxB,iBAAoCgB,GAAWoD,EAAKlE,UANlD+B,EAAKlG,IASpB,cAACsL,GAAD,CAAYhD,KAAM9B,EAAM6B,KAAMA,EAAM5B,YAvBpB,WAClBa,GAAQ,UCmBGiE,GAvCG,WAAO,IACf9L,EAASiB,IAATjB,KADc,EAGW+L,mBAAiBnO,EAAO,CACvD0C,UAAW,CACTmJ,WAAW,cAAD,OAAgBzJ,EAAKO,IAC/B8I,MAAO3D,GAAUsG,mBAHb3J,EAHc,EAGdA,QAASL,EAHK,EAGLA,MAAOvB,EAHF,EAGEA,KAOxB,OAAI4B,EACK,cAAC0I,GAAA,EAAD,IAGL/I,EAEA,cAAC,GAAD,UACE,0CAAaA,EAAMG,aAKpB1B,EAIAA,EAAKsI,MAAMY,OAKd,cAACsC,GAAA,EAAD,UACGxL,EAAKsI,MAAM2B,KAAI,SAACjE,GAAD,OACd,cAAC,GAAD,CAAoBA,KAAMA,GAAfA,EAAKlG,SANb,yFAJA,M,UC0BI2L,GAjDU,WAAO,IACtBlM,EAASiB,IAATjB,KADqB,EAGI+L,mBAAiBnO,EAAO,CACvD0C,UAAW,CACT+I,MAAO3D,GAAUsG,gBACjBzC,OAAQ7D,GAAUyG,aAAQH,eAAgB,MAC1CtF,OAAQ,kBAJJrE,EAHqB,EAGrBA,QAASL,EAHY,EAGZA,MAAOvB,EAHK,EAGLA,KAQxB,GAAI4B,EACF,OAAO,cAAC0I,GAAA,EAAD,IAGT,GAAI/I,EACF,OACE,cAAC,GAAD,UACE,0CAAaA,EAAMG,aAKzB,IAAK1B,EACH,OAAO,KAGT,IAAM2L,EAAa3L,EAAKsI,MAAMsD,QAAO,SAAC5F,GAAD,aAAU,UAAAA,EAAKE,gBAAL,eAAepG,MAAf,qBAAoCP,EAAKO,OAExF,OAAK6L,EAAWzC,OAKd,qCACE,iRAKA,cAACsC,GAAA,EAAD,UACGG,EAAW1B,KAAI,SAACjE,GAAD,OACd,cAAC,GAAD,CAAoBA,KAAMA,GAAfA,EAAKlG,YAZf,sFCpCX,IAAMwC,GAAS,mIAQT0F,GAAM,6MAgBN6D,GAAU,4CACVC,GAAY,4CAEZ/F,GAAY,SAAC5H,GACjB,IAAKA,EACH,MAAO,SAET,IAAM4N,EAAe5N,EAAK6N,QAAQzD,MAAK,SAAC0D,GAAD,OAAeA,EAAEC,SACxD,OAAKH,EAGEA,EAAatC,QAFX,KAgCI0C,GA3BE,WAAO,IACdhO,EAASqC,IAATrC,KAIR,OACE,eAAC,GAAD,WACE,eAAC,GAAD,WACE,4CACA,wCACQ,sDAER,yCACA,6BAAK4H,GAAU5H,QAEjB,eAAC0N,GAAD,WACE,sDACA,cAAC,GAAD,OAEF,eAACC,GAAD,WACE,+CACA,cAAC,GAAD,W,mGC1DR,IAAMM,GAAiB,UAEjBC,GAAa,uFAGG,qBAAGC,MAAqBF,GAAiB,gBAH5C,2HAWKA,GAXL,mBAebtE,GAAK,oFAKL0D,GAAI,4GA0CKe,GAhCF,SAAC,GAAqB,IAAD,EAAlBpE,EAAkB,EAAlBA,KAAkB,EACR7I,oBAAS,GADD,mBACzBgH,EADyB,KACnBc,EADmB,KAWhC,OACE,qCACE,eAACiF,GAAD,CAAeC,MAAOhG,EAAMW,QAVZ,WAClBG,GAAQ,IASN,UACE,eAAC,GAAD,WACE,mCACGrC,GAAWoD,EAAKpE,OADnB,SAC4BgB,GAAWoD,EAAKlE,QAE5C,uBACA,+BAAOkE,EAAK3B,WAEd,cAAC,GAAD,oBACG2B,EAAKG,aADR,aACG,EAAY2B,KAAI,SAACjE,GAAD,OACf,cAAC,GAAD,CAA0BA,KAAMA,GAAfA,EAAKlG,YAI5B,cAACsL,GAAD,CAAYhD,KAAM9B,EAAM6B,KAAMA,EAAM5B,YApBpB,WAClBa,GAAQ,U,oBCvCZ,IAAM9E,GAAS,oDACF,kBAA0B,SAA1B,EAAGkK,MAAgC,GAAM,IADvC,4DAIO,kBAA0B,YAA1B,EAAGA,MAAmC,UAAY,SAJzD,KAMT1E,GAAK,wGAIL0D,GAAI,mGAuBKiB,GAbK,SAAC,GAAoB,IZpBTrI,EYoBTsI,EAAiB,EAAjBA,IACrB,OACE,eAAC,GAAD,CAAWF,MAAOG,aAAQD,EAAI3I,OAAS,UAAY6I,aAAOF,EAAI3I,OAAS,OAAS,SAAhF,UACE,cAAC,GAAD,WZvB0BK,EYuBFsI,EAAI3I,MZvB+BU,GAAeL,EAAM,iBYwBhF,cAAC,GAAD,UACGsI,EAAIG,MAAM5C,KAAI,SAAC9B,GAAD,OACb,cAAC,GAAD,CAAMA,KAAMA,GAAWA,EAAKrI,aASzBgN,GAAiB,kBAAM,cAAC,GAAD,CAAWN,MAAM,UCrCrD,IAAMlK,GAAS,6GAKTyK,GAAO,6IAsDEC,GAvCE,SAAC,GAAiC,IAA/BjJ,EAA8B,EAA9BA,MAAOE,EAAuB,EAAvBA,IAAKgJ,EAAkB,EAAlBA,KAC9B,IAAKA,EACH,OAAO,KAGT,IAAMC,EAAiBC,aAAmB,CAAEpJ,QAAOE,OAAO,CAAEmJ,aAAc,IAAKnD,KAAI,SAAC7F,GAAD,MAAW,CAC5FL,MAAOK,EACPiJ,KAAM,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAGpD,KAAI,SAACqD,GAAD,MAAQ,CAAEvJ,MAAO2H,aAAQtH,EAAMkJ,GAAIT,MAAO,WAmB5E,OAhBAI,EAAKM,SAAQ,SAACC,GACZ,IAAMpJ,EAAO,IAAIT,KAAK6J,EAAK5C,OACrB6C,EAAYC,aAAkBtJ,EAAM8I,EAAM,GAAGnJ,OAC7C4J,EAAOT,EAAMO,GACbf,GAAOkB,aAAOxJ,IAAS,GAAK,EAC5BkE,EAAQkF,EAAKlF,MAAMuF,QAAQC,MAAK,SAACC,EAAMC,GAAP,OAAkBD,EAAKrI,KAAK5F,GAAKkO,EAAMtI,KAAK5F,GAAK,GAAK,KAE5F6N,EAAKN,KAAKX,GAAKG,MAAMoB,KAAK,CACxBnO,GAAI0N,EAAK1N,GACT0G,MAAOgH,EAAK7C,MACZ5G,MAAOK,EACPH,IAAK,IAAIN,KAAK6J,EAAK3C,KACnBvC,aAKF,cAAC,GAAD,UACG4E,EAAMjD,KAAI,SAAC0D,EAAMO,GAAP,OACT,cAACnB,GAAD,UACGY,EAAKN,KAAKpD,KAAI,SAACyC,EAAKY,GAAN,OACbZ,EAAI3I,OAASA,GAAS2I,EAAI3I,MAAQE,EAAM,cAAC,GAAD,CAAayI,IAAKA,GAAUY,GAAQ,cAAC,GAAD,GAAqBA,OAFvFY,SCxCtB,IAAMC,GAAO,8JAOPC,GAAO,qLAQPC,GAAY,+FAIZC,GAAG,oKAQHxG,GAAK,mJAQLyG,GAAU,qGAiHDC,GA5GM,WAAO,Id5CIpK,Ec4CL,EfZlB3D,qBAAW+C,IeaVW,EADiB,EACjBA,OAAQG,EADS,EACTA,UAAWE,EADF,EACEA,QAAST,EADX,EACWA,MAAOE,EADlB,EACkBA,IACrCwK,EAAQC,eACRC,EAAUC,aAAcH,EAAMI,YAAYC,GAAG,OAC7CC,EAAkBJ,EAAU,mBAAgB,GAC5CK,EAAmBL,EAAU,kBAAc,GAC3CM,EAAkBN,EAAU,UAAY,GANrB,EAQQrD,mBAAiBlO,EAAU,CAC1DyC,UAAW,CAAE+I,MAAO7E,EAAO+E,OAAQ7E,KAD7BjE,EARiB,EAQjBA,KAAM4B,EARW,EAQXA,QAASL,EARE,EAQFA,MAIvB,OAAIA,EAEA,eAAC,GAAD,WACE,+BACE,8DADF,oCAGA,4BAAIA,EAAMG,aAMd,qCACE,cAAC4M,GAAD,UACE,eAACY,GAAA,EAAD,CAAMC,WAAS,EAAf,UACE,cAACD,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAvB,SACE,cAAC,GAAD,WdxEoBlL,EcwEIL,EdxE6BU,GAAeL,EAAM,kBc0E5E,cAAC8K,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAvB,SACE,eAACf,GAAD,WACE,cAACxL,EAAA,EAAD,CACEG,SAAUtB,EACViB,QAAQ,YACRI,MAAM,UACNsM,UAAW,cAACC,GAAA,EAAD,IACXvI,QAAS9C,EALX,SAOG6K,IAEH,cAACjM,EAAA,EAAD,CACEG,SAAUtB,GAAW6N,aAAY1L,EAAO,IAAIJ,MAC5Cd,QAAQ,YACRI,MAAM,UACNsM,UAAW,cAACG,GAAA,EAAD,IACXzI,QAASzC,EALX,SAOGuK,IAEH,cAAChM,EAAA,EAAD,CACEG,SAAUtB,EACViB,QAAQ,YACRI,MAAM,UACN0M,QAAS,cAACC,GAAA,EAAD,IACT3I,QAAS3C,EALX,SAOG2K,cAMVrN,EACC,cAACuM,GAAD,UACE,cAAC7D,GAAA,EAAD,MAGF,cAAC,GAAD,CAAUvG,MAAOA,EAAOE,IAAKA,EAAKgJ,KAAI,OAAEjN,QAAF,IAAEA,OAAF,EAAEA,EAAM6P,WAEhD,eAACzB,GAAD,WACE,cAACC,GAAD,yBACA,eAACa,GAAA,EAAD,CAAMC,WAAS,EAAf,UACE,eAACD,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,cAClB,qDAEF,eAACqJ,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,gBAClB,gEAEF,eAACqJ,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,aAClB,wDAGJ,uBACA,eAACqJ,GAAA,EAAD,CAAMC,WAAS,EAAf,UACE,eAACD,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,YAAYC,MAAM,KAApC,kBAGA,+CAEF,eAACoJ,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,YAAlB,gBACA,mDAEF,eAACqJ,GAAA,EAAD,CAAME,MAAI,EAACC,GAAI,EAAf,UACE,cAACzJ,GAAD,CAAUC,QAAQ,YAAlB,gBACA,2D,8BChJZ,IAAMsI,GAAO,uIAMP7L,GAAS,6KAiHAwN,GApGK,WAAO,IAAD,EAChB3R,EAASqC,IAATrC,KADgB,EAEImB,oBAAS,GAFb,mBAEjByQ,EAFiB,KAETC,EAFS,KAGhBxI,EAAeG,KAAfH,WAHgB,EAIIlI,mBAAS,CACnC8C,OAAW,OAAJjE,QAAI,IAAJA,OAAA,EAAAA,EAAMiE,QAAS,GACtBiI,WAAe,OAAJlM,QAAI,IAAJA,OAAA,EAAAA,EAAMkM,YAAa,KANR,mBAIjB4F,EAJiB,KAITC,EAJS,KASxBxQ,qBAAU,WACJvB,GACF+R,EAAU,CACR9N,MAAOjE,EAAKiE,MACZiI,UAAWlM,EAAKkM,cAGnB,CAAClM,IAEJ,IAAMgS,EAAoB,SAAC,GAAqD,IAAnDC,EAAkD,EAAlDA,OACnB1N,EAAgB0N,EAAhB1N,KAAMxC,EAAUkQ,EAAVlQ,MACdgQ,EAAU,2BACLD,GADI,mBAENvN,EAAOxC,MAINmQ,EAAU,uCAAG,WAAOtO,GAAP,SAAAlB,EAAA,6DACjBkB,EAAMC,iBACNgO,GAAU,GAFO,kBAITrQ,EAAOiK,OAAO,CAClBC,SAAUvM,EACVuC,UAAU,2BAAMoQ,GAAP,IAAeK,OAAM,OAAEnS,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,OANzB,OAQf0H,EAAW,uDARI,gDAUflG,EAAY,EAAD,IAVI,QAYjB0O,GAAU,GAZO,yDAAH,sDAehB,IAAK7R,EACH,OACE,cAAC,GAAD,UACE,cAACmM,GAAA,EAAD,MAKN,IAAMnJ,EAAM,UAAGhD,EAAK6N,QAAQzD,MAAK,SAAC0D,GAAD,OAAeA,EAAEC,gBAAtC,aAAG,EAA2CzC,QAAQ8G,cAC5DhH,EAAQpL,EAAKqL,cAAcS,KAAI,SAACuG,GAAD,OAAOA,EAAE/G,WAASgH,KAAK,MAE5D,OACE,cAAC,GAAD,UACE,uBAAMlO,SAAU8N,EAAhB,UACE,+BACGlS,EAAK+L,OADR,IACiB/L,EAAKgM,OAEtB,yCAAYhJ,GAAU,mBACtB,+DAA6BoI,GAAS,oBACtC,cAAC/G,EAAA,EAAD,CACEE,KAAK,YACLC,MAAM,kBACN+N,UAAQ,EACRxN,UAAW/E,EACX+B,MAAO+P,EAAO5F,UACdsG,SAAUR,EACVvN,WAAS,EACTgO,WAAY,CACVC,eACE,cAACC,GAAA,EAAD,CAAgBC,SAAS,QAAzB,SACE,cAACC,GAAA,EAAD,SAKR,cAACxO,EAAA,EAAD,CACEE,KAAK,QACLC,MAAM,iBACN+N,UAAQ,EACRxN,UAAW/E,EACX+B,MAAO+P,EAAO7N,MACduO,SAAUR,EACVvN,WAAS,EACTgO,WAAY,CACVC,eACE,cAACC,GAAA,EAAD,CAAgBC,SAAS,QAAzB,SACE,cAACE,GAAA,EAAD,SAKR,cAAClO,EAAA,EAAD,CAAQE,MAAM,UAAUJ,QAAQ,YAAYK,SAAU6M,EAAQtN,KAAK,SAAnE,+B,qMCnHOyO,GAPO,SAAC,GAAuE,IAArE9G,EAAoE,EAApEA,KAAS+G,EAA2D,yBAC3F,cAAI/G,QAAJ,IAAIA,OAAJ,EAAIA,EAAMgH,WAAW,MACZ,cAAC,IAAD,aAAM7N,GAAI6G,GAAU+G,IAEtB,+BAAG/G,KAAMA,GAAU+G,KC4BtBE,GAAe,IAEfC,GAASC,aAAOC,KAAPD,CAAY,CACzBE,SAAU,IAGNC,GAAYC,cAAW,SAAClD,GAAD,OAC3BmD,aAAa,CACXC,KAAM,CACJC,QAAS,QAEXC,OAAQ,CACNC,OAAQvD,EAAMuD,OAAOC,OAAS,EAC9BC,WAAYzD,EAAM0D,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQ5D,EAAM0D,YAAYE,OAAOC,MACjCC,SAAU9D,EAAM0D,YAAYI,SAASC,iBAGzCC,YAAa,CACXC,WAAYrB,GACZsB,MAAM,eAAD,OAAiBtB,GAAjB,OACLa,WAAYzD,EAAM0D,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQ5D,EAAM0D,YAAYE,OAAOC,MACjCC,SAAU9D,EAAM0D,YAAYI,SAASK,kBAGzCC,WAAY,CACVC,YAAa,IAEfC,KAAM,CACJjB,QAAS,QAEXG,OAAQ,CACNU,MAAOtB,GACP2B,WAAY,EACZC,WAAY,UAEdC,WAAY,CACVP,MAAOtB,GACPa,WAAYzD,EAAM0D,YAAYC,OAAO,QAAS,CAC5CC,OAAQ5D,EAAM0D,YAAYE,OAAOC,MACjCC,SAAU9D,EAAM0D,YAAYI,SAASK,kBAGzCO,YAAY,cACVjB,WAAYzD,EAAM0D,YAAYC,OAAO,QAAS,CAC5CC,OAAQ5D,EAAM0D,YAAYE,OAAOC,MACjCC,SAAU9D,EAAM0D,YAAYI,SAASC,gBAEvCY,UAAW,SACXT,MAAOlE,EAAM4E,QAAQ,GAAK,GACzB5E,EAAMI,YAAYC,GAAG,MAAQ,CAC5B6D,MAAOlE,EAAM4E,QAAQ,GAAK,IAG9BC,QAAQ,aACNxB,QAAS,OACTyB,WAAY,SACZC,eAAgB,WAChBC,QAAShF,EAAM4E,QAAQ,EAAG,IAEvB5E,EAAMiF,OAAOJ,SAElBK,QAAS,CACPlC,SAAU,EACVgC,QAAShF,EAAM4E,QAAQ,IAEzBO,SAAU,CACRC,eAAgB,OAChB5Q,MAAO,cAKP6Q,GAAQ,CACZ,CAAEtN,MAAO,UAAW4D,KAAM,QAAS2J,KAAMC,MACzC,CAAExN,MAAO,WAAY4D,KAAM,YAAa2J,KAAME,MAC9C,CAAEzN,MAAO,aAAW4D,KAAM,WAAY2J,KAAMG,MAC5C,CACE1N,MAAO,6BACP4D,KAAM,QACN2J,KAAMI,MAER,CAAE3N,MAAO,aAAc4D,KAAM,WAAY2J,KAAMK,MAC/C,CAAE5N,MAAO,gBAAiB4D,KAAM,yDAA0D2J,KAAMM,OA+FnFC,GA5FF,WAAO,IAAD,IACXC,EAAU7C,KADC,EAEQlR,IAAjBrC,EAFS,EAETA,KAAMmC,EAFG,EAEHA,OACRmO,EAAQC,eAHG,EAIOpP,oBAAS,GAJhB,mBAIVgH,EAJU,KAIJc,EAJI,KAejB,OAVgBwH,aAAcH,EAAMI,YAAYC,GAAG,OAejD,sBAAK0F,UAAWD,EAAQ1C,KAAxB,UACE,cAAC4C,GAAA,EAAD,CACE1D,SAAS,QACTyD,UAAWE,aAAKH,EAAQxC,OAAT,gBACZwC,EAAQ9B,YAAcnM,IAH3B,SAME,eAACqO,GAAA,EAAD,WACE,cAAC9M,GAAA,EAAD,CACE5E,MAAM,UACN2R,aAAW,cACX3N,QAxBe,WACvBG,GAAQ,IAwBAyN,KAAK,QACLL,UAAWE,aAAKH,EAAQ1B,WAAT,gBACZ0B,EAAQxB,KAAOzM,IANpB,SASE,cAAC,KAAD,MAEF,cAACwO,GAAA,EAAD,CAAYjS,QAAQ,KAAKkS,QAAM,EAA/B,sBAGA,cAACzD,GAAD,IACA,cAACvO,EAAA,EAAD,CAAQkE,QAAS3G,EAAQ2C,MAAM,UAA/B,iCAKJ,cAAC0R,GAAA,EAAD,IACA,eAACK,GAAA,EAAD,CACEnS,QAAQ,YACR2R,UAAWE,aAAKH,EAAQtC,QAAT,oBACZsC,EAAQrB,WAAa5M,GADT,eAEZiO,EAAQpB,aAAe7M,GAFX,IAIfiO,QAAS,CACPU,MAAOP,cAAI,oBACRH,EAAQrB,WAAa5M,GADb,eAERiO,EAAQpB,aAAe7M,GAFf,KAPf,UAaE,qBAAKkO,UAAWD,EAAQjB,QAAxB,SACE,cAACzL,GAAA,EAAD,CAAYZ,QApDM,WACxBG,GAAQ,IAmDF,SACuB,QAApBqH,EAAMyG,UAAsB,cAACC,GAAA,EAAD,IAAuB,cAACC,GAAA,EAAD,QAGxD,cAACC,GAAA,EAAD,IACA,eAACvK,GAAA,EAAD,CAAUC,QAAM,EAAhB,UACE,cAACuK,GAAA,EAAD,UACE,cAACC,GAAA,EAAD,MAEDpX,GAAQ,cAAC8M,GAAA,EAAD,CAAcC,QAAO,UAAK/M,EAAK+L,OAAV,YAAoB/L,EAAKgM,UAEzD,cAACkL,GAAA,EAAD,IACA,cAAC7J,GAAA,EAAD,UACGsI,GAAM7J,KAAI,gBAAGG,EAAH,EAAGA,KAAM5D,EAAT,EAASA,MAAOuN,EAAhB,EAAgBA,KAAhB,OACT,cAACyB,GAAD,CAAMhB,UAAWD,EAAQX,SAAUxJ,KAAMA,EAAzC,SACE,eAACU,GAAA,EAAD,CAAUC,QAAM,EAAhB,UACE,cAACuK,GAAA,EAAD,UACE,cAACvB,EAAD,MAEF,cAAC9I,GAAA,EAAD,CAAcC,QAAS1E,QALyB4D,cA7DrD,M,8BCjHLsH,GAAYC,cAAW,SAAClD,GAAD,OAC3BmD,aAAa,CACXG,OAAQ,CACN0D,IAAK,OACLC,OAAQ,GAEVpC,QAAS,CACPE,eAAgB,iBAElB7Q,MAAO,CAELgT,cAAe,UAEjBC,KAAM,CACJ,OAAQ,CACNC,WAAY,eACZC,cAAe,iBAGnBC,mBAAoB,CAClBlC,eAAgB,QAElBmC,SAAU,CACR/S,MAAO,QACPgT,gBAAiBxH,EAAMyH,QAAQhL,QAAQiL,KACvC,UAAW,CACTC,WAAY3H,EAAMyH,QAAQhL,QAAQmL,OAGtCC,KAAM,CACJ9C,eAAgB,eAKhB+C,GAAa,CACjB,CAAE/P,MAAO,WAAY4D,KAAM,YAAa2J,KAAME,MAC9C,CAAEzN,MAAO,aAAW4D,KAAM,WAAY2J,KAAMG,MAC5C,CAAE1N,MAAO,OAAQ4D,KAAM,QAAS2J,KAAMI,OAElCqC,GAAc,CAElB,CAAEhQ,MAAO,aAAc4D,KAAM,WAAY2J,KAAMK,MAC/C,CAAE5N,MAAO,gBAAiB4D,KAAM,UAAW2J,KAAMM,OAGpC,SAASoC,KACtB,IAAMlC,EAAU7C,KADqB,EAELpS,mBAA6B,MAFxB,mBAE9BoX,EAF8B,KAEpBC,EAFoB,KAG/BlI,EAAQC,eACRC,EAAUC,aAAcH,EAAMI,YAAY+H,KAAK,OAM/CrQ,EAAc,WAClBoQ,EAAY,OAGd,OAAKhI,EAKH,cAAC,WAAD,UACE,cAAC8F,GAAA,EAAD,CAAQ1D,SAAS,QAAQ9N,MAAM,UAAUuR,UAAWD,EAAQxC,OAA5D,SACE,eAAC4C,GAAA,EAAD,CAASH,UAAWD,EAAQjB,QAA5B,UACGiD,GAAWtM,KAAI,gBAAGG,EAAH,EAAGA,KAAM5D,EAAT,EAASA,MAAOuN,EAAhB,EAAgBA,KAAhB,OACd,cAAC,IAAD,CAAMS,UAAWD,EAAQwB,mBAAoBxS,GAAI6G,EAAjD,SACE,eAACU,GAAA,EAAD,CAAUC,QAAM,EAACyJ,UAAWD,EAAQ5R,MAApC,UACE,cAAC2S,GAAA,EAAD,CAAcd,UAAWD,EAAQ+B,KAAjC,SACE,cAACvC,EAAD,MAEF,cAAC9I,GAAA,EAAD,CAAcuJ,UAAWD,EAAQyB,SAAU9K,QAAS1E,QALIA,MAS9D,cAAC,KAAD,CACE1G,GAAG,cACH0U,UAAWD,EAAQqB,KACnBc,SAAUA,EACVG,aAAW,EACXvQ,KAAMwQ,QAAQJ,GACdhQ,QAASH,EANX,SAQGiQ,GAAYvM,KAAI,SAACmF,GAAD,OACf,cAAC,IAAD,CAAMoF,UAAWD,EAAQwB,mBAAoBxS,GAAI6L,EAAKhF,KAAtD,SACE,cAAC2M,GAAA,EAAD,CAAUvC,UAAWD,EAAQyB,SAAU/O,QAASV,EAAhD,SACG6I,EAAK5I,SAFuD4I,EAAK5I,YAO1E,cAACqB,GAAA,EAAD,CAAYmP,gBAAc,cAAcC,gBAAc,OAAOhQ,QA1CjD,SAAClF,GACnB4U,EAAY5U,EAAMG,gBAyCuE2S,KAAK,MAAM5R,MAAM,UAApG,SACE,cAAC,KAAD,aAlCD,K,4CCrEX,IAAMkL,GAAO,wIAMP+I,GAAW,6IAQXC,GAAK,uFA0LIC,GAnLK,WAAO,IACjBjZ,EAASqC,IAATrC,KADgB,EAEImB,oBAAS,GAFb,mBAEjByQ,EAFiB,KAETC,EAFS,KAGhBxI,EAAeG,KAAfH,WAHgB,EAIclI,mBAAiB,IAJ/B,mBAIjB+X,EAJiB,KAIJC,EAJI,OAKEhY,mBAAmB,IALrB,mBAKjBuN,EALiB,KAKV0K,EALU,OAOyDjM,mBAC/E5N,GADY8Z,EAPU,EAOhBxX,KAAiCyX,EAPjB,EAOQ7V,QAA2B8V,EAPnC,EAO4BnW,MAP5B,EAUoD+J,mBAAmB7N,EAAc,CAC3Gka,MAAOxZ,EACP0B,UAAW,CAAEyQ,OAAM,OAAEnS,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,MAFf8X,EAVU,EAUhB5X,KAAiC6X,EAVjB,EAUQjW,QAA2BkW,EAVnC,EAU4BvW,MAI9CK,EAAU6V,GAAaI,EAS7B,GAPAnY,qBAAU,WACJkY,IAAoC,OAAhBA,QAAgB,IAAhBA,OAAA,EAAAA,EAAkBG,SAAS7O,QAAS,IAC1DoO,EAAeM,EAAiBG,SAAS,GAAGC,cAC5CT,EAASK,EAAiBG,SAAS,GAAGE,kBAAkBhO,KAAI,SAACiO,GAAD,OAAQA,EAAGpY,UAExE,CAAC8X,IAEAF,GAAqBI,EACvB,OACE,eAAC,GAAD,WACE,+BACE,8DADF,oCAGA,mCAAIJ,QAAJ,IAAIA,OAAJ,EAAIA,EAAmBhW,UACvB,mCAAIoW,QAAJ,IAAIA,OAAJ,EAAIA,EAAcpW,aAKxB,IAAMyW,EAAuB,GAE7B,GAAIX,EACF,IADqB,IAAD,WACX9K,GACS,OAAhB8K,QAAgB,IAAhBA,KAAkBS,kBACfrM,QAAO,gBAAGwM,EAAH,EAAGA,KAAMlM,EAAT,EAASA,MAAT,OAAqBkM,IAAS1L,GAAOR,KAC5CqB,SAAQ,SAACpF,GACR,IAAMkQ,EAAeF,EAAS5P,MAAK,SAAC0D,GAAD,OAAOA,EAAES,MAAQA,KAC9C4L,EAAY,IAAI3U,KAAKwE,EAAKoQ,YAAY9P,UAC5C,GAAI4P,EAAc,CAChB,IAAMG,EAAmBH,EAAaxL,MAAMtE,MAAK,qBAAGkQ,OAAoBH,KACpEE,EACFA,EAAiBE,WAAWzK,KAAK9F,EAAKrI,IAEtCuY,EAAaxL,MAAMoB,KAAK,CACtBwK,KAAMH,EACNK,cAAexQ,EACfuQ,WAAY,CAACvQ,EAAKrI,WAItBqY,EAASlK,KAAK,CACZvB,IAAKA,EACLG,MAAO,CACL,CACE4L,KAAMH,EACNK,cAAexQ,EACfuQ,WAAY,CAACvQ,EAAKrI,YAxBvB4M,EAAM,EAAGA,EAAM,EAAGA,IAAQ,EAA1BA,GAiCX,IAIMkM,EAAW,SAACC,GAChB,IAAI5L,EAAiB,GAOrB,OANAkL,EAAS5K,SAAQ,SAACpF,GAChB,IAAM2Q,EAAW3Q,EAAK0E,MAAMtE,MAAK,SAACwQ,GAAD,OAAeA,EAAUJ,cAAc7Y,KAAO+Y,KAC3EC,IACF7L,EAAO6L,EAASJ,eAGbzL,GAgBHoD,EAAU,uCAAG,4BAAAxP,EAAA,6DACjBmP,GAAU,GAEJnQ,EAAiC,CACrC1B,KAAI,OAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAM2B,GACZkY,aAAcX,EACd2B,iBAAkBnM,IAEpB,OAAI+K,QAAJ,IAAIA,OAAJ,EAAIA,EAAkBG,SAAS7O,UAC7BrJ,EAAUC,GAAK8X,EAAiBG,SAAS,GAAGjY,IAT7B,kBAaTH,EAAOiK,OAAO,CAClBC,SAAUhK,EAAUC,GAAKtC,EAAiBD,EAC1CsC,cAfa,OAkBf2H,GACG3H,EAAUC,GACP,wEACA,2DAAiD,YArBxC,gDAwBfwB,EAAY,EAAD,IAxBI,QA2BjB0O,GAAU,GA3BO,yDAAH,qDA8BhB,OACE,qCACE,4CACCpO,EACC,cAAC,GAAD,UACE,cAAC0I,GAAA,EAAD,MAGF,qCACE,cAAC4M,GAAD,UACGiB,EAASlO,KAAI,SAACgP,GAAD,OACZ,eAACC,GAAA,EAAD,YnB/JehL,EmBgKC+K,EAAQvM,InBhKS1H,GAASkJ,ImBiKvC+K,EAAQpM,MAAM5C,KAAI,gBAAG0O,EAAH,EAAGA,cAAH,OACjB,cAACQ,GAAA,EAAD,CAEEC,QACE,cAACC,GAAA,EAAD,CACEpW,MAAM,UACNqW,QAASzM,EAAM0M,SAASZ,EAAc7Y,IACtC6Q,SAAU,YAAiB,IAAdP,EAAa,EAAbA,QA/DN,SAACyI,EAA4BS,GACxD,IAAME,EAAO3M,EAAMgB,QACfyL,GACFE,EAAKvL,KAAL,MAAAuL,EAAI,aAASZ,EAASC,KACtBtB,EAASiC,KAETZ,EAASC,GAAoBtL,SAAQ,SAACpF,GACpCqR,EAAKC,OAAOD,EAAKE,QAAQvR,GAAO,MAElCoP,EAASiC,IAuDWG,CAAqBhB,EAAc7Y,GAAIsQ,EAAOkJ,YAIpD3W,MAAK,UAAKoC,GAAW4T,EAAcJ,YAA9B,cAA+CxT,GAAW4T,EAAciB,YAVxEjB,EAAc7Y,SAJTmZ,EAAQvM,KnB/JV,IAACwB,OmBmLnB,cAACiJ,GAAD,UACE,cAAC3U,EAAA,EAAD,CACEqX,WAAS,EACT3W,SAAUtB,EACVe,MAAM,8CACNzC,MAAOmX,EACP1G,SA/Fa,SAAC,GAA+C,IAA7CP,EAA4C,EAA5CA,OAC1BkH,EAAelH,EAAOlQ,QA+FZ0C,WAAS,MAGb,cAACG,EAAA,EAAD,CAAQG,SAAU6M,EAAQ9M,MAAM,UAAUJ,QAAQ,YAAYoE,QAASoJ,EAAvE,oCCnMJyJ,GAAUvI,aAAOjP,IAAPiP,EAAkB,gBAAG9C,EAAH,EAAGA,MAAH,qBAChCsL,UAAWtL,EAAM4E,QAAQ,GACzB2G,YAAavL,EAAM4E,QAAQ,IAC1B5E,EAAMI,YAAYC,GAAG,MAAQ,CAC5BkL,YAAavL,EAAM4E,QAAQ,SAoChB4G,GAhCO,WAAO,IAEnBC,EzBTe,SAACC,GACxB,IAAMC,EAAiC,GAYvC,OAXAD,EACGE,OAAO,GACPC,MAAM,KACN/M,SAAQ,SAACgN,GACR,GAAIA,EAAM,CACR,IAAMC,EAAQD,EAAKD,MAAM,KACJ,IAAjBE,EAAMtR,SACRkR,EAAOI,EAAM,IAAMC,mBAAmBD,EAAM,SAI7CJ,EyBJUM,CADErX,cAAX8W,QACAD,KAER,OACE,eAAC,GAAD,WACE,cAAC,GAAD,IACA,eAACJ,GAAD,WACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOnZ,KAAK,QAAZ,SACE,cAACga,GAAD,MAEF,cAAC,IAAD,CAAOha,KAAK,YAAZ,SACE,cAACia,GAAD,MAEF,cAAC,IAAD,CAAOja,KAAK,WAAZ,SACE,cAACka,GAAD,MAEF,cAAC,IAAD,CAAOla,KAAK,WAAZ,SACE,cAACma,GAAD,MAEF,cAAC,IAAD,CAAOna,KAAK,WAAZ,SACE,cAACka,GAAD,MAEF,cAAC,IAAD,CAAUtX,GAAI2W,GAAQ,aAExB,cAAC,GAAD,W,oBCpCFzL,GAAQsM,aAAe,CAC3B7E,QAAS,CACPhL,QAAS,CAEPiL,KAAM,WAMR6E,kBAAmB,EAInBC,YAAa,MAgBFC,GAZH,WAAO,IACT3b,EAASiB,IAATjB,KAER,OACE,cAAC4b,GAAA,EAAD,CAAe1M,MAAOA,GAAtB,SACE,cAAC,IAAD,UACE,cAAC,GAAD,UAAiBlP,EAAO,cAAC,GAAD,IAAoB,cAAC,GAAD,WCzBpD6b,IAASC,OACP,eAAC,IAAMC,WAAP,WACE,cAACC,EAAA,EAAD,IACA,cAAC,iBAAD,CAAgBhd,OAAQoB,EAAxB,SACE,cAAC,EAAD,UACE,cAAC,GAAD,WAIN6b,SAASC,eAAe,W","file":"static/js/main.130910c7.chunk.js","sourcesContent":["import { gql } from \"@apollo/client\"\n\nexport const LOGGED_IN_USER = gql`\n  query LOGGED_IN_USER($id: ID!) {\n    user(id: $id) {\n      id\n      username\n      rolesChouette {\n        id\n        roleUniqueId\n        libelle\n      }\n      nom\n      prenom\n      email\n      telephone\n      actif\n      statuts {\n        id\n        libelle\n        actif\n        dateDebut\n        dateFin\n      }\n    }\n  }\n`\n\nexport const SLOTS = gql`\n  query SLOTS($id: ID!) {\n    creneau(id: $id) {\n      titre\n      debut\n      fin\n      piafs {\n        id\n        statut\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          prenom\n          nom\n        }\n      }\n    }\n  }\n`\n\nexport const PIAFS = gql`\n  query PIAFS($idPiaffeur: String, $after: String, $before: String, $statut: String) {\n    piafs(piaffeur: $idPiaffeur, creneau_debut: { after: $after, before: $before }, statut: $statut) {\n      id\n      statut\n      creneau {\n        id\n        debut\n        fin\n      }\n      piaffeur {\n        id\n        prenom\n        nom\n        username\n      }\n      role {\n        id\n        roleUniqueId\n        libelle\n      }\n    }\n  }\n`\n\nexport const PLANNING = gql`\n  query PLANNING($after: String, $before: String) {\n    creneaus(debut: { after: $after, before: $before }) {\n      id\n      debut\n      fin\n      titre\n      piafs {\n        id\n        statut\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          nom\n          prenom\n          email\n          telephone\n        }\n      }\n    }\n  }\n`\n\nexport const REGISTRATION_UPDATE = gql`\n  mutation REGISTRATION_UPDATE($idPiaf: ID!, $idPiaffeur: String!, $statut: String!) {\n    updatePiaf(input: { id: $idPiaf, piaffeur: $idPiaffeur, statut: $statut }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        statut\n      }\n    }\n  }\n`\n\nexport const USER_UPDATE = gql`\n  mutation USER_UPDATE($idUser: ID!, $email: String, $telephone: String) {\n    updateUser(input: { id: $idUser, email: $email, telephone: $telephone }) {\n      user {\n        id\n        username\n        email\n        telephone\n      }\n    }\n  }\n`\n\nexport const RESERVE_CREATE = gql`\n  mutation RESERVE_CREATE($user: String, $informations: String, $creneauGenerique: [String]) {\n    createReserve(input: { user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n          username\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n`\n\nexport const RESERVE_UPDATE = gql`\n  mutation RESERVE_UPDATE($id: ID!, $user: String, $informations: String, $creneauGenerique: [String]) {\n    updateReserve(input: { id: $id, user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n          username\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n`\n\nexport const RESERVE_USER = gql`\n  query RESERVE_USER($idUser: String) {\n    reserves(user: $idUser) {\n      id\n      informations\n      creneauGeneriques {\n        id\n      }\n    }\n  }\n`\n\nexport const CRENEAUX_GENERIQUES = gql`\n  query CRENEAUX_GENERIQUES {\n    creneauGeneriques {\n      id\n      heureDebut\n      heureFin\n      titre\n      jour\n      actif\n      postes {\n        id\n        role {\n          libelle\n        }\n      }\n    }\n  }\n`\n","import { ApolloClient, createHttpLink, InMemoryCache } from \"@apollo/client\"\nimport { setContext } from \"@apollo/client/link/context\"\n\nimport { getStoredUser } from \"src/providers/user\"\n\nconst link = createHttpLink({\n  uri: `${process.env.REACT_APP_API}/api/graphql`,\n})\n\nconst authLink = setContext((_, previous) => {\n  const user = getStoredUser()\n  if (!user) {\n    return previous\n  }\n  return {\n    ...previous,\n    headers: {\n      ...previous.headers,\n      \"X-Auth-Token\": user.token,\n    },\n  }\n})\n\nconst client = new ApolloClient({\n  link: authLink.concat(link),\n  cache: new InMemoryCache(),\n})\n\nexport default client\n","import type { User } from \"src/types/model\"\n\nimport { createContext, useContext, useState, FC, useEffect } from \"react\"\n\nimport { LOGGED_IN_USER } from \"src/graphql/queries\"\nimport apollo from \"src/helpers/apollo\"\n\nexport interface Auth {\n  email: string\n  token: string\n  id: number\n}\n\nexport interface IUserContext<IsAuthenticated extends boolean = false> {\n  auth: IsAuthenticated extends true ? Auth : Auth | null\n  user: User | null\n  login: (auth: Auth) => void\n  logout: () => void\n}\n\nconst UserContext = createContext<IUserContext>({} as IUserContext)\n\nconst STORAGE_KEY = \"user\"\n\nexport const getStoredUser = () => {\n  const stored = localStorage.getItem(STORAGE_KEY)\n  if (!stored) {\n    return null\n  }\n  return JSON.parse(stored) as Auth\n}\n\nexport const UserProvider: FC = ({ children }) => {\n  const [auth, setAuth] = useState<Auth | null>(getStoredUser)\n  const [user, setUser] = useState<User | null>(null)\n\n  useEffect(() => {\n    if (auth) {\n      apollo\n        .query<{ user: User }>({\n          query: LOGGED_IN_USER,\n          variables: { id: `api/users/${auth.id}` },\n        })\n        .then(({ data }) => {\n          setUser(data.user)\n        })\n    }\n  }, [auth])\n\n  const login = (data: Auth) => {\n    setAuth(data)\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data))\n  }\n\n  const logout = () => {\n    setAuth(null)\n    localStorage.removeItem(STORAGE_KEY)\n  }\n\n  return <UserContext.Provider value={{ auth, user, login, logout }}>{children}</UserContext.Provider>\n}\n\nexport function useUser<IsAuthenticated extends boolean = false>() {\n  return useContext(UserContext) as IUserContext<IsAuthenticated>\n}\n","import HttpError from \"standard-http-error\"\n\nexport const post = async (path: string, body: BodyInit) => {\n  const response = await fetch(`${process.env.REACT_APP_API}/${path}`, {\n    method: \"POST\",\n    body,\n  })\n  if (!response.ok) {\n    throw new HttpError(response.status, response.statusText)\n  }\n  return response.json()\n}\n\nexport const getParams = (search: string) => {\n  const params: Record<string, string> = {}\n  search\n    .substr(1)\n    .split(\"&\")\n    .forEach((part) => {\n      if (part) {\n        const tuple = part.split(\"=\")\n        if (tuple.length === 2) {\n          params[tuple[0]] = decodeURIComponent(tuple[1])\n        }\n      }\n    })\n  return params\n}\n","// TODO: report to tracker and show nicer message\nexport const handleError = (error: Error) => {\n  console.error(error)\n  alert(error.message)\n}\n","import { FormEvent, useState } from \"react\"\nimport { Container, TextField, Button } from \"@material-ui/core\"\n\nimport { useUser, Auth } from \"src/providers/user\"\nimport { post } from \"src/helpers/request\"\nimport { handleError } from \"src/helpers/errors\"\n\nconst LoginPage = () => {\n  const [loading, setLoading] = useState(false)\n  const { login } = useUser()\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    const body = new FormData(event.currentTarget)\n    setLoading(true)\n    try {\n      const data = await post(\"login_api\", body)\n      const auth: Auth = {\n        id: data.userId,\n        email: body.get(\"username\") as string,\n        token: data.token,\n      }\n      login(auth)\n    } catch (error) {\n      handleError(error)\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Container>\n      <form onSubmit={handleSubmit}>\n        <TextField type=\"email\" name=\"username\" label=\"E-mail\" fullWidth variant=\"outlined\" margin=\"normal\" />\n        <TextField type=\"password\" name=\"password\" label=\"Mot de passe\" fullWidth variant=\"outlined\" margin=\"normal\" />\n        <Button type=\"submit\" fullWidth size=\"large\" variant=\"contained\" color=\"primary\" disabled={loading}>\n          Connexion\n        </Button>\n      </form>\n    </Container>\n  )\n}\n\nexport default LoginPage\n","import { Redirect, Route, Switch, useLocation } from \"react-router-dom\"\nimport { Container } from \"@material-ui/core\"\n\nimport LoginPage from \"src/pages/anonymous/Login\"\n\nconst Anonymous = () => {\n  const { pathname } = useLocation()\n\n  return (\n    <Container>\n      <Switch>\n        <Route path=\"/login\">\n          <LoginPage />\n        </Route>\n        <Redirect to={`/login?next=${pathname}`} />\n      </Switch>\n    </Container>\n  )\n}\n\nexport default Anonymous\n","import { createContext, useContext, useState, FC } from \"react\"\nimport { startOfMonth, endOfMonth, subMonths, addMonths } from \"date-fns\"\n\nexport interface IDatePlanningContext {\n  start: Date\n  end: Date\n  goBack: () => void\n  goForward: () => void\n  goToday: () => void\n}\n\nconst DatePlanningContext = createContext<IDatePlanningContext>({} as IDatePlanningContext)\n\nconst getInitialStart = () => startOfMonth(new Date())\nconst getInitialEnd = () => endOfMonth(new Date())\n\nexport const DatePlanningProvider: FC = ({ children }) => {\n  const [start, setStart] = useState<Date>(getInitialStart)\n  const [end, setEnd] = useState<Date>(getInitialEnd)\n\n  const goBack = () => {\n    const date = subMonths(start, 1)\n    setStart(date)\n    setEnd(endOfMonth(date))\n  }\n\n  const goForward = () => {\n    const date = addMonths(start, 1)\n    setStart(date)\n    setEnd(endOfMonth(date))\n  }\n\n  const goToday = () => {\n    setStart(getInitialStart)\n    setEnd(getInitialEnd)\n  }\n\n  return (\n    <DatePlanningContext.Provider value={{ start, end, goBack, goForward, goToday }}>\n      {children}\n    </DatePlanningContext.Provider>\n  )\n}\n\nexport function useDatePlanning() {\n  return useContext(DatePlanningContext) as IDatePlanningContext\n}\n","import { format } from \"date-fns\"\nimport fr from \"date-fns/locale/fr\"\n\nconst formatInFrench = (date: Date | number | string, pattern: string) => {\n  if (typeof date === \"string\") {\n    date = new Date(date)\n  }\n  return format(date, pattern, { locale: fr })\n}\n\nexport const formatDateShort = (date: Date | number | string) => formatInFrench(date, \"EEEE d MMM\")\nexport const formatDateLong = (date: Date | number | string) => formatInFrench(date, \"EEEE d MMMM yyyy\")\n\nexport const formatMonthYear = (date: Date | number | string) => formatInFrench(date, \"MMMM yyyy\")\n\nexport const formatTime = (date: Date | number | string) => formatInFrench(date, \"HH:mm\")\n\nconst WEEKDAYS = [\"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\", \"Dimanche\"]\nexport const getDayOfWeek = (index: number) => WEEKDAYS[index]\n\nexport const queryDate = (date: Date | number) => format(date, \"yyyy-MM-dd\")\n","import styled from \"@emotion/styled/macro\"\n\nconst ErrorMessage = styled.div`\n  color: #e53935;\n`\n\nexport default ErrorMessage\n","import type { PIAF, RoleId } from \"src/types/model\"\nimport type { IStatus } from \"src/types/app\"\n\nimport styled from \"@emotion/styled/macro\"\n\nimport chouettos from \"src/images/chouettos.png\"\n\nconst STATUS_COLORS: Record<IStatus, string> = {\n  available: \"white\",\n  replacement: \"orange\",\n  occupied: \"green\",\n}\n\nconst IMAGES: Partial<Record<RoleId, string>> = {\n  CH: chouettos,\n}\n\nconst getImg = (role?: RoleId) => {\n  if (role) {\n    const img = IMAGES[role]\n    if (img) {\n      return `url(${img})`\n    }\n  }\n}\n\nexport const PiafIcon = styled.span<{ $status: IStatus; $role?: RoleId }>`\n  flex-shrink: 0;\n  display: inline-block;\n  margin: 2px;\n  width: 32px;\n  height: 32px;\n  border: 2px solid ${({ $status }) => STATUS_COLORS[$status]};\n  border-radius: 50%;\n  background-color: #ddd;\n  background-image: ${({ $role }) => getImg($role) || \"none\"};\n  background-position: center;\n  background-size: 24px;\n  background-repeat: no-repeat;\n  line-height: 28px;\n  text-align: center;\n`\n\nexport const getStatus = (piaf: PIAF): IStatus => {\n  if (piaf.statut === \"remplacement\") {\n    return \"replacement\"\n  }\n  if (piaf.piaffeur) {\n    return \"occupied\"\n  }\n  return \"available\"\n}\n\ninterface Props {\n  piaf: PIAF\n}\n\nconst PiafCircle = ({ piaf }: Props) => (\n  <PiafIcon $status={getStatus(piaf)} $role={piaf.role.roleUniqueId}>\n    {getImg(piaf.role.roleUniqueId) ? \"\" : piaf.role.roleUniqueId}\n  </PiafIcon>\n)\n\nexport default PiafCircle\n","export default \"data:image/png;base64,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\"","import React from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogContentText from \"@material-ui/core/DialogContentText\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\n\ninterface Props {\n  open: boolean\n  handleClose: (event: React.MouseEvent<HTMLButtonElement>) => void\n  title: string\n  message: string\n}\n\nconst InfoDialog = ({ open, handleClose, title, message }: Props) => {\n  return (\n    <Dialog\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">{message}</DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\">\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default InfoDialog\n","import { createContext, useContext, useState, FC } from \"react\"\n\nimport InfoDialog from \"src/components/InfoDialog\"\n\ninterface IDialogContext {\n  openDialog: (message: string, title?: string) => void\n  closeDialog: () => void\n}\n\nconst DialogContext = createContext({} as IDialogContext)\n\nexport const DialogProvider: FC = ({ children }) => {\n  const [open, setOpen] = useState(false)\n  const [title, setTitle] = useState(\"\")\n  const [message, setMessage] = useState(\"\")\n\n  const openDialog = (newMessage: string, newTitle = \"\") => {\n    setMessage(newMessage)\n    setTitle(newTitle)\n    setOpen(true)\n  }\n\n  const closeDialog = () => {\n    setOpen(false)\n  }\n\n  return (\n    <DialogContext.Provider value={{ openDialog, closeDialog }}>\n      {children}\n      <InfoDialog open={open} handleClose={closeDialog} title={title} message={message}></InfoDialog>\n    </DialogContext.Provider>\n  )\n}\n\nexport const useDialog = () => useContext(DialogContext)\n","import type { PIAF } from \"src/types/model\"\nimport type { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport { Button, capitalize, Dialog, DialogContent, DialogTitle, IconButton, CircularProgress } from \"@material-ui/core\"\nimport { Close } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\nimport { startOfWeek, endOfWeek, startOfDay, endOfDay } from \"date-fns\"\n\nimport { formatTime, formatDateLong } from \"src/helpers/date\"\nimport { REGISTRATION_UPDATE, PIAFS } from \"src/graphql/queries\"\nimport { useUser } from \"src/providers/user\"\nimport apollo from \"src/helpers/apollo\"\nimport PiafCircle, { getStatus } from \"src/components/PiafCircle\"\nimport { handleError } from \"src/helpers/errors\"\nimport { useDialog } from \"src/providers/dialog\"\n\ntype Result = { piafs: PIAF[] }\n\nconst CloseButton = styled(IconButton)`\n  position: absolute;\n  right: 8px;\n  top: 8px;\n`\nconst Title = styled.div`\n  span {\n    color: gray;\n    margin-left: 5px;\n  }\n`\nconst PiafRow = styled.div`\n  margin: 0 0 16px 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n`\nconst Status = styled.div`\n  flex: 1;\n  margin: 0 8px;\n  span {\n    color: #888;\n  }\n`\nconst Contact = styled.div`\n  text-align: right;\n`\n\ninterface Props {\n  slot: ISlot\n  show: boolean\n  handleClose: (event: React.MouseEvent<HTMLButtonElement>) => void\n}\n\nconst SlotInfo = ({ slot, show, handleClose }: Props) => {\n  const [loading, setLoading] = useState(false)\n  const { openDialog } = useDialog()\n  const { user } = useUser<true>()\n  const piafCurrentUser = slot.piafs?.find(({ piaffeur, statut }) => piaffeur?.id === user?.id && statut === \"occupe\")\n  const hideButtons = slot.start.getTime() < Date.now()\n\n  const getPiafCountByWeek = async () => {\n    const after = startOfWeek(slot.start)\n    const before = endOfWeek(slot.start)\n    try {\n      const result = await apollo.query<Result>({\n        query: PIAFS,\n        variables: { idPiaffeur: user?.id, after: after, before: before },\n      })\n      return result.data.piafs.length\n    } catch (ex) {\n      handleError(ex)\n    }\n    return 0\n  }\n\n  const getPiafCountByDay = async () => {\n    const after = startOfDay(slot.start)\n    const before = endOfDay(slot.start)\n    try {\n      const result = await apollo.query<Result>({\n        query: PIAFS,\n        variables: { idPiaffeur: user?.id, after: after, before: before },\n      })\n      return result.data.piafs.length\n    } catch (ex) {\n      handleError(ex)\n    }\n    return 0\n  }\n\n  const register = async (piaf: PIAF) => {\n    const roles = user?.rolesChouette\n    if (!roles || !roles.find(({ id }) => id === piaf.role.id)) {\n      openDialog(`Pour t’inscrire à cette PIAF tu dois d’abord passer la formation ${piaf.role.libelle}`)\n      return\n    }\n\n    setLoading(true)\n    const piafOfWeek = await getPiafCountByWeek()\n    if (piafOfWeek >= 3) {\n      openDialog(`Il n'est pas possible de s'inscriresur plus de 3 PIAF par semaine`)\n      return\n    }\n    const piafOfDay = await getPiafCountByDay()\n    if (piafOfDay >= 2) {\n      openDialog(`Il n'est pas possible de s'inscrire sur plus de 2 PIAF par jour`)\n      return\n    }\n\n    // If there is a piaf with status \"remplacement\" and the same role,\n    // the user will be register in this piaf by default\n    let idPiaf = piaf.id\n    const piafReplacement = slot.piafs?.find(\n      ({ statut, role }) => statut === \"remplacement\" && role.id === piaf.role.id\n    )\n    if (piafReplacement) {\n      idPiaf = piafReplacement.id\n    }\n\n    try {\n      await apollo.mutate({\n        mutation: REGISTRATION_UPDATE,\n        variables: { idPiaf, idPiaffeur: user?.id, statut: \"occupe\" },\n      })\n\n      openDialog(\"Inscription OK. Merci !\")\n    } catch (error) {\n      handleError(error)\n    }\n\n    setLoading(false)\n  }\n\n  const unregister = async (piaf: PIAF) => {\n    setLoading(true)\n\n    try {\n      await apollo.mutate({\n        mutation: REGISTRATION_UPDATE,\n        variables: { idPiaf: piaf.id, idPiaffeur: user?.id, statut: \"remplacement\" },\n      })\n\n      openDialog(\"Désinscription faite : la PIAF est désormais en recherche de remplacement\")\n    } catch (error) {\n      handleError(error)\n    }\n\n    setLoading(false)\n  }\n\n  return (\n    <Dialog open={show} onClose={handleClose} fullWidth>\n      <CloseButton onClick={handleClose}>\n        <Close />\n      </CloseButton>\n      <DialogTitle>\n        {capitalize(formatDateLong(slot.start))}\n        <br />\n        <Title>\n          <strong>\n            {formatTime(slot.start)}–{formatTime(slot.end)}\n          </strong>\n          <span>{slot.title}</span>\n        </Title>\n      </DialogTitle>\n      <DialogContent>\n        {slot.piafs ? (\n          slot.piafs.map((piaf) => {\n            const { id, role, piaffeur } = piaf\n            const status = getStatus(piaf)\n\n            return (\n              <PiafRow key={id}>\n                <PiafCircle piaf={piaf} />\n                <Status>\n                  {status === \"occupied\" && piaffeur ? `${piaffeur.prenom} ${piaffeur.nom}` : \"Place disponible\"}\n                  <br />\n                  <span>{role.libelle}</span>\n                </Status>\n                {status === \"occupied\" &&\n                  piafCurrentUser &&\n                  piafCurrentUser.role.roleUniqueId === \"GH\" &&\n                  piaffeur &&\n                  piaffeur.id != user?.id && (\n                    //Show info contacts only if the current user is the GH of the slot\n                    <Contact>\n                      <a href={`mailto:${piaffeur.email}`}>{piaffeur.email}</a>\n                      <br />\n                      <a href={`tel:${piaffeur.telephone}`}>{piaffeur.telephone}</a>\n                    </Contact>\n                  )}\n                {status !== \"occupied\" && !piafCurrentUser && !hideButtons && (\n                  <Button disabled={loading} color=\"primary\" variant=\"contained\" onClick={() => register(piaf)}>\n                    S’inscrire\n                  </Button>\n                )}\n                {piaffeur?.id === user?.id && piaf.statut === \"occupe\" && !hideButtons && (\n                  <Button disabled={loading} color=\"primary\" variant=\"contained\" onClick={() => unregister(piaf)}>\n                    Demander un remplacement\n                  </Button>\n                )}\n              </PiafRow>\n            )\n          })\n        ) : (\n          <CircularProgress />\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport default SlotInfo\n","import type { Creneau, PIAF } from \"src/types/model\"\nimport { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport { ListItem, ListItemAvatar, ListItemText } from \"@material-ui/core\"\nimport { useLazyQuery } from \"@apollo/client\"\n\nimport { formatDateLong, formatTime } from \"src/helpers/date\"\nimport PiafCircle from \"src/components/PiafCircle\"\nimport SlotDialog from \"src/components/SlotDialog\"\nimport { SLOTS } from \"src/graphql/queries\"\n\ninterface Result {\n  creneau: Creneau\n}\n\ninterface Props {\n  piaf: PIAF\n}\n\nconst Piaf = ({ piaf }: Props) => {\n  const { creneau } = piaf\n  const [open, setOpen] = useState(false)\n\n  const [load, { data }] = useLazyQuery<Result>(SLOTS, {\n    variables: { id: creneau.id },\n  })\n\n  const handleClick = () => {\n    setOpen(true)\n    load()\n  }\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  const slot: ISlot = {\n    id: creneau.id,\n    title: creneau.titre,\n    start: new Date(creneau.debut),\n    end: new Date(creneau.fin),\n    piafs: data?.creneau.piafs,\n  }\n\n  return (\n    <>\n      <ListItem key={piaf.id} button onClick={handleClick}>\n        <ListItemAvatar>\n          <PiafCircle piaf={piaf} />\n        </ListItemAvatar>\n        <ListItemText\n          primary={formatDateLong(slot.start)}\n          secondary={`de ${formatTime(slot.start)} à ${formatTime(slot.end)}`}\n        />\n      </ListItem>\n      <SlotDialog show={open} slot={slot} handleClose={handleClose} />\n    </>\n  )\n}\n\nexport default Piaf\n","import type { PIAF } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { startOfToday } from \"date-fns\"\nimport { CircularProgress, List } from \"@material-ui/core\"\n\nimport { useUser } from \"src/providers/user\"\nimport { PIAFS } from \"src/graphql/queries\"\nimport { queryDate } from \"src/helpers/date\"\nimport ErrorMessage from \"src/components/ErrorMessage\"\nimport Piaf from \"src/components/Piaf\"\n\ntype Result = { piafs: PIAF[] }\n\nconst UserPiafs = () => {\n  const { auth } = useUser<true>()\n\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: {\n      idPiaffeur: `/api/users/${auth.id}`,\n      after: queryDate(startOfToday()),\n    },\n  })\n\n  if (loading) {\n    return <CircularProgress />\n  }\n\n  if (error) {\n    return (\n      <ErrorMessage>\n        <p>Erreur : {error.message}</p>\n      </ErrorMessage>\n    )\n  }\n\n  if (!data) {\n    return null\n  }\n\n  if (!data.piafs.length) {\n    return <p>Aucune PIAF à venir. Inscrivez-vous sur le planning !</p>\n  }\n\n  return (\n    <List>\n      {data.piafs.map((piaf) => (\n        <Piaf key={piaf.id} piaf={piaf} />\n      ))}\n    </List>\n  )\n}\n\nexport default UserPiafs\n","import type { PIAF } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { startOfToday, addDays } from \"date-fns\"\nimport { CircularProgress, List } from \"@material-ui/core\"\n\nimport { useUser } from \"src/providers/user\"\nimport { PIAFS } from \"src/graphql/queries\"\nimport { queryDate } from \"src/helpers/date\"\nimport ErrorMessage from \"src/components/ErrorMessage\"\nimport Piaf from \"src/components/Piaf\"\n\ntype Result = { piafs: PIAF[] }\n\nconst ReplacementPiafs = () => {\n  const { auth } = useUser<true>()\n\n  const { loading, error, data } = useQuery<Result>(PIAFS, {\n    variables: {\n      after: queryDate(startOfToday()),\n      before: queryDate(addDays(startOfToday(), 700)),\n      statut: \"remplacement\",\n    },\n  })\n\n  if (loading) {\n    return <CircularProgress />\n  }\n\n  if (error) {\n    return (\n      <ErrorMessage>\n        <p>Erreur : {error.message}</p>\n      </ErrorMessage>\n    )\n  }\n\n  if (!data) {\n    return null\n  }\n\n  const otherPiafs = data.piafs.filter((piaf) => piaf.piaffeur?.id !== `/api/users/${auth.id}`)\n\n  if (!otherPiafs.length) {\n    return <p>Aucun remplacement à venir n’est demandé.</p>\n  }\n\n  return (\n    <>\n      <p>\n        Les créneaux ci dessous ne peuvent plus être effectués par un Chouettos, ils sont disponibles pour un\n        remplacement. N’hésites pas à te positionner, la personne que tu remplaces sera avertie par e-mail\n        instantanément !\n      </p>\n      <List>\n        {otherPiafs.map((piaf) => (\n          <Piaf key={piaf.id} piaf={piaf} />\n        ))}\n      </List>\n    </>\n  )\n}\n\nexport default ReplacementPiafs\n","import type { Statut, User } from \"src/types/model\"\n\nimport styled from \"@emotion/styled/macro\"\n\nimport { useUser } from \"src/providers/user\"\nimport UserPiafs from \"src/components/UserPiafs\"\nimport ReplacementPiafs from \"src/components/ReplacementPiafs\"\n\nconst Container = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  > div {\n    flex: 0 1 50%;\n    min-width: 400px;\n  }\n`\nconst Status = styled.div`\n  h2 {\n    margin-bottom: 0;\n  }\n  h1 {\n    font-weight: normal;\n    font-size: 2.5em;\n    margin-top: 0;\n    &::first-letter {\n      text-transform: uppercase;\n    }\n    span {\n      font-size: 1.2rem;\n    }\n  }\n`\nconst MyPlanning = styled.div``\nconst Replacements = styled.div``\n\nconst getStatus = (user: User | null) => {\n  if (!user) {\n    return \"…\"\n  }\n  const activeStatus = user.statuts.find((s: Statut) => s.actif)\n  if (!activeStatus) {\n    return \"?\"\n  }\n  return activeStatus.libelle\n}\n\nconst HomePage = () => {\n  const { user } = useUser<true>()\n\n  // TODO: replace \"14/12\" with real calculated value\n\n  return (\n    <Container>\n      <Status>\n        <h2>Mon statut</h2>\n        <h1>\n          14/12 <span>PIAFs attendues</span>\n        </h1>\n        <h2>Je suis</h2>\n        <h1>{getStatus(user)}</h1>\n      </Status>\n      <MyPlanning>\n        <h2>Mes prochaines PIAFs</h2>\n        <UserPiafs />\n      </MyPlanning>\n      <Replacements>\n        <h2>Remplacements</h2>\n        <ReplacementPiafs />\n      </Replacements>\n    </Container>\n  )\n}\n\nexport default HomePage\n","import type { ISlot } from \"src/types/app\"\n\nimport { useState } from \"react\"\nimport styled from \"@emotion/styled/macro\"\n\nimport SlotDialog from \"src/components/SlotDialog\"\nimport { formatTime } from \"src/helpers/date\"\nimport PiafCircle from \"src/components/PiafCircle\"\n\nconst SELECTED_COLOR = \"#FFFFAA\"\n\nconst ClickableSlot = styled.button<{ $open: boolean }>`\n  width: 100%;\n  border: none;\n  background-color: ${({ $open }) => ($open ? SELECTED_COLOR : \"transparent\")};\n  padding: 5px;\n  text-align: left;\n  font-size: inherit;\n  line-height: inherit;\n  font: inherit;\n  cursor: pointer;\n  &:focus {\n    background-color: ${SELECTED_COLOR};\n    outline: none;\n  }\n`\nconst Title = styled.div`\n  span {\n    color: gray;\n  }\n`\nconst List = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  margin: 0 -2px;\n`\n\ninterface Props {\n  slot: ISlot\n}\n\nconst Slot = ({ slot }: Props) => {\n  const [open, setOpen] = useState(false)\n\n  const handleClick = () => {\n    setOpen(true)\n  }\n\n  const handleClose = () => {\n    setOpen(false)\n  }\n\n  return (\n    <>\n      <ClickableSlot $open={open} onClick={handleClick}>\n        <Title>\n          <strong>\n            {formatTime(slot.start)}–{formatTime(slot.end)}\n          </strong>\n          <br />\n          <span>{slot.title}</span>\n        </Title>\n        <List>\n          {slot.piafs?.map((piaf) => (\n            <PiafCircle key={piaf.id} piaf={piaf} />\n          ))}\n        </List>\n      </ClickableSlot>\n      <SlotDialog show={open} slot={slot} handleClose={handleClose} />\n    </>\n  )\n}\n\nexport default Slot\n","import type { IDay } from \"src/types/app\"\n\nimport styled from \"@emotion/styled/macro\"\n\nimport Slot from \"src/components/Slot\"\nimport { formatDateShort } from \"src/helpers/date\"\nimport { isPast, isToday } from \"date-fns\"\n\ntype TimeStatus = \"past\" | \"present\" | \"future\"\n\nconst Container = styled.div<{ $when: TimeStatus }>`\n  opacity: ${({ $when }) => ($when === \"past\" ? 0.5 : 1)};\n  border: 1px solid gray;\n  min-height: 80px;\n  background-color: ${({ $when }) => ($when === \"present\" ? \"#d0d9d0\" : \"#eee\")};\n`\nconst Title = styled.h3`\n  margin: 0 5px;\n  text-transform: capitalize;\n`\nconst List = styled.ul`\n  list-style: none;\n  padding: 0;\n  margin: 0;\n`\n\ninterface Props {\n  day: IDay\n}\n\nconst CalendarDay = ({ day }: Props) => {\n  return (\n    <Container $when={isToday(day.start) ? \"present\" : isPast(day.start) ? \"past\" : \"future\"}>\n      <Title>{formatDateShort(day.start)}</Title>\n      <List>\n        {day.slots.map((slot) => (\n          <Slot slot={slot} key={slot.id}></Slot>\n        ))}\n      </List>\n    </Container>\n  )\n}\n\nexport default CalendarDay\n\nexport const DayPlaceholder = () => <Container $when=\"past\" />\n","import type { Creneau } from \"src/types/model\"\nimport type { IWeek } from \"src/types/app\"\n\nimport styled from \"@emotion/styled/macro\"\nimport { addDays, differenceInWeeks, eachWeekOfInterval, getDay } from \"date-fns\"\n\nimport CalendarDay, { DayPlaceholder } from \"src/components/CalendarDay\"\n\nconst Container = styled.div`\n  border: 1px solid gray;\n  margin: 0;\n  padding: 0;\n`\nconst WeekRow = styled.div`\n  @media screen and (min-width: 800px) {\n    display: flex;\n    > div {\n      flex: 1 0 14.29%;\n    }\n  }\n`\n\ninterface Props {\n  start: Date\n  end: Date\n  list?: Creneau[]\n}\n\nconst Calendar = ({ start, end, list }: Props) => {\n  if (!list) {\n    return null\n  }\n\n  const weeks: IWeek[] = eachWeekOfInterval({ start, end }, { weekStartsOn: 1 }).map((date) => ({\n    start: date,\n    days: [0, 1, 2, 3, 4, 5, 6].map((i) => ({ start: addDays(date, i), slots: [] })),\n  }))\n\n  list.forEach((node) => {\n    const date = new Date(node.debut)\n    const weekIndex = differenceInWeeks(date, weeks[0].start)\n    const week = weeks[weekIndex]\n    const day = (getDay(date) || 7) - 1 // Monday = 0, ..., Sunday = 6\n    const piafs = node.piafs.slice().sort((left, right) => (left.role.id > right.role.id ? 1 : -1))\n\n    week.days[day].slots.push({\n      id: node.id,\n      title: node.titre,\n      start: date,\n      end: new Date(node.fin),\n      piafs,\n    })\n  })\n\n  return (\n    <Container>\n      {weeks.map((week, index) => (\n        <WeekRow key={index}>\n          {week.days.map((day, i) =>\n            day.start >= start && day.start < end ? <CalendarDay day={day} key={i} /> : <DayPlaceholder key={i} />\n          )}\n        </WeekRow>\n      ))}\n    </Container>\n  )\n}\n\nexport default Calendar\n","import type { Creneau } from \"src/types/model\"\n\nimport { useQuery } from \"@apollo/client\"\nimport { Button, CircularProgress, Grid, useMediaQuery, useTheme } from \"@material-ui/core\"\nimport { ArrowBackIos, ArrowForwardIos, CalendarToday } from \"@material-ui/icons\"\nimport styled from \"@emotion/styled/macro\"\nimport { isSameMonth } from \"date-fns\"\n\nimport { useDatePlanning } from \"src/providers/datePlanning\"\nimport { PLANNING } from \"src/graphql/queries\"\nimport Calendar from \"src/components/Calendar\"\nimport { PiafIcon } from \"src/components/PiafCircle\"\nimport { formatMonthYear } from \"src/helpers/date\"\nimport ErrorMessage from \"src/components/ErrorMessage\"\n\ntype Result = { creneaus: Creneau[] }\n\nconst Loading = styled.div`\n  border: 2px solid gray;\n  height: 500px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst Caption = styled.div`\n  border: 1px solid gray;\n  border-radius: 10px;\n  max-width: 500px;\n  margin: 20px 0 100px auto;\n  padding: 10px;\n  text-align: center;\n`\nconst CaptionTitle = styled.h3`\n  text-align: left;\n  margin-top: 0;\n`\nconst Nav = styled.nav`\n  display: flex;\n  align-items: center;\n  margin-bottom: 10px;\n  button:not(:first-of-type) {\n    margin-left: 10px;\n  }\n`\nconst Title = styled.h2`\n  flex: 1;\n  margin: 0 20px;\n  text-transform: capitalize;\n  min-width: 160px;\n  text-align: center;\n`\n\nconst ButtonArea = styled.div`\n  display: flex;\n  justify-content: end;\n`\n\nconst PlanningPage = () => {\n  const { goBack, goForward, goToday, start, end } = useDatePlanning()\n  const theme = useTheme()\n  const matches = useMediaQuery(theme.breakpoints.up(\"sm\"))\n  const textTodayButton = matches ? \"Aujourd’hui\" : \"\"\n  const textBeforeButton = matches ? \"Précédent\" : \"\"\n  const textAfterButton = matches ? \"Suivant\" : \"\"\n\n  const { data, loading, error } = useQuery<Result>(PLANNING, {\n    variables: { after: start, before: end },\n  })\n\n  if (error) {\n    return (\n      <ErrorMessage>\n        <h2>\n          <strong>Une erreur est survenue.</strong> Essayez de recharger la page.\n        </h2>\n        <p>{error.message}</p>\n      </ErrorMessage>\n    )\n  }\n\n  return (\n    <>\n      <Nav>\n        <Grid container>\n          <Grid item xs={12} md={6}>\n            <Title>{formatMonthYear(start)}</Title>\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <ButtonArea>\n              <Button\n                disabled={loading}\n                variant=\"contained\"\n                color=\"primary\"\n                startIcon={<ArrowBackIos />}\n                onClick={goBack}\n              >\n                {textBeforeButton}\n              </Button>\n              <Button\n                disabled={loading || isSameMonth(start, new Date())}\n                variant=\"contained\"\n                color=\"primary\"\n                startIcon={<CalendarToday />}\n                onClick={goToday}\n              >\n                {textTodayButton}\n              </Button>\n              <Button\n                disabled={loading}\n                variant=\"contained\"\n                color=\"primary\"\n                endIcon={<ArrowForwardIos />}\n                onClick={goForward}\n              >\n                {textAfterButton}\n              </Button>\n            </ButtonArea>\n          </Grid>\n        </Grid>\n      </Nav>\n      {loading ? (\n        <Loading>\n          <CircularProgress />\n        </Loading>\n      ) : (\n        <Calendar start={start} end={end} list={data?.creneaus} />\n      )}\n      <Caption>\n        <CaptionTitle>Légende</CaptionTitle>\n        <Grid container>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"available\" />\n            <div>PIAF disponible</div>\n          </Grid>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"replacement\" />\n            <div>Cherche remplaçant·e</div>\n          </Grid>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"occupied\" />\n            <div>PIAF occupée</div>\n          </Grid>\n        </Grid>\n        <br />\n        <Grid container>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"available\" $role=\"CH\">\n               \n            </PiafIcon>\n            <div>Chouettos</div>\n          </Grid>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"available\">CA</PiafIcon>\n            <div>Caissier·e</div>\n          </Grid>\n          <Grid item xs={4}>\n            <PiafIcon $status=\"available\">GH</PiafIcon>\n            <div>Grand Hibou</div>\n          </Grid>\n        </Grid>\n      </Caption>\n    </>\n  )\n}\n\nexport default PlanningPage\n","import type { Statut } from \"src/types/model\"\n\nimport { useEffect, useState } from \"react\"\nimport { Phone, Mail } from \"@material-ui/icons\"\nimport { Button, CircularProgress, InputAdornment, TextField } from \"@material-ui/core\"\nimport styled from \"@emotion/styled/macro\"\n\nimport { useUser } from \"src/providers/user\"\nimport { handleError } from \"src/helpers/errors\"\nimport apollo from \"src/helpers/apollo\"\nimport { USER_UPDATE } from \"src/graphql/queries\"\nimport { useDialog } from \"src/providers/dialog\"\n\nconst Loading = styled.div`\n  height: 50vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst Container = styled.div`\n  margin: 0 auto;\n  max-width: 500px;\n  p,\n  .MuiTextField-root {\n    margin: 10px 0;\n  }\n  button {\n    margin: 15px auto;\n    display: block;\n  }\n`\n\nconst ProfilePage = () => {\n  const { user } = useUser<true>()\n  const [saving, setSaving] = useState(false)\n  const { openDialog } = useDialog()\n  const [values, setValues] = useState({\n    email: user?.email || \"\",\n    telephone: user?.telephone || \"\",\n  })\n\n  useEffect(() => {\n    if (user) {\n      setValues({\n        email: user.email,\n        telephone: user.telephone,\n      })\n    }\n  }, [user])\n\n  const handleInputChange = ({ target }: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = target\n    setValues({\n      ...values,\n      [name]: value,\n    })\n  }\n\n  const handleSave = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    setSaving(true)\n    try {\n      await apollo.mutate({\n        mutation: USER_UPDATE,\n        variables: { ...values, idUser: user?.id },\n      })\n      openDialog(\"Vos informations ont bien été mises à jour\")\n    } catch (error) {\n      handleError(error)\n    }\n    setSaving(false)\n  }\n\n  if (!user) {\n    return (\n      <Loading>\n        <CircularProgress />\n      </Loading>\n    )\n  }\n\n  const status = user.statuts.find((s: Statut) => s.actif)?.libelle.toLowerCase()\n  const roles = user.rolesChouette.map((r) => r.libelle).join(\", \")\n\n  return (\n    <Container>\n      <form onSubmit={handleSave}>\n        <h2>\n          {user.prenom} {user.nom}\n        </h2>\n        <p>Je suis {status || \"(sans statut)\"}</p>\n        <p>Et j’ai comme formations {roles || \"(sans rôle)\"}</p>\n        <TextField\n          name=\"telephone\"\n          label=\"Téléphone\"\n          required\n          disabled={!user}\n          value={values.telephone}\n          onChange={handleInputChange}\n          fullWidth\n          InputProps={{\n            startAdornment: (\n              <InputAdornment position=\"start\">\n                <Phone />\n              </InputAdornment>\n            ),\n          }}\n        />\n        <TextField\n          name=\"email\"\n          label=\"Adresse e-mail\"\n          required\n          disabled={!user}\n          value={values.email}\n          onChange={handleInputChange}\n          fullWidth\n          InputProps={{\n            startAdornment: (\n              <InputAdornment position=\"start\">\n                <Mail />\n              </InputAdornment>\n            ),\n          }}\n        />\n        <Button color=\"primary\" variant=\"contained\" disabled={saving} type=\"submit\">\n          Enregistrer\n        </Button>\n      </form>\n    </Container>\n  )\n}\n\nexport default ProfilePage\n","import { Link } from \"react-router-dom\"\n\nconst UniversalLink = ({ href, ...props }: React.AnchorHTMLAttributes<HTMLAnchorElement>) => {\n  if (href?.startsWith(\"/\")) {\n    return <Link to={href} {...props} />\n  }\n  return <a href={href} {...props} />\n}\n\nexport default UniversalLink\n","import { useState } from \"react\"\nimport clsx from \"clsx\"\nimport { createStyles, makeStyles, useTheme } from \"@material-ui/core/styles\"\nimport {\n  styled,\n  useMediaQuery,\n  Drawer,\n  AppBar,\n  Toolbar,\n  List,\n  Typography,\n  Divider,\n  IconButton,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Button,\n  Box,\n} from \"@material-ui/core\"\nimport {\n  Menu as MenuIcon,\n  ChevronLeft as ChevronLeftIcon,\n  ChevronRight as ChevronRightIcon,\n  Group as GroupIcon,\n  Person as PersonIcon,\n  Replay as ReplayIcon,\n  ArrowBack as ArrowBackIcon,\n  Home as HomeIcon,\n  Event as EventIcon,\n} from \"@material-ui/icons\"\n\nimport { useUser } from \"src/providers/user\"\nimport Link from \"src/components/Link\"\n\nconst DRAWER_WIDTH = 260\n\nconst Spacer = styled(Box)({\n  flexGrow: 1,\n})\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      display: \"flex\",\n    },\n    appBar: {\n      zIndex: theme.zIndex.drawer + 1,\n      transition: theme.transitions.create([\"width\", \"margin\"], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n    },\n    appBarShift: {\n      marginLeft: DRAWER_WIDTH,\n      width: `calc(100% - ${DRAWER_WIDTH}px)`,\n      transition: theme.transitions.create([\"width\", \"margin\"], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    menuButton: {\n      marginRight: 36,\n    },\n    hide: {\n      display: \"none\",\n    },\n    drawer: {\n      width: DRAWER_WIDTH,\n      flexShrink: 0,\n      whiteSpace: \"nowrap\",\n    },\n    drawerOpen: {\n      width: DRAWER_WIDTH,\n      transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    drawerClose: {\n      transition: theme.transitions.create(\"width\", {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n      overflowX: \"hidden\",\n      width: theme.spacing(7) + 1,\n      [theme.breakpoints.up(\"sm\")]: {\n        width: theme.spacing(9) + 1,\n      },\n    },\n    toolbar: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"flex-end\",\n      padding: theme.spacing(0, 1),\n      // necessary for content to be below app bar\n      ...theme.mixins.toolbar,\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(3),\n    },\n    menuItem: {\n      textDecoration: \"none\",\n      color: \"black\",\n    },\n  })\n)\n\nconst ITEMS = [\n  { title: \"Accueil\", href: \"/home\", Icon: HomeIcon },\n  { title: \"Planning\", href: \"/planning\", Icon: EventIcon },\n  { title: \"Réserve\", href: \"/reserve\", Icon: GroupIcon },\n  {\n    title: \"Réservation automatique\",\n    href: \"/auto\",\n    Icon: ReplayIcon,\n  },\n  { title: \"Mon profil\", href: \"/profile\", Icon: PersonIcon },\n  { title: \"Espace membre\", href: \"https://espace-membres.lachouettecoop.fr/page/homepage\", Icon: ArrowBackIcon },\n]\n\nconst Menu = () => {\n  const classes = useStyles()\n  const { user, logout } = useUser<true>()\n  const theme = useTheme()\n  const [open, setOpen] = useState(false)\n  const matches = useMediaQuery(theme.breakpoints.up(\"sm\"))\n\n  const handleDrawerOpen = () => {\n    setOpen(true)\n  }\n\n  const handleDrawerClose = () => {\n    setOpen(false)\n  }\n\n  if (!matches) {\n    return null\n  }\n\n  return (\n    <div className={classes.root}>\n      <AppBar\n        position=\"fixed\"\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open,\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, {\n              [classes.hide]: open,\n            })}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" noWrap>\n            Planning\n          </Typography>\n          <Spacer />\n          <Button onClick={logout} color=\"inherit\">\n            Déconnexion\n          </Button>\n        </Toolbar>\n      </AppBar>\n      <Toolbar />\n      <Drawer\n        variant=\"permanent\"\n        className={clsx(classes.drawer, {\n          [classes.drawerOpen]: open,\n          [classes.drawerClose]: !open,\n        })}\n        classes={{\n          paper: clsx({\n            [classes.drawerOpen]: open,\n            [classes.drawerClose]: !open,\n          }),\n        }}\n      >\n        <div className={classes.toolbar}>\n          <IconButton onClick={handleDrawerClose}>\n            {theme.direction === \"rtl\" ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n          </IconButton>\n        </div>\n        <Divider />\n        <ListItem button>\n          <ListItemIcon>\n            <PersonIcon />\n          </ListItemIcon>\n          {user && <ListItemText primary={`${user.prenom} ${user.nom}`} />}\n        </ListItem>\n        <Divider />\n        <List>\n          {ITEMS.map(({ href, title, Icon }) => (\n            <Link className={classes.menuItem} href={href} key={href}>\n              <ListItem button>\n                <ListItemIcon>\n                  <Icon />\n                </ListItemIcon>\n                <ListItemText primary={title} />\n              </ListItem>\n            </Link>\n          ))}\n        </List>\n      </Drawer>\n    </div>\n  )\n}\n\nexport default Menu\n","import React, { useState, Fragment } from \"react\"\nimport { Link } from \"react-router-dom\"\nimport { createStyles, useTheme, makeStyles } from \"@material-ui/core/styles\"\nimport {\n  useMediaQuery,\n  Menu,\n  MenuItem,\n  ListItem,\n  ListItemText,\n  ListItemIcon,\n  AppBar,\n  Toolbar,\n  IconButton,\n} from \"@material-ui/core\"\nimport {\n  MoreVert as MoreIcon,\n  Group as GroupIcon,\n  Person as PersonIcon,\n  Replay as ReplayIcon,\n  ArrowBack as ArrowBackIcon,\n  Event as EventIcon,\n  // Home as HomeIcon,\n} from \"@material-ui/icons\"\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    appBar: {\n      top: \"auto\",\n      bottom: 0,\n    },\n    toolbar: {\n      justifyContent: \"space-between\",\n    },\n    label: {\n      // Aligns the content of the button vertically.\n      flexDirection: \"column\",\n    },\n    menu: {\n      \"& ul\": {\n        paddingTop: \"0 !important\",\n        paddingBottom: \"0 !important\",\n      },\n    },\n    textMenuDecoration: {\n      textDecoration: \"none\",\n    },\n    textMenu: {\n      color: \"white\",\n      backgroundColor: theme.palette.primary.main,\n      \"&:hover\": {\n        background: theme.palette.primary.dark,\n      },\n    },\n    icon: {\n      justifyContent: \"center\",\n    },\n  })\n)\n\nconst MAIN_ITEMS = [\n  { title: \"Planning\", href: \"/planning\", Icon: EventIcon },\n  { title: \"Réserve\", href: \"/reserve\", Icon: GroupIcon },\n  { title: \"Auto\", href: \"/auto\", Icon: ReplayIcon },\n]\nconst EXTRA_ITEMS = [\n  // { title: \"home\", href: \"/\", Icon: HomeIcon },\n  { title: \"Mon profil\", href: \"/profile\", Icon: PersonIcon },\n  { title: \"Espace membre\", href: \"/member\", Icon: ArrowBackIcon },\n]\n\nexport default function BottomAppBar() {\n  const classes = useStyles()\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null)\n  const theme = useTheme()\n  const matches = useMediaQuery(theme.breakpoints.down(\"xs\"))\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget)\n  }\n\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  if (!matches) {\n    return null\n  }\n\n  return (\n    <Fragment>\n      <AppBar position=\"fixed\" color=\"primary\" className={classes.appBar}>\n        <Toolbar className={classes.toolbar}>\n          {MAIN_ITEMS.map(({ href, title, Icon }) => (\n            <Link className={classes.textMenuDecoration} to={href} key={title}>\n              <ListItem button className={classes.label}>\n                <ListItemIcon className={classes.icon}>\n                  <Icon />\n                </ListItemIcon>\n                <ListItemText className={classes.textMenu} primary={title} />\n              </ListItem>\n            </Link>\n          ))}\n          <Menu\n            id=\"simple-menu\"\n            className={classes.menu}\n            anchorEl={anchorEl}\n            keepMounted\n            open={Boolean(anchorEl)}\n            onClose={handleClose}\n          >\n            {EXTRA_ITEMS.map((item) => (\n              <Link className={classes.textMenuDecoration} to={item.href} key={item.title}>\n                <MenuItem className={classes.textMenu} onClick={handleClose}>\n                  {item.title}\n                </MenuItem>\n              </Link>\n            ))}\n          </Menu>\n          <IconButton aria-controls=\"simple-menu\" aria-haspopup=\"true\" onClick={handleClick} edge=\"end\" color=\"inherit\">\n            <MoreIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n    </Fragment>\n  )\n}\n","import { CreneauGenerique, Reserve } from \"src/types/model\"\nimport { IReserve } from \"src/types/app\"\n\nimport { useEffect, useState, ChangeEvent } from \"react\"\nimport { Button, FormGroup, FormControlLabel, Checkbox, CircularProgress, TextField } from \"@material-ui/core\"\nimport { useQuery } from \"@apollo/client\"\nimport styled from \"@emotion/styled/macro\"\n\nimport apollo from \"src/helpers/apollo\"\nimport { handleError } from \"src/helpers/errors\"\nimport { RESERVE_CREATE, RESERVE_UPDATE, CRENEAUX_GENERIQUES, RESERVE_USER } from \"src/graphql/queries\"\nimport { useUser } from \"src/providers/user\"\nimport { useDialog } from \"src/providers/dialog\"\nimport { formatTime, getDayOfWeek } from \"src/helpers/date\"\nimport ErrorMessage from \"src/components/ErrorMessage\"\n\nconst Loading = styled.div`\n  height: 300px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\nconst ReserveGrid = styled.div`\n  @media screen and (min-width: 980px) {\n    display: flex;\n    > div {\n      flex: 1 0 14.29%;\n    }\n  }\n`\nconst Infos = styled.div`\n  margin: 20px 0 40px;\n`\n\ntype ResultCG = { creneauGeneriques: CreneauGenerique[] }\ntype ResultRU = { reserves: Reserve[] }\n\nconst ReservePage = () => {\n  const { user } = useUser<true>()\n  const [saving, setSaving] = useState(false)\n  const { openDialog } = useDialog()\n  const [information, setInformation] = useState<string>(\"\")\n  const [slots, setSlots] = useState<string[]>([])\n\n  const { data: dataCreneauxList, loading: loadingCL, error: errorCreneauxList } = useQuery<ResultCG>(\n    CRENEAUX_GENERIQUES\n  )\n  const { data: dataCreneauxUser, loading: loadingCU, error: errorReserve } = useQuery<ResultRU>(RESERVE_USER, {\n    skip: !user,\n    variables: { idUser: user?.id },\n  })\n  const loading = loadingCL || loadingCU\n\n  useEffect(() => {\n    if (dataCreneauxUser && dataCreneauxUser?.reserves.length > 0) {\n      setInformation(dataCreneauxUser.reserves[0].informations)\n      setSlots(dataCreneauxUser.reserves[0].creneauGeneriques.map((cg) => cg.id))\n    }\n  }, [dataCreneauxUser])\n\n  if (errorCreneauxList || errorReserve) {\n    return (\n      <ErrorMessage>\n        <h2>\n          <strong>Une erreur est survenue.</strong> Essayez de recharger la page.\n        </h2>\n        <p>{errorCreneauxList?.message}</p>\n        <p>{errorReserve?.message}</p>\n      </ErrorMessage>\n    )\n  }\n\n  const slotList: IReserve[] = []\n\n  if (dataCreneauxList) {\n    for (let day = 0; day < 7; day++) {\n      dataCreneauxList?.creneauGeneriques\n        .filter(({ jour, actif }) => jour === day && actif)\n        .forEach((slot) => {\n          const reserveFound = slotList.find((s) => s.day === day)\n          const startTime = new Date(slot.heureDebut).getTime()\n          if (reserveFound) {\n            const slotReserveFound = reserveFound.slots.find(({ time }) => time === startTime)\n            if (slotReserveFound) {\n              slotReserveFound.allSlotIds.push(slot.id)\n            } else {\n              reserveFound.slots.push({\n                time: startTime,\n                slotDisplayed: slot,\n                allSlotIds: [slot.id],\n              })\n            }\n          } else {\n            slotList.push({\n              day: day,\n              slots: [\n                {\n                  time: startTime,\n                  slotDisplayed: slot,\n                  allSlotIds: [slot.id],\n                },\n              ],\n            })\n          }\n        })\n    }\n  }\n\n  const handleInfoChange = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    setInformation(target.value)\n  }\n\n  const getSlots = (idCreneauGenerique: string) => {\n    let list: string[] = []\n    slotList.forEach((slot) => {\n      const selected = slot.slots.find((displayed) => displayed.slotDisplayed.id === idCreneauGenerique)\n      if (selected) {\n        list = selected.allSlotIds\n      }\n    })\n    return list\n  }\n\n  const handleCheckboxChange = (idCreneauGenerique: string, checked: boolean) => {\n    const temp = slots.slice()\n    if (checked) {\n      temp.push(...getSlots(idCreneauGenerique))\n      setSlots(temp)\n    } else {\n      getSlots(idCreneauGenerique).forEach((slot) => {\n        temp.splice(temp.indexOf(slot), 1)\n      })\n      setSlots(temp)\n    }\n  }\n\n  const handleSave = async () => {\n    setSaving(true)\n\n    const variables: Record<string, any> = {\n      user: user?.id,\n      informations: information,\n      creneauGenerique: slots,\n    }\n    if (dataCreneauxUser?.reserves.length) {\n      variables.id = dataCreneauxUser.reserves[0].id\n    }\n\n    try {\n      await apollo.mutate({\n        mutation: variables.id ? RESERVE_UPDATE : RESERVE_CREATE,\n        variables,\n      })\n\n      openDialog(\n        (variables.id\n          ? \"Votre inscription à la réserve a bien été mise à jour.\"\n          : \"Vous êtes désormais inscrit·e à la reserve.\") + \" Merci !\"\n      )\n    } catch (error) {\n      handleError(error)\n    }\n\n    setSaving(false)\n  }\n\n  return (\n    <>\n      <h1>Réserve</h1>\n      {loading ? (\n        <Loading>\n          <CircularProgress />\n        </Loading>\n      ) : (\n        <>\n          <ReserveGrid>\n            {slotList.map((reserve) => (\n              <FormGroup key={reserve.day}>\n                {getDayOfWeek(reserve.day)}\n                {reserve.slots.map(({ slotDisplayed }) => (\n                  <FormControlLabel\n                    key={slotDisplayed.id}\n                    control={\n                      <Checkbox\n                        color=\"default\"\n                        checked={slots.includes(slotDisplayed.id)}\n                        onChange={({ target }) => {\n                          handleCheckboxChange(slotDisplayed.id, target.checked)\n                        }}\n                      />\n                    }\n                    label={`${formatTime(slotDisplayed.heureDebut)} - ${formatTime(slotDisplayed.heureFin)}`}\n                  />\n                ))}\n              </FormGroup>\n            ))}\n          </ReserveGrid>\n          <Infos>\n            <TextField\n              multiline\n              disabled={loading}\n              label=\"Informations supplémentaires (optionnel)\"\n              value={information}\n              onChange={handleInfoChange}\n              fullWidth\n            />\n          </Infos>\n          <Button disabled={saving} color=\"primary\" variant=\"contained\" onClick={handleSave}>\n            S’inscrire\n          </Button>\n        </>\n      )}\n    </>\n  )\n}\n\nexport default ReservePage\n","import { Redirect, Route, Switch, useLocation } from \"react-router-dom\"\nimport { styled, Container } from \"@material-ui/core\"\n\nimport { DatePlanningProvider } from \"src/providers/datePlanning\"\nimport HomePage from \"src/pages/authenticated/Home\"\nimport PlanningPage from \"src/pages/authenticated/Planning\"\nimport Profile from \"src/pages/authenticated/Profile\"\nimport Menu from \"src/components/menu\"\nimport MenuBottom from \"src/components/menuBottom\"\nimport { getParams } from \"src/helpers/request\"\nimport ReservePage from \"src/pages/authenticated/Reserve\"\n\nconst Content = styled(Container)(({ theme }) => ({\n  marginTop: theme.spacing(3),\n  paddingLeft: theme.spacing(1),\n  [theme.breakpoints.up(\"sm\")]: {\n    paddingLeft: theme.spacing(12),\n  },\n}))\n\nconst Authenticated = () => {\n  const { search } = useLocation()\n  const { next } = getParams(search)\n\n  return (\n    <DatePlanningProvider>\n      <Menu />\n      <Content>\n        <Switch>\n          <Route path=\"/home\">\n            <HomePage />\n          </Route>\n          <Route path=\"/planning\">\n            <PlanningPage />\n          </Route>\n          <Route path=\"/profile\">\n            <Profile />\n          </Route>\n          <Route path=\"/reserve\">\n            <ReservePage />\n          </Route>\n          <Route path=\"/profile\">\n            <Profile />\n          </Route>\n          <Redirect to={next || \"/home\"} />\n        </Switch>\n        <MenuBottom />\n      </Content>\n    </DatePlanningProvider>\n  )\n}\n\nexport default Authenticated\n","import { BrowserRouter } from \"react-router-dom\"\n\nimport { useUser } from \"src/providers/user\"\n\nimport Anonymous from \"src/pages/anonymous\"\nimport Authenticated from \"src/pages/authenticated\"\nimport { DialogProvider } from \"src/providers/dialog\"\n\nimport { createMuiTheme, ThemeProvider } from \"@material-ui/core/styles\"\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      // light: will be calculated from palette.primary.main,\n      main: \"#445448\",\n      // dark: will be calculated from palette.primary.main,\n      // contrastText: will be calculated to contrast with palette.primary.main\n    },\n    // Used by `getContrastText()` to maximize the contrast between\n    // the background and the text.\n    contrastThreshold: 3,\n    // Used by the functions below to shift a color's luminance by approximately\n    // two indexes within its tonal palette.\n    // E.g., shift from Red 500 to Red 300 or Red 700.\n    tonalOffset: 0.2,\n  },\n})\n\nconst App = () => {\n  const { auth } = useUser()\n\n  return (\n    <ThemeProvider theme={theme}>\n      <BrowserRouter>\n        <DialogProvider>{auth ? <Authenticated /> : <Anonymous />}</DialogProvider>\n      </BrowserRouter>\n    </ThemeProvider>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { CssBaseline } from \"@material-ui/core\"\nimport { ApolloProvider } from \"@apollo/client\"\n\nimport App from \"src/App\"\nimport { UserProvider } from \"src/providers/user\"\nimport apollo from \"src/helpers/apollo\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <CssBaseline />\n    <ApolloProvider client={apollo}>\n      <UserProvider>\n        <App />\n      </UserProvider>\n    </ApolloProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}