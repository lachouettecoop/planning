(this.webpackJsonpplanning=this.webpackJsonpplanning||[]).push([[0],{244:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),c=n(24),o=n.n(c),s=n(19),u=n(13),l=n(135),d=n.n(l),j=n(184),b=n.n(j),p=n(82),f=n(1);var m="bd8932c3a4a955397cd4900e01d9ad76";d.a.start({apiKey:m,releaseStage:"production",enabledReleaseStages:["production"],appVersion:"901d21928d32916d4d4fe90a90f164c346f7e4ea",metadata:{deployDate:(new Date).toString(),deployAuthor:"antoinerousseau"},plugins:[new b.a]});var h,O,v,x=function(e){console.error(e),alert(e.message),d.a.notify(e)},g=null===(r=d.a.getPlugin("react"))||void 0===r?void 0:r.createErrorBoundary(i.a),y=Object(u.a)("div",{target:"e1vn7bue1"})({name:"10i3u6",styles:"padding:1rem;h2{color:#e53935;margin:1rem 0;}code{display:block;margin-top:3rem;color:#aaa;}"}),C=function(e){var t=e.error;return Object(f.jsxs)(y,{children:[Object(f.jsxs)(p.a,{variant:"h2",children:[Object(f.jsx)("span",{"aria-hidden":!0,children:"\ud83d\udc1e"}),Object(f.jsx)("br",{}),"Une erreur est survenue"]}),Object(f.jsx)(p.a,{children:"Essayez de recharger la page"}),Object(f.jsx)("code",{children:String(t)})]})},I=Object(u.a)("p",{target:"e1vn7bue0"})({name:"1nm0ewq",styles:"color:#e53935"}),w=function(e){var t=e.error;return Object(f.jsxs)(I,{children:["Erreur : ",t.message]})},P=function(e){var t=e.children;return g?Object(f.jsx)(g,{FallbackComponent:C,children:t}):Object(f.jsx)(f.Fragment,{children:t})},A=n(32),S=n(189),k=n(9),F=n(39),q=Object(s.gql)(h||(h=Object(F.a)(["\n  query LOGGED_IN_USER($id: ID!) {\n    user(id: $id) {\n      id\n      rolesChouette {\n        id\n        roleUniqueId\n        libelle\n      }\n      nom\n      prenom\n      email\n      telephone\n      actif\n      statut\n      nbPiafEffectuees\n      nbPiafAttendues\n      nbPiafGH\n      nbPiafCaisse\n    }\n  }\n"]))),E=Object(s.gql)(O||(O=Object(F.a)(["\n  mutation USER_UPDATE($idUser: ID!, $email: String, $telephone: String) {\n    updateUser(input: { id: $idUser, email: $email, telephone: $telephone }) {\n      user {\n        id\n        email\n        telephone\n      }\n    }\n  }\n"]))),D=Object(s.gql)(v||(v=Object(F.a)(["\n  query USERS {\n    users(enabled: true) {\n      id\n      nom\n      prenom\n      email\n      actif\n      rolesChouette {\n        id\n        libelle\n        roleUniqueId\n      }\n      statut\n      reserve {\n        id\n        informations\n        creneauGeneriques {\n          id\n          heureDebut\n          heureFin\n          jour\n        }\n      }\n      absenceLongueDureeCourses\n      absenceLongueDureeSansCourses\n      nbPiafEffectuees\n      nbPiafAttendues\n      nbPiafGH\n      nbPiafCaisse\n    }\n  }\n"]))),M=Object(a.createContext)({}),$="user",_=function(){var e=localStorage.getItem($);return e?JSON.parse(e):null},G=function(e){var t=e.children,n=Object(a.useState)(_),r=Object(k.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(null),s=Object(k.a)(o,2),u=s[0],l=s[1];Object(a.useEffect)((function(){i&&ne.query({query:q,variables:{id:"api/users/".concat(i.id)}}).then((function(e){var t=e.data;l(t.user)}))}),[i]);return Object(f.jsx)(M.Provider,{value:{auth:i,user:u,login:function(e){c(e),localStorage.setItem($,JSON.stringify(e))},logout:function(){c(null),localStorage.removeItem($)}},children:t})};function z(){return Object(a.useContext)(M)}var T="https://adminchouettos.lachouettecoop.fr";var R,N,U,H,L,B,V,W,Q,K,J,Y,X,Z=T.includes("test"),ee=Object(s.createHttpLink)({uri:"".concat(T,"/api/graphql")}),te=Object(S.a)((function(e,t){var n=_();return n?Object(A.a)(Object(A.a)({},t),{},{headers:Object(A.a)(Object(A.a)({},t.headers),{},{"X-Auth-Token":n.token})}):t})),ne=new s.ApolloClient({link:te.concat(ee),cache:new s.InMemoryCache,defaultOptions:{query:{fetchPolicy:"network-only"},watchQuery:{fetchPolicy:"cache-and-network"}}}),re=n(92),ae=n(293),ie=n(127),ce=n(297),oe=n(340),se=n(46),ue="Montserrat, sans-serif",le="Cabin, sans-serif",de="#3A5447",je=n(136).a[500],be=Object(re.a)({typography:{fontFamily:le,body1:{fontFamily:le,fontSize:"1rem"},body2:{fontFamily:le,fontSize:"1rem"},subtitle1:{fontFamily:ue},subtitle2:{fontFamily:ue},h1:{fontFamily:ue,fontWeight:600,fontSize:"2.5rem"},h2:{fontFamily:ue,fontWeight:600,fontSize:"1.5rem"},h3:{fontFamily:ue,fontWeight:600,color:de},h4:{fontFamily:ue},h5:{fontFamily:ue},h6:{fontFamily:ue}},palette:{primary:{main:de},secondary:{main:je},contrastThreshold:3,tonalOffset:.2},overrides:{MuiCssBaseline:{"@global":{a:{color:de}}}}},se.frFR,ie.b),pe=function(e){var t=e.children;return Object(f.jsx)(oe.b,{theme:be,children:Object(f.jsxs)(ae.a,{theme:be,children:[Object(f.jsx)(ce.a,{}),t]})})},fe=Object(s.gql)(R||(R=Object(F.a)(["\n  query SLOTS($id: ID!) {\n    creneau(id: $id) {\n      titre\n      informations\n      debut\n      fin\n      creneauGenerique {\n        frequence\n      }\n      piafs {\n        id\n        statut\n        informations\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          nom\n          prenom\n          email\n          telephone\n          nbPiafGH\n          nbPiafCaisse\n        }\n      }\n    }\n  }\n"]))),me=Object(s.gql)(N||(N=Object(F.a)(["\n  query PIAFS($userId: String, $after: String, $before: String, $statut: String, $validated: Boolean) {\n    piafs(piaffeur: $userId, creneau_debut: { after: $after, before: $before }, statut: $statut, pourvu: $validated) {\n      id\n      statut\n      pourvu\n      nonPourvu\n      informations\n      creneau {\n        id\n        titre\n        debut\n        fin\n      }\n      piaffeur {\n        id\n        nom\n        prenom\n        email\n        telephone\n        nbPiafGH\n        nbPiafCaisse\n      }\n      role {\n        id\n        roleUniqueId\n        libelle\n      }\n    }\n  }\n"]))),he=Object(s.gql)(U||(U=Object(F.a)(["\n  query PIAFS_COUNT($userId: String, $after: String, $before: String) {\n    piafs(piaffeur: $userId, creneau_debut: { after: $after, before: $before }) {\n      id\n      statut\n      nonPourvu\n      creneau {\n        debut\n        fin\n      }\n    }\n  }\n"]))),Oe=Object(s.gql)(H||(H=Object(F.a)(["\n  query PLANNING($after: String, $before: String) {\n    creneaus(debut: { after: $after, before: $before }) {\n      id\n      debut\n      fin\n      titre\n      informations\n      creneauGenerique {\n        frequence\n      }\n      piafs {\n        id\n        statut\n        informations\n        role {\n          id\n          roleUniqueId\n          libelle\n        }\n        piaffeur {\n          id\n          nom\n          prenom\n          email\n          telephone\n          nbPiafGH\n          nbPiafCaisse\n        }\n      }\n    }\n  }\n"]))),ve=Object(s.gql)(L||(L=Object(F.a)(["\n  mutation REGISTRATION_UPDATE($piafId: ID!, $userId: String!, $statut: String!, $informations: String) {\n    updatePiaf(input: { id: $piafId, piaffeur: $userId, statut: $statut, informations: $informations }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        statut\n        informations\n      }\n    }\n  }\n"]))),xe=Object(s.gql)(B||(B=Object(F.a)(["\n  mutation VALIDATE_PIAF($piafId: ID!, $validate: Boolean) {\n    updatePiaf(input: { id: $piafId, pourvu: $validate }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        pourvu\n      }\n    }\n  }\n"]))),ge=Object(s.gql)(V||(V=Object(F.a)(["\n  mutation PIAF_NON_POURVU($piafId: ID!, $nonPourvu: Boolean) {\n    updatePiaf(input: { id: $piafId, nonPourvu: $nonPourvu }) {\n      piaf {\n        id\n        piaffeur {\n          id\n        }\n        pourvu\n        nonPourvu\n      }\n    }\n  }\n"]))),ye=Object(s.gql)(W||(W=Object(F.a)(["\n  mutation RESERVE_CREATE($user: String, $informations: String, $creneauGenerique: [String]) {\n    createReserve(input: { user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n"]))),Ce=Object(s.gql)(Q||(Q=Object(F.a)(["\n  mutation RESERVE_UPDATE($id: ID!, $user: String, $informations: String, $creneauGenerique: [String]) {\n    updateReserve(input: { id: $id, user: $user, informations: $informations, creneauGeneriques: $creneauGenerique }) {\n      reserve {\n        id\n        informations\n        user {\n          id\n        }\n        creneauGeneriques {\n          id\n          jour\n          frequence\n          heureDebut\n          heureFin\n        }\n      }\n    }\n  }\n"]))),Ie=Object(s.gql)(K||(K=Object(F.a)(["\n  query RESERVE_USER($idUser: String) {\n    reserves(user: $idUser) {\n      id\n      informations\n      creneauGeneriques {\n        id\n      }\n    }\n  }\n"]))),we=Object(s.gql)(J||(J=Object(F.a)(["\n  query CRENEAUX_GENERIQUES {\n    creneauGeneriques {\n      id\n      heureDebut\n      heureFin\n      titre\n      jour\n      actif\n      postes {\n        id\n        role {\n          libelle\n        }\n      }\n    }\n  }\n"]))),Pe=Object(s.gql)(Y||(Y=Object(F.a)(["\n  mutation PIAF_CREATE($idCreneau: String!, $idRole: String) {\n    createPiaf(input: { creneau: $idCreneau, role: $idRole, visible: true, pourvu: false, nonPourvu: false }) {\n      piaf {\n        id\n        creneau {\n          id\n        }\n        piaffeur {\n          id\n        }\n        role {\n          id\n        }\n      }\n    }\n  }\n"]))),Ae=Object(s.gql)(X||(X=Object(F.a)(["\n  query ROLES {\n    roles {\n      id\n      libelle\n      roleUniqueId\n    }\n  }\n"]))),Se=Object(a.createContext)({}),ke=function(e){var t=e.children,n=[],r=Object(s.useQuery)(Ae).data;return r&&(n=r.roles),Object(f.jsx)(Se.Provider,{value:{roles:n},children:t})};var Fe,qe,Ee=n(64),De=n(31),Me=n(298),$e=n(25),_e=n.n($e),Ge=n(36),ze=n(162),Te=n(90),Re=n(132),Ne=n.n(Re),Ue=function(){var e=Object(Ge.a)(_e.a.mark((function e(t,n,r){var a;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://adminchouettos.lachouettecoop.fr","/").concat(t),{method:"POST",body:n,headers:r});case 2:if((a=e.sent).ok){e.next=5;break}throw new Ne.a(a.status,a.statusText);case 5:return e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),He=function(){var e=Object(Ge.a)(_e.a.mark((function e(t,n,r){var a,i,c;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=_()){e.next=3;break}throw new Error("You must be authenticated to trigger the sending of an email");case 3:return i={"X-Auth-Token":a.token},(c=new FormData).append("sujet",n),c.append("email",t),c.append("corps",r),e.next=10,Ue("dist_api/send_email",c,i);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function Le(){return(Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Be(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Ve(e,t){var n=e.title,r=e.titleId,i=Be(e,["title","titleId"]);return a.createElement("svg",Le({xmlns:"http://www.w3.org/2000/svg",width:756,height:756,viewBox:"0 0 756 756",ref:t,"aria-labelledby":r},i),n?a.createElement("title",{id:r},n):null,Fe||(Fe=a.createElement("path",{d:"M61.585 422.116v58.818h22.67v14.24H44.713v-73.058zM135.514 468.447l-8.98-24.533-9.093 24.533zm4.6 12.924h-27.6l-5.585 13.803H89.402l29.464-73.058h15.446l28.808 73.058h-17.527z",fill:"#314b3f"})),qe||(qe=a.createElement("g",{transform:"matrix(1.33333 0 0 -1.33333 0 756)",fill:"#314b3f"},a.createElement("path",{d:"M187.233 197.273c-4.847-2.463-8.789-2.955-12.075-2.955-10.106 0-16.922 3.45-21.524 7.966-4.927 4.765-8.543 11.994-8.543 20.786 0 8.626 3.616 15.854 8.543 20.62 4.847 4.681 11.913 7.884 20.454 7.884 3.616 0 7.805-.739 13.145-3.04v-14.62c-2.793 2.956-6.98 5.83-12.814 5.83-4.6 0-8.298-1.48-11.17-4.27-3.042-2.959-5.178-7.393-5.178-12.652 0-5.666 2.3-9.693 4.764-12.076 1.152-1.148 5.093-4.599 11.83-4.599 3.287 0 7.721.902 12.568 5.668zM209.99 229.476h21.85v20.866h12.651v-54.793H231.84v23.248h-21.85v-23.248h-12.653v54.793h12.653zM271.76 235.23c-2.38-2.301-4.846-6.326-4.846-12.407 0-5.012 1.643-9.037 5.01-12.323 3.533-3.367 7.479-4.519 11.748-4.519 5.586 0 9.529 2.054 12.159 4.684 2.134 2.052 4.766 5.914 4.766 12.241 0 5.667-2.301 9.855-4.766 12.323-2.71 2.627-7.066 4.681-12.077 4.681-4.764 0-9.036-1.726-11.993-4.68m33.269 8.376c5.175-5.012 8.544-12.239 8.544-20.7 0-7.313-2.626-14.788-8.544-20.537-5.093-4.932-11.993-8.05-21.193-8.05-10.27 0-17.25 4.107-21.358 8.05-5.258 4.928-8.544 12.322-8.544 20.37 0 7.888 3.53 15.855 8.46 20.783 3.699 3.7 10.515 8.052 21.442 8.052 8.544 0 15.69-2.628 21.193-7.968M369.353 217.894c0-5.258-.657-11.747-6.08-17.333-5.259-5.422-11.335-6.243-17.085-6.243-5.752 0-11.83.821-17.087 6.243-5.424 5.586-6.081 12.075-6.081 17.333v32.447h12.654v-32.12c0-2.38.163-6.406 2.873-9.2 2.217-2.38 5.257-2.873 7.641-2.873 2.38 0 5.42.493 7.638 2.873 2.711 2.795 2.876 6.82 2.876 9.2v32.12h12.651zM412.315 239.664h-18.317v-10.598h17.415v-10.678h-17.415v-12.16h18.317V195.55h-30.97v54.793h30.97zM441.807 239.664V195.55h-12.65v44.115h-11.913v10.678h36.475v-10.678zM483.862 239.664V195.55h-12.649v44.115H459.3v10.678h36.476v-10.678zM533.396 239.664h-18.315v-10.598h17.413v-10.678h-17.413v-12.16h18.315V195.55H502.43v54.793h30.967zM150.376 147.294h14.159v-6.497h-14.159zM216.303 142.846v-6.907s.07-10.871-9.847-10.871c-9.913 0-9.844 10.87-9.844 10.87v29.614s-.07 10.87 9.844 10.87c9.917 0 9.847-10.87 9.847-10.87v-6.91H209.4v6.91s.27 3.69-2.806 3.69c-2.6 0-2.6-3.69-2.6-3.69v-29.613s0-3.691 2.6-3.691c3.077 0 2.806 3.69 2.806 3.69v6.908zM257.48 169.241c-2.598 0-2.462-3.689-2.462-3.689v-29.614s-.136-3.69 2.461-3.69c2.6 0 2.465 3.69 2.465 3.69v29.614s.135 3.69-2.465 3.69m0-44.175c-9.916 0-9.845 10.871-9.845 10.871v29.614s-.07 10.871 9.845 10.871c9.917 0 9.847-10.87 9.847-10.87v-29.615s.07-10.87-9.847-10.87M309.045 169.241c-2.598 0-2.461-3.689-2.461-3.689v-29.614s-.137-3.69 2.46-3.69c2.599 0 2.466 3.69 2.466 3.69v29.614s.133 3.69-2.465 3.69m0-44.175c-9.913 0-9.847 10.871-9.847 10.871v29.614s-.066 10.871 9.847 10.871c9.917 0 9.847-10.87 9.847-10.87v-29.615s.07-10.87-9.847-10.87M358.63 153.24c4.65 0 5.54 1.71 5.54 7.32 0 5.607-.89 7.792-5.54 7.792zm-7.385 22.635h7.385c6.43 0 12.993-3.488 12.993-15.044 0-11.556-6.563-15.113-12.993-15.113v-20.103h-7.385zM402.399 147.294h14.157v-6.497h-14.157zM281.567 382.087a.789.789 0 011.375 0l3.075 5.445a.79.79 0 01-.13.947l-3.073 3.075a.792.792 0 01-1.118 0l-3.074-3.075a.79.79 0 01-.129-.947zM304.03 401.252a3.2 3.2 0 003.195-3.196 3.2 3.2 0 00-3.196-3.196 3.2 3.2 0 00-3.196 3.195 3.2 3.2 0 003.196 3.196m0-11.503c4.582 0 8.308 3.728 8.308 8.308s-3.726 8.308-8.308 8.308-8.307-3.727-8.307-8.308c0-4.58 3.725-8.308 8.307-8.308M261.852 401.252a3.2 3.2 0 003.196-3.196 3.2 3.2 0 00-3.196-3.196 3.2 3.2 0 00-3.196 3.195 3.2 3.2 0 003.196 3.196m0-11.503c4.582 0 8.308 3.728 8.308 8.308s-3.726 8.308-8.308 8.308c-4.581 0-8.31-3.727-8.31-8.308 0-4.58 3.729-8.308 8.31-8.308"}),a.createElement("path",{d:"M326.169 356.778c-4.608-20.494-16.665-32.974-22.36-38.441a76.7 76.7 0 013.984 12.545c1.569 6.95 2.219 13.674 1.985 20.554-.006.193-.035.38-.077.562a49.412 49.412 0 0118.185 22.554c.139-6.01-.418-11.997-1.717-17.774m-55.152-11.866a48.987 48.987 0 0111.239-1.313c7.694 0 14.98 1.783 21.47 4.949a74.272 74.272 0 00-1.845-16.332c-2.415-10.696-6.664-18.27-9.76-23.135-8.12-5.194-19.32-10.255-34.45-13.325 9.88 15.04 14.362 31.548 13.346 49.156m-30.591-61.684v83.767a49.396 49.396 0 0123.956-20.015c1.587-17.966-2.98-34.741-13.59-49.862l-1.18-1.684c-3.438-4.91-6.265-8.95-9.186-12.206m4.686 132.08c.35.404.703.81 1.114 1.183 1.183 1.212 2.607 2.275 4.11 3.266 1.56.914 3.226 1.714 5.002 2.268.44.145.9.223 1.35.342.46.13.894.204 1.312.256.455.05.778.169 1.34.184l1.616.075.123.008.024-.001.087-.005.348-.018.697-.032c.469 0 .93-.052 1.386-.14.925-.104 1.82-.328 2.714-.555 1.756-.552 3.44-1.283 4.967-2.228 1.483-.994 2.91-2.048 4.054-3.293.633-.568 1.087-1.26 1.647-1.848.465-.652.964-1.27 1.359-1.913.79-1.29 1.453-2.541 1.957-3.704.237-.593.456-1.148.66-1.662l.458-1.447c.305-.878.412-1.653.549-2.141.128-.5.194-.766.194-.766l.194.77c.14.498.243 1.233.55 2.125.14.443.295.934.462 1.468.223.517.429 1.077.662 1.665a30.81 30.81 0 001.966 3.71c.4.642.895 1.263 1.366 1.913.56.59 1.013 1.284 1.653 1.85 1.14 1.249 2.578 2.3 4.066 3.29 1.524.955 3.22 1.67 4.979 2.223l1.348.33c.448.106.854.127 1.28.21l.643.106.808.037.809.037.382.018.064-.005.174-.01c1.877.002 3.73-.371 5.525-.87 1.788-.543 3.459-1.364 5.03-2.27 1.519-.985 2.95-2.05 4.152-3.255.397-.355.74-.744 1.079-1.13a43.206 43.206 0 006.362-22.618c0-23.974-19.505-43.48-43.478-43.48-19.874 0-43.48 15.249-43.48 43.48a43.22 43.22 0 006.336 22.577m37.144 20.9c9.559 0 18.403-3.107 25.588-8.357-1.364.293-2.761.48-4.175.502l-.23.01-.115.006-.248-.011-.405-.024-.808-.05-.808-.05-.954-.143c-.63-.112-1.302-.188-1.887-.36l-1.743-.513c-2.272-.8-4.373-1.928-6.164-3.311-1.756-1.418-3.315-2.953-4.458-4.643-.626-.8-1.07-1.694-1.558-2.5-.396-.864-.798-1.681-1.101-2.497a20.82 20.82 0 01-1.012-3.644 20.73 20.73 0 01-1.004 3.618c-.297.815-.704 1.627-1.093 2.492-.485.806-.932 1.693-1.552 2.496-1.141 1.684-2.684 3.223-4.433 4.642-1.786 1.38-3.876 2.513-6.14 3.324-1.148.348-2.31.717-3.525.869-.6.117-1.204.193-1.818.212l-.916.055-.458.026-.115.005-.058.004h-.03l-.17-.004-.201-.01-1.615-.095c-.515-.02-1.243-.171-1.85-.26-.15-.022-.29-.052-.436-.077 7.168 5.207 15.974 8.289 25.492 8.289m49.13-43.478c0 27.09-22.04 49.13-49.13 49.13-27.092 0-48.717-22.04-48.717-49.13V275.847c0-1.223 1.104-2.34 2.195-2.89a3.235 3.235 0 013.38.288c5.23 3.866 9.072 8.927 13.832 15.678.03.004.06.002.092.007 18.943 3.025 32.639 9.04 42.319 15.244.488.16 8.738 6.323 11.397 8.845 4.905 4.647 19.83 18.792 25.153 42.468 2.653 11.798-.52 37.129-.52 37.244"}))))}var We=a.forwardRef(Ve);n.p;var Qe=Object(u.a)("div",{target:"e1o1sysb0"})({name:"1sw8vsk",styles:"text-align:center;svg{width:250px;height:250px;margin:-20px 0;}"}),Ke=function(){var e=Object(a.useState)(!1),t=Object(k.a)(e,2),n=t[0],r=t[1],i=z().login,c=function(){var e=Object(Ge.a)(_e.a.mark((function e(t){var n,a,c;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=new FormData(t.currentTarget),r(!0),e.prev=3,e.next=6,Ue("login_api",n);case 6:a=e.sent,c={id:a.userId,email:n.get("username"),token:a.token},i(c),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),e.t0 instanceof Ne.a&&401===e.t0.code?alert("Identifiant ou mot de passe incorrect"):x(e.t0),r(!1);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(Me.a,{maxWidth:"xs",children:[Object(f.jsxs)(Qe,{children:[Object(f.jsx)(We,{}),Object(f.jsx)(p.a,{variant:"h1",children:"Planning"})]}),Object(f.jsxs)("form",{onSubmit:c,children:[Object(f.jsx)("p",{children:"Cette application permet de g\xe9rer le planning des PIAFs du magasin. Connectez-vous avec vos identifiants habituels."}),Object(f.jsx)(ze.a,{type:"email",name:"username",label:"E-mail",fullWidth:!0,variant:"outlined",margin:"normal"}),Object(f.jsx)(ze.a,{type:"password",name:"password",label:"Mot de passe",fullWidth:!0,variant:"outlined",margin:"normal"}),Object(f.jsx)(Te.a,{type:"submit",fullWidth:!0,size:"large",variant:"contained",color:"primary",disabled:n,children:"Connexion"})]})]})},Je=function(){var e=Object(De.g)().pathname;return Object(f.jsx)(Me.a,{children:Object(f.jsxs)(De.d,{children:[Object(f.jsx)(De.b,{path:"/login",children:Object(f.jsx)(Ke,{})}),Object(f.jsx)(De.a,{to:"/login?next=".concat(e)})]})})},Ye=n(299),Xe=n(300),Ze=n(301),et=n(194),tt=Object(a.createContext)({}),nt=function(){return Object(Ye.a)(new Date)},rt=function(){return Object(Xe.a)(new Date)},at=function(e){var t=e.children,n=Object(a.useState)(nt),r=Object(k.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(rt),u=Object(k.a)(o,2),l=u[0],d=u[1],j=Object(s.useQuery)(Oe,{variables:{after:i,before:l}}),b=j.data,p=j.loading,m=j.error,h=j.refetch;return Object(f.jsx)(tt.Provider,{value:{start:i,end:l,goBack:function(){var e=Object(Ze.a)(i,1);c(e),d(Object(Xe.a)(e))},goForward:function(){var e=Object(et.a)(i,1);c(e),d(Object(Xe.a)(e))},goToday:function(){c(nt),d(rt)},data:b,loading:p,error:m,refetch:h},children:t})};function it(){return Object(a.useContext)(tt)}var ct,ot=n(34),st=n(6),ut=n(53),lt=n(183),dt=n(35),jt=n(118),bt=n(339),pt=n(309),ft=n(310),mt=n(296),ht=n(89),Ot=n(343),vt=n(344),xt=n(314),gt=n(249),yt=n(252),Ct=n(315),It=n(248),wt=n(156),Pt=n(302),At=n(303),St=n(304),kt=n(305),Ft=n(306),qt=n(307),Et=n(308),Dt=n(311),Mt=n(312),$t=n(313),_t=n(198),Gt=function(e){var t=e.href,n=Object(_t.a)(e,["href"]);return(null===t||void 0===t?void 0:t.startsWith("/"))?Object(f.jsx)(Ee.b,Object(A.a)({to:t},n)):Object(f.jsx)("a",Object(A.a)({href:t},n))};!function(e){e.GrandHibou="GH",e.Chouettos="CH",e.Caissier="CA",e.GrandHibou_Formation="GHF",e.Caissier_Formation="CAF",e.GrandHibou_Acc="GHA",e.Caissier_Acc="CAA",e.AdminMag="MAG",e.AdminBdM="BDM",e.PIAF="P",e.Formation="F",e.Acc="A"}(ct||(ct={}));var zt=function(e){switch(e){case ct.Caissier:return ct.Caissier_Acc;case ct.GrandHibou:return ct.GrandHibou_Acc;default:return null}},Tt=function(e,t){return t.find((function(t){return t.roleUniqueId===e}))},Rt=function(e,t){if(e){if(t==ct.GrandHibou)return!e.nbPiafGH||0==e.nbPiafGH;if(t==ct.Caissier)return!e.nbPiafGH||0==e.nbPiafGH}return!1},Nt=function(e){return e.map((function(e){return e.libelle})).join(", ")},Ut=260,Ht=Object(jt.a)(bt.a)({flexGrow:1}),Lt=Object(ut.a)((function(e){return Object(lt.a)({root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:Ut,width:"calc(100% - ".concat(Ut,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:Ut,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:Ut,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(ot.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(A.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,padding:e.spacing(3)},menuItem:{textDecoration:"none",color:e.palette.secondary.main},activeItem:{textDecoration:"none",color:e.palette.primary.main}})})),Bt=[{title:"Accueil",href:"/home",Icon:Pt.a,role:ct.Chouettos},{title:"Planning",href:"/planning",Icon:At.a,role:ct.Chouettos},{title:"R\xe9serve",href:"/reserve",Icon:St.a,role:ct.Chouettos},{title:"Mon profil",href:"/profile",Icon:kt.a,role:ct.Chouettos},{title:"Groupe MAG",href:"/magasin",Icon:Ft.a,role:ct.AdminMag},{title:"Groupe BdM",href:"/bdm",Icon:qt.a,role:ct.AdminBdM},{title:"Espace membre",href:"https://espace-membres.lachouettecoop.fr/page/homepage",Icon:Et.a,role:ct.Chouettos}],Vt=function(){var e,t,n=Lt(),r=z(),i=r.user,c=r.logout,o=Object(dt.a)(),s=Object(a.useState)(!1),u=Object(k.a)(s,2),l=u[0],d=u[1],j=Object(De.g)().pathname;if(!Object(pt.a)(o.breakpoints.up("sm")))return null;var b=(null===i||void 0===i?void 0:i.rolesChouette)||[];return Object(f.jsxs)("div",{className:n.root,children:[Object(f.jsx)(ft.a,{position:"fixed",className:Object(st.a)(n.appBar,Object(ot.a)({},n.appBarShift,l)),children:Object(f.jsxs)(mt.a,{children:[Object(f.jsx)(ht.a,{color:"inherit","aria-label":"open drawer",onClick:function(){d(!0)},edge:"start",className:Object(st.a)(n.menuButton,Object(ot.a)({},n.hide,l)),children:Object(f.jsx)(Dt.a,{})}),Object(f.jsxs)(p.a,{variant:"h6",noWrap:!0,children:["Planning ",Z&&Object(f.jsx)(Ot.a,{label:"TEST"})]}),Object(f.jsx)(Ht,{}),Object(f.jsx)(Te.a,{onClick:c,color:"inherit",children:"D\xe9connexion"})]})}),Object(f.jsx)(mt.a,{}),Object(f.jsxs)(vt.a,{variant:"permanent",className:Object(st.a)(n.drawer,(e={},Object(ot.a)(e,n.drawerOpen,l),Object(ot.a)(e,n.drawerClose,!l),e)),classes:{paper:Object(st.a)((t={},Object(ot.a)(t,n.drawerOpen,l),Object(ot.a)(t,n.drawerClose,!l),t))},children:[Object(f.jsx)("div",{className:n.toolbar,children:Object(f.jsx)(ht.a,{onClick:function(){d(!1)},children:"rtl"===o.direction?Object(f.jsx)(Mt.a,{}):Object(f.jsx)($t.a,{})})}),Object(f.jsx)(xt.a,{}),Object(f.jsxs)(gt.a,{children:[Object(f.jsx)(yt.a,{children:Object(f.jsx)(kt.a,{})}),i&&Object(f.jsx)(Ct.a,{primary:"".concat(i.prenom," ").concat(i.nom)})]}),Object(f.jsx)(xt.a,{}),Object(f.jsx)(It.a,{children:Bt.filter((function(e){var t=e.role;return Tt(t,b)})).map((function(e){var t=e.href,r=e.title,a=e.Icon,i=j===t;return Object(f.jsx)(Gt,{className:i?n.activeItem:n.menuItem,href:t,children:Object(f.jsx)(wt.a,{title:r,children:Object(f.jsxs)(gt.a,{button:!0,children:[Object(f.jsx)(yt.a,{children:Object(f.jsx)(a,{color:i?"primary":"secondary"})}),Object(f.jsx)(Ct.a,{primary:r})]})})},t)}))})]})]})},Wt=n(197),Qt=n(83),Kt=n(316),Jt=Object(ut.a)((function(e){return Object(lt.a)({appBar:{top:"auto",bottom:0},toolbar:{justifyContent:"space-between"},label:{flexDirection:"column"},menu:{"& ul":{paddingTop:"0 !important",paddingBottom:"0 !important"}},textMenuDecoration:{textDecoration:"none"},menuItem:{color:"rgba(255, 255, 255, 0.54)",backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},activeItem:{color:"white",backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},icon:{justifyContent:"center","& svg":{fill:"rgba(255, 255, 255, 0.54)"}},activeIcon:{justifyContent:"center","& svg":{fill:"white"}}})})),Yt=[{title:"Accueil",href:"/home",Icon:Pt.a,role:ct.Chouettos},{title:"Planning",href:"/planning",Icon:At.a,role:ct.Chouettos},{title:"R\xe9serve",href:"/reserve",Icon:St.a,role:ct.Chouettos}],Xt=[{title:"Mon profil",href:"/profile",role:ct.Chouettos},{title:"Espace membre",href:"/member",role:ct.Chouettos},{title:"Groupe MAG",href:"/magasin",role:ct.AdminMag},{title:"Groupe BdM",href:"/bdm",role:ct.AdminBdM}];function Zt(){var e=Jt(),t=z(),n=t.user,r=t.logout,i=Object(a.useState)(null),c=Object(k.a)(i,2),o=c[0],s=c[1],u=Object(dt.a)(),l=Object(De.g)().pathname,d=Object(pt.a)(u.breakpoints.down("xs")),j=function(){s(null)},b=(null===n||void 0===n?void 0:n.rolesChouette)||[];return d?Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(ft.a,{position:"fixed",color:"primary",className:e.appBar,children:Object(f.jsxs)(mt.a,{className:e.toolbar,children:[Yt.filter((function(e){var t=e.role;return Tt(t,b)})).map((function(t){var n=t.href,r=t.title,a=t.Icon,i=l===n;return Object(f.jsxs)(gt.a,{button:!0,className:e.label,component:Ee.b,to:n,children:[Object(f.jsx)(yt.a,{className:i?e.activeIcon:e.icon,children:Object(f.jsx)(a,{})}),Object(f.jsx)(Ct.a,{className:i?e.activeItem:e.menuItem,primary:r})]},r)})),Object(f.jsxs)(Wt.a,{id:"simple-menu",className:e.menu,anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:j,children:[Xt.filter((function(e){var t=e.role;return Tt(t,b)})).map((function(t){var n=t.href,r=t.title,a=l===n;return Object(f.jsx)(Qt.a,{className:a?e.activeItem:e.menuItem,onClick:j,component:Ee.b,to:n,children:r},r)})),Object(f.jsx)(Qt.a,{onClick:r,className:e.menuItem,color:"inherit",children:"D\xe9connexion"},"Logout")]}),Object(f.jsx)(ht.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},edge:"end",color:"inherit",children:Object(f.jsx)(Kt.a,{})})]})})}):null}var en=n(329),tn=n(253);var nn=Object(u.a)(tn.a,{target:"exfr9vd0"})({name:"1k6141t",styles:"margin:16px 0"}),rn=n(326),an=n(327),cn=n(328),on=n(250),sn=n(160),un=function(e){var t=e.role,n=e.piaffeur;if(n){if(t.roleUniqueId===ct.GrandHibou&&!n.nbPiafGH)return ct.GrandHibou_Formation;if(t.roleUniqueId===ct.Caissier&&!n.nbPiafCaisse)return ct.Caissier_Formation}return t.roleUniqueId},ln=function(e){return"remplacement"!==e.statut&&Boolean(e.piaffeur)},dn=function(e,t){return e.creneau.debut>t.creneau.debut?1:-1},jn=function(e,t){return e.role.id>t.role.id?1:-1},bn={CA:n.p+"static/media/ca.b47d9fee.svg",CAA:n.p+"static/media/caa.f4457990.svg",CAF:n.p+"static/media/caf.7fd9d842.svg",CH:n.p+"static/media/ch.7513f395.svg",GH:n.p+"static/media/gh.a3fdca6f.svg",GHA:n.p+"static/media/gha.bd476097.svg",GHF:n.p+"static/media/ghf.c11dd89e.svg",P:n.p+"static/media/piaf.44236479.svg",F:n.p+"static/media/formation.89c70634.svg",A:n.p+"static/media/acc.60814349.svg"},pn=Object(u.a)("span",{target:"emw2y5h0"})("flex-shrink:0;display:inline-block;margin:3px;width:32px;height:32px;background-image:",(function(e){var t,n=e.$role;return(t=n)?"url(".concat(bn[t]||bn.CH,")"):"none"}),";background-size:100%;background-position:center center;background-repeat:no-repeat;opacity:",(function(e){return e.$taken?.25:1}),";"),fn=function(e){var t=e.piaf;return Object(f.jsx)(pn,{$taken:ln(t),$role:un(t)})},mn=n(317),hn=n(318),On=n(11),vn=n(319),xn=n(325),gn=n(80),yn=n(151),Cn=n(322),In=n(323),wn=n(324),Pn=n(320),An=n(321),Sn=function(e){var t=e.open,n=e.handleClose,r=e.title,a=e.message,i=e.callback,c=function(e){return function(){i&&setTimeout(i,300,e),n()}};return Object(f.jsxs)(mn.a,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(f.jsx)(hn.a,{id:"alert-dialog-title",children:r}),Object(f.jsx)(vn.a,{children:Object(f.jsx)(Pn.a,{id:"alert-dialog-description",children:a})}),i?Object(f.jsxs)(An.a,{children:[Object(f.jsx)(Te.a,{onClick:c(!0),color:"primary",children:"Oui"}),Object(f.jsx)(Te.a,{onClick:c(!1),color:"primary",children:"Non"})]}):Object(f.jsx)(An.a,{children:Object(f.jsx)(Te.a,{onClick:n,color:"primary",children:"OK"})})]})},kn=Object(a.createContext)({}),Fn=function(e){var t=e.children,n=Object(a.useState)(!1),r=Object(k.a)(n,2),i=r[0],c=r[1],o=Object(a.useState)(""),s=Object(k.a)(o,2),u=s[0],l=s[1],d=Object(a.useState)(""),j=Object(k.a)(d,2),b=j[0],p=j[1],m=Object(a.useState)(),h=Object(k.a)(m,2),O=h[0],v=h[1],x=function(){c(!1)};return Object(f.jsxs)(kn.Provider,{value:{openDialog:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";p(e),l(t),v(void 0),c(!0)},openQuestion:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return p(e),l(t),new Promise((function(e){v((function(){return e})),c(!0)}))},closeDialog:x},children:[t,Object(f.jsx)(Sn,{open:i,handleClose:x,title:u,message:b,callback:O})]})},qn=function(){return Object(a.useContext)(kn)},En=n(338),Dn=n(196),Mn=function(e){return"object"!==typeof e?new Date(e):e},$n=function(e,t){return Object(En.a)(Mn(e),t,{locale:Dn.a})},_n=function(e){return $n(e,"EEEE d MMMM yyyy")},Gn=function(e){return $n(e,"HH:mm")},zn=function(e,t){e=Mn(e),t=Mn(t);var n="d";if(e.getFullYear()!==t.getFullYear())n="d MMMM yyyy";else if(e.getMonth()!==t.getMonth())n="d MMMM";else if(e.getDate()===t.getDate())return _n(e);return"du ".concat($n(e,n)," au ").concat($n(t,"d MMMM yyyy"))},Tn=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],Rn=function(e){return Object(En.a)(e,"yyyy-MM-dd")};var Nn=[ct.Caissier],Un=Object(u.a)("div",{target:"e181b5zh3"})({name:"13i0wi",styles:"margin:0 0 1rem 0;display:flex;align-items:center;justify-content:center;flex-wrap:wrap"}),Hn=Object(u.a)("div",{target:"e181b5zh2"})("flex:1;margin:0 8px;span{color:",(function(e){return e.theme.palette.grey[600]}),";}"),Ln=Object(u.a)("div",{target:"e181b5zh1"})({name:"2qga7i",styles:"text-align:right"}),Bn=Object(u.a)("div",{target:"e181b5zh0"})({name:"4zleql",styles:"display:block"}),Vn=function(){var e=Object(Ge.a)(_e.a.mark((function e(t,n,r){var a,i,c,o;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="day"===r?Object(gn.a)(t.start):Object(yn.a)(t.start),i="day"===r?Object(Cn.a)(t.start):Object(In.a)(t.start),e.next=4,ne.query({query:he,variables:{userId:n,after:a,before:i}});case 4:return c=e.sent,o=c.data,e.abrupt("return",o.piafs.filter((function(e){return"occupe"===e.statut&&!1===e.nonPourvu})).length);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Wn=function(e,t){if(0===e.nbPiafEffectuees){var n=t.infoCreneau.piaffeursCount,r=Math.floor(50*n/100);if(t.infoCreneau.piaffeursCountFirstPiaf>=r)return!1}return!0},Qn=function(e,t){var n,r=null===(n=e.piafs)||void 0===n?void 0:n.find((function(e){var n=e.statut,r=e.role;return"remplacement"===n&&r.id===t.role.id}));return r||t},Kn=function(e,t,n){var r=e.piaffeur.email;if(r&&He(r,"PIAF remplac\xe9e","Votre PIAF du ".concat(_n(t.start),"  \xe0 ").concat(Gn(t.start)," a \xe9t\xe9 pourvue. Vous n'\xeates plus en charge de cette PIAF.")),e.role.roleUniqueId!=ct.GrandHibou){var a=function(e){var t,n,r=null===(t=e.piafs)||void 0===t?void 0:t.find((function(e){var t=e.statut,n=e.role;return"occupe"===t&&n.id===ct.GrandHibou}));return r?null===(n=r.piaffeur)||void 0===n?void 0:n.email:""}(t);a&&He(a,"PIAF remplac\xe9e","La PIAF du ".concat(_n(t.start),"  \xe0 ").concat(Gn(t.start),"  a \xe9t\xe9 pourvue.\n        ").concat(n.prenom," ").concat(n.nom," est maintenant inscrit pour cette PIAF."))}},Jn=function(e){var t,n=e.piaf,r=e.user,i=e.slot,c=Object(a.useState)(!1),o=Object(k.a)(c,2),s=o[0],u=o[1],l=Object(a.useState)(""),d=Object(k.a)(l,2),j=d[0],b=d[1],p=qn(),m=p.openDialog,h=p.openQuestion,O=null===(t=i.piafs)||void 0===t?void 0:t.find((function(e){var t=e.piaffeur,n=e.statut;return(null===t||void 0===t?void 0:t.id)===(null===r||void 0===r?void 0:r.id)&&"occupe"===n})),v=Object(a.useContext)(Se).roles,g=it().refetch,y=function(){var e=Object(Ge.a)(_e.a.mark((function e(){var t,a,c,o,s;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),e.prev=1,(t=null===r||void 0===r?void 0:r.rolesChouette)&&Tt(n.role.roleUniqueId,t)){e.next=7;break}return u(!1),m("Pour t\u2019inscrire \xe0 cette PIAF, tu dois d\u2019abord passer la formation ".concat(n.role.libelle)),e.abrupt("return");case 7:return a=r,e.next=10,Vn(i,a.id,"week");case 10:if(!(e.sent>=3)){e.next=15;break}return u(!1),m("Il n\u2019est pas possible de s\u2019inscrire \xe0 plus de ".concat(3," PIAF par semaine")),e.abrupt("return");case 15:return e.next=17,Vn(i,a.id,"day");case 17:if(!(e.sent>=2)){e.next=22;break}return u(!1),m("Il n\u2019est pas possible de s\u2019inscrire \xe0 plus de ".concat(2," PIAF par jour")),e.abrupt("return");case 22:if(Wn(a,n)){e.next=26;break}return u(!1),m("Il n\u2019est pas possible d\u2019avoir plus de ".concat(50,"% de nouveaux chouettos par PIAF")),e.abrupt("return");case 26:return"remplacement"===(c=Qn(i,n)).statut&&Kn(c,i,a),e.next=30,ne.mutate({mutation:ve,variables:{piafId:c.id,userId:a.id,statut:"occupe",informations:j}});case 30:if(o=!0,!Rt(r,n.role.roleUniqueId)){e.next=41;break}if(s=!0,!Nn.includes(n.role.roleUniqueId)){e.next=37;break}return e.next=36,h("Voulez vous avoir une personne en appui pour votre premi\xe8re PIAF comme ".concat(n.role.libelle," ?"));case 36:s=e.sent;case 37:if(!s){e.next=41;break}return e.next=40,C(n.role.roleUniqueId);case 40:o=e.sent;case 41:o&&m("Inscription effectu\xe9e. Merci !"),e.next=47;break;case 44:e.prev=44,e.t0=e.catch(1),x(e.t0);case 47:u(!1);case 48:case"end":return e.stop()}}),e,null,[[1,44]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(Ge.a)(_e.a.mark((function e(t){var n,r;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=zt(t))){e.next=13;break}if(!(r=v.find((function(e){return e.roleUniqueId==n})))){e.next=9;break}return e.next=6,ne.mutate({mutation:Pe,variables:{idCreneau:i.id,idRole:r.id}});case 6:g(),e.next=11;break;case 9:return m("Le role ".concat(n," n'a pas pu \xeatre trouv\xe9. Svp, contactez votre administrateur")),e.abrupt("return",!1);case 11:e.next=15;break;case 13:return m("Il n'y a pas un role formateur pour ".concat(t,". Svp, contactez votre administrateur")),e.abrupt("return",!1);case 15:return e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(Ge.a)(_e.a.mark((function e(){var t;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,b(""),t=r.id,e.next=6,ne.mutate({mutation:ve,variables:{piafId:n.id,userId:t,statut:"remplacement",informations:null}});case 6:Rt(r,n.role.roleUniqueId)?m("D\xe9sinscription effectu\xe9e ! Svp, mettez vous en contact avec le BdM pour enlever la PIAF accompagnateur\xb7trice"):m("D\xe9sinscription effectu\xe9e : la PIAF est d\xe9sormais en recherche de remplacement !"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),x(e.t0);case 12:u(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),w=n.id,P=n.piaffeur,A=ln(n),S=v.find((function(e){return e.roleUniqueId==un(n)}));return Object(f.jsxs)(Un,{children:[Object(f.jsx)(fn,{piaf:n}),Object(f.jsxs)(Hn,{children:[A&&P?"".concat(P.prenom," ").concat(P.nom):"Place disponible",Object(f.jsx)("br",{}),Object(f.jsxs)("span",{children:[" ",null===S||void 0===S?void 0:S.libelle]})]}),A&&O&&O.role.roleUniqueId===ct.GrandHibou&&P&&P.id!=(null===r||void 0===r?void 0:r.id)&&Object(f.jsxs)(Ln,{children:[Object(f.jsx)("a",{href:"mailto:".concat(P.email),children:P.email}),Object(f.jsx)("br",{}),Object(f.jsx)("a",{href:"tel:".concat(P.telephone),children:P.telephone}),Object(f.jsx)("div",{children:n.informations})]}),!A&&!O&&!Object(wn.a)(i.start)&&Object(f.jsx)(ze.a,{name:"informations",multiline:!0,label:"Information (optionnel)",value:j,onChange:function(e){var t=e.target;b(t.value)}}),!A&&!O&&!Object(wn.a)(i.start)&&Object(f.jsx)(Te.a,{disabled:s,color:"primary",variant:"contained",onClick:y,children:"S\u2019inscrire"}),(null===P||void 0===P?void 0:P.id)===(null===r||void 0===r?void 0:r.id)&&A&&!Object(wn.a)(i.start)&&Object(f.jsxs)(Bn,{children:[Object(f.jsx)("div",{children:n.informations}),Object(f.jsx)(Te.a,{disabled:s,color:"primary",variant:"contained",onClick:I,children:"Demander un remplacement"})]})]},w)};var Yn=Object(u.a)(ht.a,{target:"e1el6lcd1"})({name:"vgkzfy",styles:"position:absolute;right:8px;top:8px"}),Xn=Object(u.a)("div",{target:"e1el6lcd0"})("h3{font-size:1.5em;margin-bottom:8px;}h4{font-size:1.2em;}span{color:",(function(e){return e.theme.palette.grey[600]}),";margin-left:5px;font-weight:500;}"),Zn=function(e){var t=e.slot,n=e.show,r=e.handleClose,a=z().user;return Object(f.jsxs)(mn.a,{open:n,onClose:r,fullWidth:!0,children:[Object(f.jsx)(Yn,{onClick:r,children:Object(f.jsx)(xn.a,{})}),Object(f.jsx)(hn.a,{disableTypography:!0,children:Object(f.jsxs)(Xn,{children:[Object(f.jsx)(p.a,{variant:"h3",children:Object(On.a)(_n(t.start))}),Object(f.jsxs)(p.a,{variant:"h4",children:[Object(f.jsxs)("strong",{children:[Gn(t.start),"\u2013",Gn(t.end)]}),Object(f.jsx)("span",{children:t.title})]}),Object(f.jsx)("div",{children:t.information})]})}),Object(f.jsx)(vn.a,{children:t.piafs?t.piafs.map((function(e){return Object(f.jsx)(Jn,{piaf:e,user:a,slot:t},e.id)})):Object(f.jsx)(nn,{})})]})};var er=Object(u.a)(rn.a,{target:"eaqzuha0"})({name:"m832pm",styles:"border:1px solid gray;border-radius:5px;margin-bottom:2px"}),tr=function(e){var t=e.piaf,n=e.allowValidate,r=void 0!==n&&n,i=t.creneau,c=Object(a.useState)(!1),o=Object(k.a)(c,2),u=o[0],l=o[1],d=qn(),j=d.openQuestion,b=d.openDialog,p=Object(s.useLazyQuery)(fe,{variables:{id:i.id}}),m=Object(k.a)(p,2),h=m[0],O=m[1].data,v=function(){var e=Object(Ge.a)(_e.a.mark((function e(t){var n;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("\xcates-vous s\xfbr\xb7e de vouloir valider cette PIAF ?");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return n={piafId:t,validate:!0},e.prev=6,e.next=9,ne.mutate({mutation:xe,variables:n});case 9:b("La PIAF a \xe9t\xe9 valid\xe9e"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),x(e.t0);case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(Ge.a)(_e.a.mark((function e(t){var n;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("\xcates-vous s\xfbr\xb7e de vouloir indiquer cette PIAF comme non pourvue?");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return n={piafId:t,nonPourvu:!0},e.prev=6,e.next=9,ne.mutate({mutation:ge,variables:n});case 9:b("La PIAF a \xe9t\xe9 indiqu\xe9 comme non pourvue"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),x(e.t0);case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}(),y={id:i.id,title:i.titre,information:i.informations,start:new Date(i.debut),end:new Date(i.fin),piafs:null===O||void 0===O?void 0:O.creneau.piafs},C=r?er:rn.a;return Object(f.jsxs)(C,{container:!0,children:[Object(f.jsx)(rn.a,{item:!0,xs:8,children:Object(f.jsxs)(gt.a,{button:!0,onClick:function(){l(!0),h()},children:[Object(f.jsx)(an.a,{children:Object(f.jsx)(fn,{piaf:t})}),Object(f.jsx)(Ct.a,{primary:_n(y.start),secondary:"de ".concat(Gn(y.start)," \xe0 ").concat(Gn(y.end))})]},t.id)}),Object(f.jsx)(rn.a,{item:!0,xs:4,children:r&&Object(f.jsxs)(cn.a,{children:[Object(f.jsx)(on.a,{control:Object(f.jsx)(sn.a,{checked:t.pourvu,name:"validatePIAF",onChange:function(){v(t.id)}}),label:"Valider"}),Object(f.jsx)(on.a,{control:Object(f.jsx)(sn.a,{checked:t.nonPourvu,name:"nonPourvu",onChange:function(){g(t.id)}}),label:"Non pourvue"})]})}),Object(f.jsx)(Zn,{show:u,slot:y,handleClose:function(){l(!1)}})]})},nr=function(e){var t=e.userId,n=e.after,r=e.validated,a=void 0!==r&&r,i=e.allowValidate,c=void 0!==i&&i,o=Object(s.useQuery)(me,{variables:{userId:t,after:n,validated:a},skip:!t}),u=o.loading,l=o.error,d=o.data;if(u||!t)return Object(f.jsx)(nn,{});if(l)return Object(f.jsx)(w,{error:l});if(!d)return null;if(!d.piafs.length&&!c)return Object(f.jsx)("p",{children:"Aucune PIAF \xe0 venir. Inscrivez-vous sur le planning !"});if(!d.piafs.length&&c)return Object(f.jsx)("p",{children:"Aucune PIAF \xe0 valider."});var j=d.piafs.filter((function(e){var t=e.statut,n=e.nonPourvu;return"remplacement"!==t&&0==n})).sort(dn);return Object(f.jsx)(It.a,{children:j.map((function(e){return Object(f.jsx)(tr,{piaf:e,allowValidate:c},e.id)}))})},rr=function(){var e=z(),t=e.auth,n=e.user,r=Object(s.useQuery)(me,{variables:{after:Rn(Object(en.a)()),before:Rn(Object(et.a)(Object(en.a)(),2)),statut:"remplacement"}}),a=r.loading,i=r.error,c=r.data;if(a)return Object(f.jsx)(nn,{});if(i)return Object(f.jsx)(w,{error:i});if(!c)return null;var o=(null===n||void 0===n?void 0:n.rolesChouette)||[],u=c.piafs.filter((function(e){var n;return function(e){if("number"===typeof e)return e;if("string"===typeof e){var t=e.match(/api\/\w+\/(\d+)/);if(t)return Number(t[1])}return null}(null===(n=e.piaffeur)||void 0===n?void 0:n.id)!==t.id&&Tt(e.role.roleUniqueId,o)})).sort(dn);return u.length?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{children:"Les cr\xe9neaux suivants sont vacants et donc disponibles pour un remplacement. N\u2019h\xe9sites pas \xe0 te positionner, la personne que tu remplaces sera avertie par e-mail instantan\xe9ment !"}),Object(f.jsx)(It.a,{children:u.map((function(e){return Object(f.jsx)(tr,{piaf:e},e.id)}))})]}):Object(f.jsx)("p",{children:"Aucun remplacement \xe0 venir n\u2019est demand\xe9."})};var ar={"tr\xe8s chouette":"#2ECC40",chouette:"#FF851B","chouette en alerte":"#FF4136"},ir=Object(u.a)(p.a,{target:"eeumoro6"})("color:",(function(e){var t=e.$status,n=e.theme;return t&&ar[t]||n.palette.secondary.main}),";&::first-letter{text-transform:uppercase;}"),cr=Object(u.a)("div",{target:"eeumoro5"})({name:"7ejfwp",styles:"min-height:calc(100vh - 132px);display:flex;flex-direction:column;justify-content:space-between"}),or=Object(u.a)("div",{target:"eeumoro4"})("font-size:0.85em;margin-top:",(function(e){return e.theme.spacing(4)}),"px;"),sr=Object(u.a)("div",{target:"eeumoro3"})({name:"7kydvz",styles:"display:flex;flex-wrap:wrap;>div{flex:0 1 50%;min-width:300px;}"}),ur=Object(u.a)("div",{target:"eeumoro2"})({name:"tjnilk",styles:"h3{font-size:2.5rem;margin-bottom:2rem;span{font-size:0.5em;}}"}),lr=Object(u.a)("div",{target:"eeumoro1"})(""),dr=Object(u.a)("div",{target:"eeumoro0"})(""),jr=function(){var e,t,n=z().user,r=(null===n||void 0===n?void 0:n.id)||"",a="".concat(null!==(e=null===n||void 0===n?void 0:n.nbPiafEffectuees)&&void 0!==e?e:"\u2026","/").concat(null!==(t=null===n||void 0===n?void 0:n.nbPiafAttendues)&&void 0!==t?t:"\u2026"),i=(null===n||void 0===n?void 0:n.statut)||"\u2026";return Object(f.jsxs)(cr,{children:[Object(f.jsxs)(sr,{children:[Object(f.jsxs)(ur,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Mon statut"}),Object(f.jsxs)(p.a,{variant:"h3",children:[a," ",Object(f.jsx)("span",{children:"PIAFs attendues"})]}),Object(f.jsx)(p.a,{variant:"h2",children:"Je suis"}),Object(f.jsx)(ir,{variant:"h3",$status:null===n||void 0===n?void 0:n.statut,children:i})]}),Object(f.jsxs)(lr,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Mes prochaines PIAFs"}),Object(f.jsx)(nr,{userId:r,after:Rn(Object(en.a)())})]}),Object(f.jsxs)(dr,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Remplacements"}),Object(f.jsx)(rr,{})]})]}),Object(f.jsxs)(or,{children:[Object(f.jsx)(Ee.b,{to:"/legal",children:"Politique de traitement des donn\xe9es personnelles"}),Object(f.jsx)("p",{children:"Ce site n\u2019utilise pas de cookies tiers"})]})]})},br=n(331),pr=n(333),fr=n(334),mr=n(332),hr=n(346),Or=n(195),vr=n(341),xr=n(330),gr=n(345);var yr="#FFFFAA",Cr=Object(u.a)("button",{target:"e7w31zc2"})("width:100%;border:none;background-color:",(function(e){return e.$open?yr:"transparent"}),";padding:5px;text-align:left;font-size:inherit;line-height:inherit;font:inherit;cursor:pointer;&:focus{background-color:",yr,";outline:none;}"),Ir=Object(u.a)("div",{target:"e7w31zc1"})({name:"88ia8m",styles:"span{color:gray;}"}),wr=Object(u.a)("div",{target:"e7w31zc0"})("display:flex;flex-wrap:wrap;margin:0 -2px;",pn,"{width:24px;height:24px;}"),Pr=function(e){var t,n=e.slot,r=Object(a.useState)(!1),i=Object(k.a)(r,2),c=i[0],o=i[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(Cr,{$open:c,onClick:function(){o(!0)},children:[Object(f.jsxs)(Ir,{children:[Object(f.jsxs)("strong",{children:[Gn(n.start),"\u2013",Gn(n.end)]}),Object(f.jsx)("br",{}),Object(f.jsx)("span",{children:n.title})]}),Object(f.jsx)(wr,{children:null===(t=n.piafs)||void 0===t?void 0:t.map((function(e){return Object(f.jsx)(fn,{piaf:e},e.id)}))})]}),Object(f.jsx)(Zn,{show:c,slot:n,handleClose:function(){o(!1)}})]})};var Ar={1:"#89C7A8",2:"#638F79",3:"#3A5447",4:"#27382F"},Sr=Object(u.a)("div",{target:"exian1q2"})("background-color:",(function(e){var t=e.$when;return Ar[t]}),";height:18px;color:white;font-size:12px;padding:0 4px;"),kr=Object(u.a)("div",{target:"exian1q1"})("opacity:",(function(e){return"past"===e.$when?.25:1}),";border:1px solid gray;min-height:80px;background-color:",(function(e){return"present"===e.$when?"#d0d9d0":"#eee"}),";h3{font-size:1em;margin:4px;}"),Fr=Object(u.a)("ul",{target:"exian1q0"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),qr=function(e){var t,n=e.day,r=e.weekNumber,a=1===n.start.getDay();return Object(f.jsxs)(kr,{$when:Object(gr.a)(n.start)?"present":Object(wn.a)(n.start)?"past":"future",children:[Object(f.jsx)(Sr,{$when:r,children:a&&"Semaine ".concat(r)}),Object(f.jsx)(p.a,{variant:"h3",children:Object(On.a)((t=n.start,$n(t,"EEEE d MMM")))}),Object(f.jsx)(Fr,{children:n.slots.map((function(e){return Object(f.jsx)(Pr,{slot:e},e.id)}))})]})},Er=function(){return Object(f.jsx)(kr,{$when:"past"})};var Dr=Object(u.a)("div",{target:"e1f08xgb1"})({name:"1juea80",styles:"border:1px solid gray;margin:0;padding:0"}),Mr=Object(u.a)("div",{target:"e1f08xgb0"})({name:"17osowq",styles:"@media (min-width: 800px){display:flex;>div{flex:1 0 14.29%;}}"}),$r=function(e){var t=e.start,n=e.end,r=e.list,a=Object(dt.a)(),i=Object(pt.a)(a.breakpoints.down("sm"));if(!r)return null;var c=Object(hr.a)({start:t,end:n},{weekStartsOn:1}).map((function(e){return{start:e,days:[0,1,2,3,4,5,6].map((function(t){return{start:Object(Or.a)(e,t),slots:[]}})),weekNumber:1}}));return r.forEach((function(e){var t=new Date(e.debut),n=Object(vr.a)(t,c[0].start),r=c[n],a=(Object(xr.a)(t)||7)-1,i={piaffeursCount:e.piafs.length,piaffeursCountFirstPiaf:e.piafs.filter((function(e){var t=e.piaffeur;return 0===(null===t||void 0===t?void 0:t.nbPiafEffectuees)})).length},o=e.piafs.map((function(e){return Object(A.a)(Object(A.a)({},e),{},{infoCreneau:i})})).sort(jn);r.days[a].slots.push({id:e.id,title:e.titre,information:e.informations,start:t,end:new Date(e.fin),piafs:o}),r.weekNumber=Number(e.creneauGenerique.frequence)})),Object(f.jsx)(Dr,{children:c.map((function(e,r){return Object(f.jsx)(Mr,{children:e.days.map((function(r,a){return r.start>=t&&r.start<n?Object(f.jsx)(qr,{day:r,weekNumber:e.weekNumber},a):i?null:Object(f.jsx)(Er,{},a)}))},r)}))})};var _r=Object(u.a)("div",{target:"e4heot02"})({name:"1azakc",styles:"text-align:center"}),Gr=Object(u.a)("h3",{target:"e4heot01"})({name:"1oega3v",styles:"margin:0 0 2em"}),zr=Object(u.a)("figcaption",{target:"e4heot00"})({name:"6gj13f",styles:"word-wrap:break-word;padding:0 4px"}),Tr=function(){return Object(f.jsxs)(_r,{children:[Object(f.jsx)(Gr,{children:"L\xe9gende"}),Object(f.jsxs)(rn.a,{container:!0,children:[Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.Chouettos}),Object(f.jsx)(zr,{children:"Chouettos"})]}),Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.Caissier}),Object(f.jsx)(zr,{children:"Caissier\xb7\xe8re"})]}),Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.GrandHibou}),Object(f.jsx)(zr,{children:"Grand Hibou"})]})]}),Object(f.jsx)("br",{}),Object(f.jsxs)(rn.a,{container:!0,children:[Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.PIAF}),Object(f.jsx)(zr,{children:"PIAF disponible"})]}),Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.PIAF,$taken:!0}),Object(f.jsx)(zr,{children:"PIAF occup\xe9e"})]})]}),Object(f.jsx)("br",{}),Object(f.jsxs)(rn.a,{container:!0,children:[Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.Formation}),Object(f.jsx)(zr,{children:"En formation"})]}),Object(f.jsxs)(rn.a,{item:!0,xs:4,component:"figure",children:[Object(f.jsx)(pn,{$role:ct.Acc}),Object(f.jsx)(zr,{children:"Accompagnateur\xb7rice"})]})]})]})},Rr=Tr,Nr=function(){var e=Object(a.useState)(!1),t=Object(k.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)((function(){localStorage.getItem("caption_dismissed")||r(!0)}),[]);return Object(f.jsxs)(mn.a,{open:n,fullWidth:!0,children:[Object(f.jsx)(vn.a,{children:Object(f.jsx)(Tr,{})}),Object(f.jsx)(An.a,{children:Object(f.jsx)(Te.a,{onClick:function(){r(!1),localStorage.setItem("caption_dismissed","true")},color:"primary",children:"Compris !"})})]})};var Ur=Object(u.a)("div",{target:"e1i6h5gm3"})({name:"1ocx2cx",styles:"border:2px solid gray;height:500px;display:flex;align-items:center;justify-content:center"}),Hr=Object(u.a)("nav",{target:"e1i6h5gm2"})({name:"u1kre2",styles:"display:flex;margin-bottom:1rem;button:not(:first-of-type){margin-left:1rem;}h2{flex:1;text-transform:capitalize;}"}),Lr=Object(u.a)("div",{target:"e1i6h5gm1"})({name:"1fghvjy",styles:"display:flex;justify-content:end"}),Br=Object(u.a)("div",{target:"e1i6h5gm0"})({name:"1esf6zn",styles:"max-width:500px;margin:20px 0 100px auto;border:1px solid gray;border-radius:10px;padding:20px 10px"}),Vr=function(e,t){return e.debut>t.debut?1:-1},Wr=function(){var e=it(),t=e.goBack,n=e.goForward,r=e.goToday,a=e.start,i=e.end,c=e.data,o=e.error,s=e.loading,u=Object(dt.a)(),l=Object(pt.a)(u.breakpoints.up("sm")),d=l?"Aujourd\u2019hui":"",j=l?"Pr\xe9c\xe9dent":"",b=l?"Suivant":"";if(o)return Object(f.jsx)(C,{error:o});var m,h=null===c||void 0===c?void 0:c.creneaus.slice().sort(Vr);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(Hr,{children:[Object(f.jsx)(p.a,{variant:"h2",children:(m=a,$n(m,"MMMM yyyy"))}),Object(f.jsxs)(Lr,{children:[Object(f.jsx)(Te.a,{disabled:s,variant:"contained",color:"primary",startIcon:Object(f.jsx)(br.a,{}),onClick:t,children:j}),Object(f.jsx)(Te.a,{disabled:s||Object(mr.a)(a,new Date),variant:"contained",color:"primary",startIcon:Object(f.jsx)(pr.a,{}),onClick:r,children:d}),Object(f.jsx)(Te.a,{disabled:s,variant:"contained",color:"primary",endIcon:Object(f.jsx)(fr.a,{}),onClick:n,children:b})]})]}),s?Object(f.jsx)(Ur,{children:Object(f.jsx)(nn,{})}):Object(f.jsx)($r,{start:a,end:i,list:h}),Object(f.jsx)(Br,{children:Object(f.jsx)(Rr,{})}),Object(f.jsx)(Nr,{})]})},Qr=n(336),Kr=n(337),Jr=n(335),Yr=n(110),Xr=n(163),Zr=n(158);var ea=Object(u.a)("div",{target:"ej6jrjj3"})("display:flex;align-items:center;justify-content:center;flex-wrap:wrap;>*{margin-bottom:1rem;@media (min-width: 400px){flex:1;&:not(:first-of-type){margin-left:",(function(e){return e.theme.spacing(3)}),"px;}}}"),ta=Object(u.a)(ht.a,{target:"ej6jrjj2"})({name:"vgkzfy",styles:"position:absolute;right:8px;top:8px"}),na=Object(u.a)(ze.a,{target:"ej6jrjj1"})({name:"1d3w5wq",styles:"width:100%"}),ra=Object(u.a)(hn.a,{target:"ej6jrjj0"})({name:"d9gf8v",styles:"margin-right:32px"}),aa={noPiaf:"Je ne pourrai pas assurer ma PIAF",noBuy:"Je ne pourrai pas assurer ma PIAF ni effectuer mes courses",other:"Autre (sp\xe9cifier en commentaire)"},ia=function(e){var t=e.show,n=e.handleClose,r=qn().openDialog,i=Object(a.useState)({reason:"",comment:"",startDate:"",endDate:""}),c=Object(k.a)(i,2),o=c[0],s=c[1],u=Object(a.useState)(!1),l=Object(k.a)(u,2),d=l[0],j=l[1],b=function(e){var t=e.target,n=t.name,r=t.value;s(Object(A.a)(Object(A.a)({},o),{},Object(ot.a)({},n,r)))},p=function(){var e=Object(Ge.a)(_e.a.mark((function e(t){var a;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API:"https://adminchouettos.lachouettecoop.fr",REACT_APP_BUGSNAG_KEY:"bd8932c3a4a955397cd4900e01d9ad76",REACT_APP_COMMIT:"901d21928d32916d4d4fe90a90f164c346f7e4ea",REACT_APP_AUTHOR:"antoinerousseau"}).REACT_APP_MAIL_BDM){e.next=4;break}return alert("L\u2019adresse e-mail du BdM n\u2019est pas configur\xe9e. Contactez votre administrateur."),e.abrupt("return");case 4:if(o.startDate&&o.endDate&&o.reason){e.next=7;break}return r("Tous les champs sont obligatoires."),e.abrupt("return");case 7:if(!(o.startDate>o.endDate)){e.next=10;break}return r("La date de d\xe9but ne peut pas \xeatre post\xe9rieure \xe0 la date de fin."),e.abrupt("return");case 10:return j(!0),a=["Raison de l'absence : ".concat(aa[o.reason]),"P\xe9riode : ".concat(zn(o.startDate,o.endDate))],o.comment&&a.push("Commentaire : ".concat(o.comment)),e.next=15,He(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API:"https://adminchouettos.lachouettecoop.fr",REACT_APP_BUGSNAG_KEY:"bd8932c3a4a955397cd4900e01d9ad76",REACT_APP_COMMIT:"901d21928d32916d4d4fe90a90f164c346f7e4ea",REACT_APP_AUTHOR:"antoinerousseau"}).REACT_APP_MAIL_BDM,"Absence prolong\xe9e",a.join("<br />"));case 15:n(),r("Un e-mail informatif a \xe9t\xe9 envoy\xe9 au BdM. Votre absence sera bient\xf4t valid\xe9e."),j(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(mn.a,{open:t,onClose:n,children:Object(f.jsxs)("form",{onSubmit:p,autoComplete:"off",children:[Object(f.jsx)(ta,{onClick:n,children:Object(f.jsx)(xn.a,{})}),Object(f.jsx)(ra,{children:"Informer d\u2019un changement de ma situation"}),Object(f.jsxs)(vn.a,{children:[Object(f.jsxs)(ea,{children:[Object(f.jsx)(ze.a,{id:"startDate",label:"Date de d\xe9but",name:"startDate",type:"date",fullWidth:!0,required:!0,value:o.startDate,onChange:b,InputLabelProps:{shrink:!0}}),Object(f.jsx)(ze.a,{id:"endDate",label:"Date de fin",name:"endDate",type:"date",fullWidth:!0,required:!0,value:o.endDate,onChange:b,InputLabelProps:{shrink:!0}})]}),Object(f.jsx)(ea,{children:Object(f.jsxs)(Yr.a,{fullWidth:!0,children:[Object(f.jsx)(Xr.a,{children:"Type de changement"}),Object(f.jsx)(Zr.a,{value:o.reason,label:"Type de changement",name:"reason",required:!0,onChange:function(e){var t=e.target,n=t.name,r=t.value;s(Object(A.a)(Object(A.a)({},o),{},Object(ot.a)({},n,r)))},children:Object.keys(aa).map((function(e){return Object(f.jsx)(Qt.a,{value:e,children:aa[e]},e)}))})]})}),Object(f.jsx)(ea,{children:Object(f.jsx)(na,{name:"comment",multiline:!0,required:"other"===o.reason,label:"Commentaire additionnel",value:o.comment,onChange:b})}),Object(f.jsx)(ea,{children:Object(f.jsxs)("span",{children:["Pour plus d\u2019informations,"," ",Object(f.jsx)("a",{href:"https://espace-membres.lachouettecoop.fr/page/les-documents",target:"_blank",rel:"noopener",children:"consultez le manuel du\u2022de la coop\xe9rateur\u2022ice"}),"."]})})]}),Object(f.jsx)(An.a,{children:Object(f.jsx)(Te.a,{type:"submit",color:"primary",variant:"contained",disabled:d,children:"Confirmer au BdM"})})]})})};var ca=Object(u.a)("div",{target:"e16mrsvp1"})({name:"1bv1svr",styles:"height:50vh;display:flex;align-items:center;justify-content:center"}),oa=Object(u.a)("div",{target:"e16mrsvp0"})({name:"71mxng",styles:"margin:0 auto;max-width:500px;p,.MuiTextField-root{margin:10px 0;}button{margin:15px auto;display:block;}"}),sa=function(){var e=z().user,t=Object(a.useState)(!1),n=Object(k.a)(t,2),r=n[0],i=n[1],c=qn().openDialog,o=Object(a.useState)(!1),s=Object(k.a)(o,2),u=s[0],l=s[1],d=Object(a.useState)({email:(null===e||void 0===e?void 0:e.email)||"",telephone:(null===e||void 0===e?void 0:e.telephone)||""}),j=Object(k.a)(d,2),b=j[0],m=j[1];Object(a.useEffect)((function(){e&&m({email:e.email,telephone:e.telephone})}),[e]);var h=function(e){var t=e.target,n=t.name,r=t.value;m(Object(A.a)(Object(A.a)({},b),{},Object(ot.a)({},n,r)))},O=function(){var t=Object(Ge.a)(_e.a.mark((function t(n){return _e.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),i(!0),t.prev=2,t.next=5,ne.mutate({mutation:E,variables:Object(A.a)(Object(A.a)({},b),{},{idUser:null===e||void 0===e?void 0:e.id})});case 5:c("Vos informations ont bien \xe9t\xe9 mises \xe0 jour"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),x(t.t0);case 11:i(!1);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}();return e?Object(f.jsxs)(oa,{children:[Object(f.jsxs)("form",{onSubmit:O,children:[Object(f.jsxs)(p.a,{variant:"h2",children:[e.prenom," ",e.nom]}),Object(f.jsx)("p",{children:Nt(e.rolesChouette)}),Object(f.jsx)(ze.a,{name:"telephone",label:"T\xe9l\xe9phone",required:!0,disabled:!e,value:b.telephone,onChange:h,fullWidth:!0,InputProps:{startAdornment:Object(f.jsx)(Jr.a,{position:"start",children:Object(f.jsx)(Qr.a,{})})}}),Object(f.jsx)(ze.a,{name:"email",label:"Adresse e-mail",required:!0,disabled:!e,value:b.email,onChange:h,fullWidth:!0,InputProps:{startAdornment:Object(f.jsx)(Jr.a,{position:"start",children:Object(f.jsx)(Kr.a,{})})}}),Object(f.jsx)(Te.a,{color:"primary",variant:"contained",disabled:r,type:"submit",children:"Enregistrer"}),Object(f.jsx)(Te.a,{color:"primary",disabled:r,onClick:function(){l(!0)},children:"Informer d\u2019un changement de ma situation"})]}),Object(f.jsx)(ia,{show:u,handleClose:function(){l(!1)}})]}):Object(f.jsx)(ca,{children:Object(f.jsx)(nn,{})})},ua=n(37);var la=Object(u.a)("div",{target:"e1y580i92"})({name:"1p6wbo1",styles:"height:300px;display:flex;align-items:center;justify-content:center"}),da=Object(u.a)("div",{target:"e1y580i91"})({name:"188rsd6",styles:"margin-top:2rem;@media (min-width: 980px){display:flex;>div{flex:1 0 14.29%;}}"}),ja=Object(u.a)("div",{target:"e1y580i90"})({name:"1cltfo6",styles:"margin:20px 0 40px"}),ba=function(){var e=z().user,t=Object(a.useState)(!1),n=Object(k.a)(t,2),r=n[0],i=n[1],c=qn().openDialog,o=Object(a.useState)(""),u=Object(k.a)(o,2),l=u[0],d=u[1],j=Object(a.useState)([]),b=Object(k.a)(j,2),m=b[0],h=b[1],O=Object(s.useQuery)(we),v=O.data,g=O.loading,y=O.error,I=Object(s.useQuery)(Ie,{skip:!e,variables:{idUser:null===e||void 0===e?void 0:e.id}}),w=I.data,P=I.loading,A=I.error,S=g||P;Object(a.useEffect)((function(){w&&(null===w||void 0===w?void 0:w.reserves.length)>0&&(d(w.reserves[0].informations),h(w.reserves[0].creneauGeneriques.map((function(e){return e.id}))))}),[w]);var F=y||A;if(F)return Object(f.jsx)(C,{error:F});var q=[];if(v)for(var E=function(e){null===v||void 0===v||v.creneauGeneriques.filter((function(t){var n=t.jour,r=t.actif;return n===e&&r})).forEach((function(t){var n=q.find((function(t){return t.day===e})),r=new Date(t.heureDebut).getTime();if(n){var a=n.slots.find((function(e){return e.time===r}));a?a.allSlotIds.push(t.id):n.slots.push({time:r,slotDisplayed:t,allSlotIds:[t.id]})}else q.push({day:e,slots:[{time:r,slotDisplayed:t,allSlotIds:[t.id]}]})}))},D=0;D<7;D++)E(D);var M=function(e){var t=[];return q.forEach((function(n){var r=n.slots.find((function(t){return t.slotDisplayed.id===e}));r&&(t=r.allSlotIds)})),t},$=function(){var t=Object(Ge.a)(_e.a.mark((function t(){var n;return _e.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i(!0),n={user:null===e||void 0===e?void 0:e.id,informations:l,creneauGenerique:m},(null===w||void 0===w?void 0:w.reserves.length)&&(n.id=w.reserves[0].id),t.prev=3,t.next=6,ne.mutate({mutation:n.id?Ce:ye,variables:n});case 6:c((n.id?"Votre inscription \xe0 la r\xe9serve a bien \xe9t\xe9 mise \xe0 jour.":"Vous \xeates d\xe9sormais inscrit\xb7e \xe0 la reserve.")+" Merci !"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),x(t.t0);case 12:i(!1);case 13:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(){return t.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"R\xe9serve"}),S?Object(f.jsx)(la,{children:Object(f.jsx)(nn,{})}):Object(f.jsxs)(f.Fragment,{children:["Jours pour lesquels je peux parfois me rendre disponible. Si un cr\xe9neau est libre moins de 48h avant, un e-mail sera envoy\xe9 \xe0 tou\xb7te\xb7s les inscrit\xb7te\xb7s.",Object(f.jsx)(da,{children:q.map((function(e){return Object(f.jsxs)(cn.a,{children:[(t=e.day,Tn[t]),e.slots.map((function(e){var t=e.slotDisplayed;return Object(f.jsx)(on.a,{control:Object(f.jsx)(sn.a,{color:"default",checked:m.includes(t.id),onChange:function(e){var n=e.target;!function(e,t){var n=m.slice();t?(n.push.apply(n,Object(ua.a)(M(e))),h(n)):(M(e).forEach((function(e){n.splice(n.indexOf(e),1)})),h(n))}(t.id,n.checked)}}),label:"".concat(Gn(t.heureDebut)," - ").concat(Gn(t.heureFin))},t.id)}))]},e.day);var t}))}),Object(f.jsx)(ja,{children:Object(f.jsx)(ze.a,{multiline:!0,disabled:S,label:"Informations suppl\xe9mentaires (optionnel)",value:l,onChange:function(e){var t=e.target;d(t.value)},fullWidth:!0})}),Object(f.jsx)(Te.a,{disabled:r,color:"primary",variant:"contained",onClick:$,children:"Enregistrer"})]})]})};var pa=Object(u.a)(rn.a,{target:"e3772390"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),fa=function(e){var t=e.open,n=e.handleClose,r=e.data;return r?Object(f.jsxs)(mn.a,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(f.jsxs)(hn.a,{id:"alert-dialog-title",children:[r.prenom," ",r.nom.toUpperCase()]}),Object(f.jsx)(vn.a,{children:Object(f.jsx)(Pn.a,{id:"alert-dialog-description",children:Object(f.jsxs)(rn.a,{container:!0,children:[Object(f.jsx)(rn.a,{item:!0,xs:6,children:Object(f.jsx)("h3",{children:"Roles"})}),Object(f.jsx)(pa,{item:!0,xs:6,children:Nt(r.rolesChouette)}),Object(f.jsx)(rn.a,{item:!0,xs:6,children:Object(f.jsx)("h3",{children:"Statut"})}),Object(f.jsx)(pa,{item:!0,xs:6,children:r.statut}),Object(f.jsx)(rn.a,{item:!0,xs:6,children:Object(f.jsx)("h3",{children:"Compteur PIAFS"})}),Object(f.jsxs)(pa,{item:!0,xs:6,children:[r.nbPiafEffectuees,"/",r.nbPiafAttendues]}),Object(f.jsx)(rn.a,{item:!0,xs:6,children:Object(f.jsx)("h3",{children:"Absence longue dur\xe9e sans courses"})}),Object(f.jsx)(pa,{item:!0,xs:6,children:r.absenceLongueDureeSansCourses?"oui":"non"}),Object(f.jsx)(rn.a,{item:!0,xs:6,children:Object(f.jsx)("h3",{children:"Absence longue dur\xe9e avec courses"})}),Object(f.jsx)(pa,{item:!0,xs:6,children:r.absenceLongueDureeCourses?"oui":"non"}),Object(f.jsx)(rn.a,{item:!0,xs:12,children:Object(f.jsx)(nr,{userId:r.id,validated:!1,allowValidate:!0})})]})})}),Object(f.jsx)(An.a,{children:Object(f.jsx)(Te.a,{onClick:n,color:"primary",variant:"contained",children:"Fermer"})})]}):null};var ma=Object(u.a)(ie.a,{target:"ez4p05b0"})({name:"am2b86",styles:"margin-top:16px;height:calc(100vh - 150px);.MuiDataGrid-row{cursor:pointer;}"}),ha=function(e){return e.value?"oui":"non"},Oa=[{field:"nom",headerName:"Nom",flex:1},{field:"prenom",headerName:"Prenom",flex:1},{field:"statut",headerName:"Statut",flex:1},{field:"rolesChouette",headerName:"Roles",flex:2,valueFormatter:function(e){var t=e.value;return Nt(t)}},{field:"absenceLongueDureeCourses",headerName:"Absence avec courses",flex:1,valueFormatter:ha},{field:"absenceLongueDureeSansCourses",headerName:"Absence sans courses",flex:1,valueFormatter:ha}],va=function(){var e=Object(s.useQuery)(D),t=e.data,n=e.loading,r=e.error,i=Object(a.useState)(),c=Object(k.a)(i,2),o=c[0],u=c[1],l=Object(a.useState)(!1),d=Object(k.a)(l,2),j=d[0],b=d[1];if(n)return Object(f.jsx)(nn,{});if(r)return Object(f.jsx)(w,{error:r});if(!t)return null;var p=t.users.slice().sort((function(e,t){return e.nom>t.nom?1:-1}));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(ma,{rows:p,columns:Oa,onRowClick:function(e){var t=e.row;u(t),b(!0)},autoPageSize:!0}),Object(f.jsx)(fa,{open:j,handleClose:function(){b(!1)},data:o})]})},xa=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Groupe MAG"}),Object(f.jsx)(va,{})]})},ga=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Groupe BdM"}),Object(f.jsx)(va,{})]})},ya=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p.a,{variant:"h2",children:"Politique de traitement des donn\xe9es personnelles"}),Object(f.jsx)("p",{children:"Les informations recueillies sur ces formulaires sont enregistr\xe9es dans un fichier informatis\xe9 par La Chouette Coop SAS, pour permettre la gestion du planning de participation des coop\xe9rateurs\xb7rices au fonctionnement de la coop\xe9rative. La base l\xe9gale du traitement est le contrat par lequel les coop\xe9rateurs\xb7rices s\u2019engagent \xe0 effectuer 3 heures de participation toutes les 4 semaines \xe0 la coop\xe9rative."}),Object(f.jsx)("p",{children:"Les donn\xe9es sont communiqu\xe9es aux seuls coop\xe9rateurs\xb7rices de La Chouette Coop. Elles sont conserv\xe9es pendant la dur\xe9e du mandat de coop\xe9rateur\xb7rice et en cas de d\xe9mission pendant 5 ans maximum."}),Object(f.jsx)("p",{children:"Les donn\xe9es sont h\xe9berg\xe9es en France par OVH."}),Object(f.jsxs)("p",{children:["Vous pouvez acc\xe9der aux donn\xe9es vous concernant, les rectifier, demander leur effacement ou exercer votre droit \xe0 la limitation du traitement de vos donn\xe9es. Pour exercer ces droits ou pour toute question sur le traitement de vos donn\xe9es dans ce dispositif, vous pouvez contacter\xa0:"," ",Object(f.jsx)("a",{href:"mailto:bureau-des-membres@lachouettecoop.fr",children:"bureau-des-membres@lachouettecoop.fr"})]}),Object(f.jsx)("p",{children:"Si vous estimez, apr\xe8s nous avoir contact\xe9s, que vos droits \xab\xa0Informatique et Libert\xe9s\xa0\xbb ne sont pas respect\xe9s, vous pouvez adresser une r\xe9clamation \xe0 la CNIL."})]})},Ca=Object(u.a)("div",{target:"e1pd3b3q0"})("margin:",(function(e){return e.theme.spacing(3)}),"px;",(function(e){return e.theme.breakpoints.down("xs")}),"{margin-bottom:",(function(e){return e.theme.spacing(12)}),"px;}",(function(e){return e.theme.breakpoints.up("sm")}),"{margin-left:",(function(e){return e.theme.spacing(12)}),"px;}"),Ia=function(){var e=function(e){var t={};return e.substr(1).split("&").forEach((function(e){if(e){var n=e.split("=");2===n.length&&(t[n[0]]=decodeURIComponent(n[1]))}})),t}(Object(De.g)().search).next;return Object(f.jsxs)(at,{children:[Object(f.jsx)(Vt,{}),Object(f.jsxs)(Ca,{children:[Object(f.jsxs)(De.d,{children:[Object(f.jsx)(De.b,{path:"/home",component:jr}),Object(f.jsx)(De.b,{path:"/planning",component:Wr}),Object(f.jsx)(De.b,{path:"/profile",component:sa}),Object(f.jsx)(De.b,{path:"/reserve",component:ba}),Object(f.jsx)(De.b,{path:"/bdm",component:ga}),Object(f.jsx)(De.b,{path:"/magasin",component:xa}),Object(f.jsx)(De.b,{path:"/legal",component:ya}),Object(f.jsx)(De.a,{to:e||"/home"})]}),Object(f.jsx)(Zt,{})]})]})},wa=function(){var e=z().auth;return Object(a.useEffect)((function(){window.confirm("ATTENTION ! Cet outil n'est pas encore le planning officiel de La Chouette Coop !\nIl s'agit pour l'instant d'une version de d\xe9veloppement, avec des donn\xe9es de test.\nCliquez sur OK pour \xeatre redirig\xe9\xb7e vers la page de l'espace membre sur laquelle se trouve le lien vers le planning actuel.")&&(window.location.href="https://espace-membres.lachouettecoop.fr/page/tafs")}),[]),Object(f.jsx)(Ee.a,{children:Object(f.jsx)(Fn,{children:e?Object(f.jsx)(Ia,{}):Object(f.jsx)(Je,{})})})};o.a.render(Object(f.jsx)(P,{children:Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(pe,{children:Object(f.jsx)(s.ApolloProvider,{client:ne,children:Object(f.jsx)(G,{children:Object(f.jsx)(ke,{children:Object(f.jsx)(wa,{})})})})})})}),document.getElementById("root"))}},[[244,1,2]]]);
//# sourceMappingURL=main.c3130cc9.chunk.js.map